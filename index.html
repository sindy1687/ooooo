<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Ëã±ÊâìÂ∞èËã±ÈõÑ - È¶ñÈ†Å</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/index.css">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    /* ÂÖ®Â±ÄÊ®£Âºè */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, 'Orbitron', sans-serif;
      background: url('https://th.bing.com/th/id/OIP.EXCeug5EiI00kMhj2ySQUwHaEo?r=0&w=1920&h=1200&rs=1&pid=ImgDetMain') center center fixed;
      background-size: cover;
      color: #f3f6fa;
      min-height: 100vh;
      display: block;
      text-align: center;
      overflow: visible !important;
    }

    /* Ê®ôÈ°å */
    h1 {
      font-size: 2.8rem;
      color: #e6f0ff;
      text-shadow: 0 2px 12px #2e3a5e, 0 0 40px #a259ff, 0 0 60px #ff6b6b;
      margin: 5px 0 8px;
      text-align: center;
      font-weight: 800;
      letter-spacing: 3px;
      background: none;
      -webkit-background-clip: unset;
      -webkit-text-fill-color: unset;
      background-clip: unset;
      animation: titleGlow 3s ease-in-out infinite alternate;
      font-family: 'Orbitron', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
    }

    @keyframes titleGlow {
      0% { filter: brightness(1) saturate(1); }
      100% { filter: brightness(1.2) saturate(1.3); }
    }

    .subtitle {
      font-size: 1.4rem;
      color: #a3b8ff;
      margin-bottom: 12px;
      text-shadow: 0 1px 8px #2e3a5e, 0 0 20px #a259ff;
      font-weight: 600;
      letter-spacing: 2px;
      background: none;
      -webkit-background-clip: unset;
      -webkit-text-fill-color: unset;
      background-clip: unset;
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
    }

    .description {
      font-size: 1.1rem;
      color: #b8c7e0;
      margin-bottom: 20px;
      line-height: 1.8;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      text-shadow: 0 1px 6px #2e3a5e;
      font-weight: 400;
      letter-spacing: 0.5px;
      background: none;
      -webkit-background-clip: unset;
      -webkit-text-fill-color: unset;
      background-clip: unset;
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
    }

    /* ‰∏ªË¶ÅÂÆπÂô® */
    #container {
      max-width: 800px;
      width: 90%;
      margin: 4px auto 20px auto;
      padding: 12px;
      background: rgba(10, 20, 40, 0.45);
      border-radius: 20px;
      box-shadow: 0 0 32px #00ffff44, 0 0 80px #a259ff22 inset;
      border: 2px solid #00ffff;
      backdrop-filter: blur(2px);
      text-align: center;
      color: #f3f6fa;
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      overflow: visible !important;
      position: relative;
    }

    /* Áé©ÂÆ∂ÂêçÁ®±Ëº∏ÂÖ• */
    #playerName {
      width: 60%;
      padding: 8px 12px;
      margin: 8px 0;
      font-size: 0.95rem;
      background: rgba(10, 20, 40, 0.6);
      border: 2px solid #00ffff;
      border-radius: 10px;
      color: #fff;
      box-shadow: 0 0 20px #00ffff80, 0 0 40px #a259ff40;
      font-family: 'Roboto Mono', monospace;
      text-align: center;
      font-weight: 500;
      letter-spacing: 1px;
      transition: all 0.3s ease;
      backdrop-filter: blur(2px);
    }

    #playerName:focus {
      outline: none;
      border-color: #ff6b6b;
      box-shadow: 0 0 30px #00ffff, 0 0 60px #ff6b6b80;
      transform: scale(1.02);
    }

    #playerName::placeholder {
      color: rgba(255, 255, 255, 0.6);
      font-style: italic;
    }

    /* È†≠ÂÉèÈÅ∏Êìá */
    .avatar-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 15px;
      margin: 16px 0;
      padding: 15px;
      background: rgba(10, 20, 40, 0.2);
      border-radius: 20px;
      border: 1px solid rgba(0, 255, 255, 0.3);
      backdrop-filter: blur(2px);
    }

    .avatar-option {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      cursor: pointer;
      border: 3px solid #00ffff;
      transition: all 0.2s ease-out;
      box-shadow: 0 0 20px #00ffff44, 0 0 40px #a259ff22;
      background-size: cover;
      background-position: center top;
      background-repeat: no-repeat;
      position: relative;
      overflow: hidden;
      background-clip: content-box;
    }

    .avatar-option::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
      border-radius: 50%;
    }

    .avatar-option:hover {
      transform: scale(1.08);
      box-shadow: 0 0 30px #00ffff, 0 0 60px #a259ff66;
      border-color: #ff6b6b;
      /* Êá∏ÂÅúÊôÇÊîæÂ§ßËÉåÊôØÂúñÁâá‰ª•Êõ¥Â•ΩÂú∞È°ØÁ§∫ËáâÈÉ® */
      background-size: 115% auto;
    }

    .avatar-option:hover::before {
      opacity: 1;
    }

    .avatar-option.selected {
      border-color: #ffd700;
      box-shadow: 0 0 30px #ffd700, 0 0 60px #ffd70066;
      transform: scale(1.1);
      animation: selectedPulse 2s ease-in-out infinite;
      /* ÈÅ∏‰∏≠ÊôÇ‰πüÊîæÂ§ßËÉåÊôØÂúñÁâá */
      background-size: 110% auto;
    }

    /* Ëá™Ë®ÇÈ†≠ÂÉèÈÅ∏È†ÖÊ®£Âºè */
    .custom-avatar-option {
      background: linear-gradient(135deg, #a259ff 0%, #ff6b6b 100%) !important;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
    }

    /* ÂÖ¨ÂëäÊï∏Â≠óÊ≥°Ê≥°Ê®£Âºè */
    .notification-badge {
      position: absolute;
      top: -12px;
      right: -12px;
      background: linear-gradient(135deg, #ff4757 0%, #ff3838 100%);
      color: white;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: bold;
      font-family: 'Orbitron', monospace;
      box-shadow: 
        0 0 15px rgba(255, 71, 87, 0.8),
        0 0 30px rgba(255, 71, 87, 0.6),
        inset 0 0 8px rgba(255, 255, 255, 0.3);
      border: 3px solid rgba(255, 255, 255, 0.4);
      animation: badgePulse 2s ease-in-out infinite;
      z-index: 1000;
      pointer-events: none;
    }

    @keyframes badgePulse {
      0%, 100% { 
        transform: scale(1);
        box-shadow: 
          0 0 15px rgba(255, 71, 87, 0.8),
          0 0 30px rgba(255, 71, 87, 0.6),
          inset 0 0 8px rgba(255, 255, 255, 0.3);
      }
      50% { 
        transform: scale(1.15);
        box-shadow: 
          0 0 20px rgba(255, 71, 87, 0.9),
          0 0 40px rgba(255, 71, 87, 0.7),
          inset 0 0 10px rgba(255, 255, 255, 0.4);
      }
    }

    .announcement-btn {
      position: relative;
      overflow: visible !important;
      z-index: 1;
    }

    .announcement-btn:hover .notification-badge {
      animation: badgeHover 0.3s ease-in-out;
    }

    @keyframes badgeHover {
      0% { transform: scale(1); }
      50% { transform: scale(1.25); }
      100% { transform: scale(1.15); }
    }

    .custom-avatar-option::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      opacity: 0;
      transition: opacity 0.3s ease;
      border-radius: 50%;
    }

    .custom-avatar-option:hover::before {
      opacity: 1;
    }

    .custom-avatar-icon {
      font-size: 2rem;
      margin-bottom: 4px;
      animation: customIconGlow 2s ease-in-out infinite alternate;
    }

    .custom-avatar-text {
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 1px;
    }

    @keyframes customIconGlow {
      0% { 
        filter: brightness(1) saturate(1);
        transform: scale(1);
      }
      100% { 
        filter: brightness(1.3) saturate(1.5);
        transform: scale(1.1);
      }
    }

    /* È¶ñÈ†ÅÂÖ¨ÂëäÂçÄÂüüÊ®£Âºè - ÁæéÂåñÁâà */
    .home-announcements {
      margin: 25px 0;
      background: linear-gradient(135deg, rgba(10, 20, 40, 0.95), rgba(20, 30, 50, 0.9));
      border-radius: 20px;
      border: 2px solid rgba(0, 255, 255, 0.6);
      backdrop-filter: blur(15px);
      overflow: hidden;
      box-shadow: 
        0 0 25px rgba(0, 255, 255, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      z-index: 10;
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
    }

    .home-announcements::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.8), transparent);
    }

    .home-announcements:hover {
      box-shadow: 
        0 0 35px rgba(0, 255, 255, 0.5),
        0 8px 25px rgba(0, 0, 0, 0.3);
      transform: translateY(-3px);
      border-color: rgba(0, 255, 255, 0.8);
    }

    .announcements-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 25px;
      background: linear-gradient(135deg, 
        rgba(0, 255, 255, 0.15), 
        rgba(255, 107, 107, 0.15),
        rgba(255, 215, 0, 0.1));
      border-bottom: 1px solid rgba(0, 255, 255, 0.3);
      position: relative;
    }

    .announcements-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.5), transparent);
    }

    .announcements-header h3 {
      color: #00ffff;
      font-size: 1.4rem;
      font-weight: 700;
      margin: 0;
      text-shadow: 
        0 0 15px rgba(0, 255, 255, 0.6),
        0 2px 4px rgba(0, 0, 0, 0.3);
      letter-spacing: 0.5px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .view-all-btn {
      background: linear-gradient(135deg, #ff6b6b, #ffd700, #00ffff);
      background-size: 200% 200%;
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 25px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: 
        0 0 20px rgba(255, 107, 107, 0.4),
        0 4px 15px rgba(0, 0, 0, 0.2);
      position: relative;
      overflow: hidden;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .view-all-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }

    .view-all-btn:hover::before {
      left: 100%;
    }

    .view-all-btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 
        0 0 30px rgba(255, 107, 107, 0.6),
        0 8px 25px rgba(0, 0, 0, 0.3);
      background-position: 100% 100%;
    }

    .announcements-content {
      padding: 20px 25px;
      max-height: 250px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: rgba(0, 255, 255, 0.5) transparent;
    }

    .announcements-content::-webkit-scrollbar {
      width: 6px;
    }

    .announcements-content::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 3px;
    }

    .announcements-content::-webkit-scrollbar-thumb {
      background: linear-gradient(180deg, rgba(0, 255, 255, 0.6), rgba(255, 107, 107, 0.6));
      border-radius: 3px;
    }

    .announcement-item {
      background: linear-gradient(135deg, 
        rgba(0, 0, 0, 0.4), 
        rgba(20, 30, 50, 0.3));
      border-left: 5px solid #00ffff;
      padding: 18px 22px;
      margin-bottom: 18px;
      border-radius: 15px;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(5px);
      box-shadow: 
        0 2px 10px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .announcement-item-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .announcement-item-body {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .announcement-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.15), transparent);
      transition: left 0.8s ease;
    }

    .announcement-item:hover::before {
      left: 100%;
    }

    .announcement-item:hover {
      transform: translateX(8px) scale(1.02);
      box-shadow: 
        0 0 25px rgba(0, 255, 255, 0.4),
        0 8px 25px rgba(0, 0, 0, 0.3);
      border-left-width: 6px;
    }

    .announcement-item.urgent {
      border-left-color: #ff4757;
      background: linear-gradient(135deg, 
        rgba(255, 71, 87, 0.15), 
        rgba(255, 20, 40, 0.1));
      box-shadow: 
        0 2px 10px rgba(255, 71, 87, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .announcement-item.urgent:hover {
      box-shadow: 
        0 0 25px rgba(255, 71, 87, 0.5),
        0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .announcement-item.info {
      border-left-color: #2ed573;
      background: linear-gradient(135deg, 
        rgba(46, 213, 115, 0.15), 
        rgba(20, 200, 80, 0.1));
      box-shadow: 
        0 2px 10px rgba(46, 213, 115, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .announcement-item.info:hover {
      box-shadow: 
        0 0 25px rgba(46, 213, 115, 0.5),
        0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .announcement-item.update {
      border-left-color: #3742fa;
      background: linear-gradient(135deg, 
        rgba(55, 66, 250, 0.15), 
        rgba(40, 50, 200, 0.1));
      box-shadow: 
        0 2px 10px rgba(55, 66, 250, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .announcement-item.update:hover {
      box-shadow: 
        0 0 25px rgba(55, 66, 250, 0.5),
        0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .announcement-content {
      color: #ffffff;
      font-size: 1.05rem;
      line-height: 1.7;
      margin-bottom: 10px;
      font-weight: 500;
      text-shadow: 
        0 1px 3px rgba(0, 0, 0, 0.4),
        0 2px 6px rgba(0, 0, 0, 0.2);
      font-family: 'Segoe UI', 'Microsoft YaHei', 'PingFang SC', 'Hiragino Sans GB', Tahoma, Geneva, Verdana, sans-serif;
      letter-spacing: 0.4px;
      word-spacing: 1px;
      text-align: justify;
      hyphens: auto;
      -webkit-hyphens: auto;
      -ms-hyphens: auto;
      position: relative;
      padding-left: 5px;
    }

    .announcement-content::before {
      content: '';
      position: absolute;
      left: -2px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(180deg, rgba(0, 255, 255, 0.6), transparent);
      border-radius: 1px;
    }

    .announcement-time {
      color: #c0c0c0;
      font-size: 0.9rem;
      font-style: italic;
      font-weight: 400;
      opacity: 0.9;
      font-family: 'Segoe UI', 'Microsoft YaHei', 'PingFang SC', 'Hiragino Sans GB', Tahoma, Geneva, Verdana, sans-serif;
      letter-spacing: 0.2px;
      display: flex;
      align-items: center;
      gap: 5px;
      margin-top: 8px;
    }

    .announcement-time::before {
      content: 'üïê';
      font-size: 0.8rem;
      opacity: 0.7;
    }

    .announcement-type {
      display: inline-block;
      margin-right: 12px;
      font-size: 1.3rem;
      filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.4));
      vertical-align: middle;
      position: relative;
      top: -1px;
    }

    /* ÂÖ¨ÂëäÂÖßÂÆπÁâπÊÆäÊ®£Âºè */
    .announcement-item.urgent .announcement-content {
      color: #ffebee;
      text-shadow: 
        0 1px 3px rgba(255, 71, 87, 0.3),
        0 2px 6px rgba(0, 0, 0, 0.2);
    }

    .announcement-item.urgent .announcement-content::before {
      background: linear-gradient(180deg, rgba(255, 71, 87, 0.8), transparent);
    }

    .announcement-item.info .announcement-content {
      color: #e8f5e8;
      text-shadow: 
        0 1px 3px rgba(46, 213, 115, 0.3),
        0 2px 6px rgba(0, 0, 0, 0.2);
    }

    .announcement-item.info .announcement-content::before {
      background: linear-gradient(180deg, rgba(46, 213, 115, 0.8), transparent);
    }

    .announcement-item.update .announcement-content {
      color: #e3f2fd;
      text-shadow: 
        0 1px 3px rgba(55, 66, 250, 0.3),
        0 2px 6px rgba(0, 0, 0, 0.2);
    }

    .announcement-item.update .announcement-content::before {
      background: linear-gradient(180deg, rgba(55, 66, 250, 0.8), transparent);
    }

    /* ÊñáÂ≠óÈÅ∏ÊìáÊïàÊûú */
    .announcement-content::selection {
      background: rgba(0, 255, 255, 0.3);
      color: #ffffff;
    }

    .announcement-content::-moz-selection {
      background: rgba(0, 255, 255, 0.3);
      color: #ffffff;
    }

    /* ÂÖ¨ÂëäÈ†ÖÁõÆÂãïÁï´ÊïàÊûú */
    @keyframes announcementSlideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .announcement-item {
      animation: announcementSlideIn 0.5s ease-out;
    }

    /* ÂÖ¨ÂëäÂÖßÂÆπÂº∑Ë™øÊïàÊûú */
    .announcement-content strong {
      color: #00ffff;
      font-weight: 600;
      text-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
    }

    .announcement-content em {
      color: #ffd700;
      font-style: italic;
      font-weight: 500;
    }

    /* ÂÖ¨ÂëäÊôÇÈñìÊá∏ÂÅúÊïàÊûú */
    .announcement-time:hover {
      color: #ffffff;
      opacity: 1;
      transform: scale(1.05);
      transition: all 0.3s ease;
    }

    .loading-announcement {
      text-align: center;
      color: #00ffff;
      font-style: italic;
      padding: 30px;
      font-size: 1.1rem;
      font-weight: 500;
      text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .no-announcements {
      text-align: center;
      color: #b0b0b0;
      font-style: italic;
      padding: 30px;
      font-size: 1.1rem;
      font-weight: 500;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    /* ÈüøÊáâÂºèË®≠Ë®à - ÁæéÂåñÁâà */
    @media (max-width: 768px) {
      .home-announcements {
        margin: 15px 0;
        border-radius: 15px;
      }
      
      .announcements-header {
        flex-direction: column;
        gap: 12px;
        text-align: center;
        padding: 15px 20px;
      }
      
      .announcements-header h3 {
        font-size: 1.2rem;
      }
      
      .view-all-btn {
        padding: 8px 15px;
        font-size: 0.9rem;
      }
      
      .announcements-content {
        max-height: 180px;
        padding: 15px 20px;
      }
      
      .announcement-item {
        padding: 14px 18px;
        margin-bottom: 14px;
        border-radius: 12px;
        gap: 6px;
      }
      
      .announcement-content {
        font-size: 0.95rem;
        line-height: 1.6;
        letter-spacing: 0.3px;
      }
      
      .announcement-time {
        font-size: 0.8rem;
        margin-top: 6px;
      }
      
      .announcement-type {
        font-size: 1.1rem;
        margin-right: 8px;
      }
    }

    @media (max-width: 480px) {
      .home-announcements {
        margin: 10px 0;
        border-radius: 12px;
      }
      
      .announcements-header {
        padding: 12px 15px;
        gap: 10px;
      }
      
      .announcements-header h3 {
        font-size: 1.1rem;
      }
      
      .view-all-btn {
        padding: 6px 12px;
        font-size: 0.85rem;
        border-radius: 20px;
      }
      
      .announcements-content {
        max-height: 150px;
        padding: 12px 15px;
      }
      
      .announcement-item {
        padding: 12px 15px;
        margin-bottom: 12px;
        border-radius: 10px;
        gap: 5px;
      }
      
      .announcement-content {
        font-size: 0.9rem;
        line-height: 1.5;
        letter-spacing: 0.2px;
      }
      
      .announcement-time {
        font-size: 0.75rem;
        margin-top: 5px;
      }
      
      .announcement-type {
        font-size: 1rem;
        margin-right: 6px;
      }
    }

    .custom-avatar-option.selected {
      background: linear-gradient(135deg, #ffd700 0%, #ff6b6b 100%) !important;
      animation: customSelectedPulse 2s ease-in-out infinite;
    }

    @keyframes customSelectedPulse {
      0%, 100% { 
        box-shadow: 0 0 30px #ffd700, 0 0 60px #ffd70066;
        transform: scale(1.1);
      }
      50% { 
        box-shadow: 0 0 40px #ffd700, 0 0 80px #ffd70099;
        transform: scale(1.15);
      }
    }

    @keyframes selectedPulse {
      0%, 100% { box-shadow: 0 0 30px #ffd700, 0 0 60px #ffd70066; }
      50% { box-shadow: 0 0 40px #ffd700, 0 0 80px #ffd70099; }
    }



    /* ÊåâÈàïÊ®£Âºè */
    .btn {
      display: inline-block;
      padding: 12px 24px;
      margin: 8px;
      font-size: 1.1rem;
      color: #222b3a;
      background: linear-gradient(135deg, #00ffff 0%, #a259ff 50%, #ff6b6b 100%);
      border: none;
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Orbitron', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      font-weight: 700;
      letter-spacing: 1.5px;
      box-shadow: 0 0 20px #00ffff, 0 0 40px #a259ff99, 0 8px 16px rgba(0, 0, 0, 0.3);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s;
    }

    .btn:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 0 30px #00ffff, 0 0 60px #a259ffcc, 0 12px 24px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #00ffff 0%, #a259ff 30%, #ff6b6b 70%, #ffd700 100%);
    }



    .btn:hover::before {
      left: 100%;
    }

    .btn:active {
      transform: translateY(-1px) scale(1.02);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Èü≥ÊïàÊéßÂà∂ */
    #audioControls {
      position: fixed;
      bottom: 15px;
      right: 15px;
      display: flex;
      gap: 8px;
    }

    #audioControls button {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: 2px solid #00ffff;
      background: rgba(10, 20, 40, 0.6);
      color: #fff;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 0 16px #00ffff;
      backdrop-filter: blur(1px);
    }

    #audioControls button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 32px #00ffff;
    }

    /* Áé©ÂÆ∂ÂêçÁ®±È°ØÁ§∫ */
    #playerNameDisplay {
      position: fixed;
      top: 15px;
      right: 15px;
      background: rgba(10, 20, 40, 0.6);
      padding: 6px 12px;
      border-radius: 10px;
      color: #ffd700;
      font-weight: bold;
      box-shadow: 0 0 12px #ffd700, 0 0 32px #00ffff;
      border: 2px solid #00ffff;
      font-size: 1.1rem;
      backdrop-filter: blur(1px);
    }

    /* ÊòüÊòüÈ°ØÁ§∫ */
    #starsDisplay {
      position: fixed;
      top: 15px;
      left: 15px;
      background: rgba(10, 20, 40, 0.8);
      padding: 4px 8px;
      border-radius: 8px;
      color: #ffd700;
      font-weight: bold;
      box-shadow: 0 0 8px #ffd700, 0 0 16px #00ffff;
      border: 1px solid #00ffff;
      font-size: 1rem;
      backdrop-filter: blur(5px);
      z-index: 1000;
      display: flex !important;
      align-items: center !important;
      gap: 3px !important;
      width: fit-content !important;
      text-align: center !important;
      transition: all 0.3s ease !important;
    }

    #starsDisplay:hover {
      transform: scale(1.05);
      box-shadow: 0 0 12px #ffd700, 0 0 24px #00ffff;
    }

    #starsDisplay #totalStarsCount {
      font-weight: bold;
      color: #ffd700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }

    /* ÂñÆÂ≠ó‰∏ãËºâ‰∏≠ÂøÉÊ®£Âºè */
    .vocabulary-download-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 1;
    }

    .vocabulary-header {
      text-align: center;
      margin-bottom: 40px;
      color: white;
      position: relative;
    }

    .vocabulary-header::before {
      content: '';
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 2px;
      background: linear-gradient(90deg, transparent, #00ffff, #ff00ff, transparent);
    }

    .vocabulary-header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 0 0 20px rgba(0,255,255,0.5);
      background: linear-gradient(45deg, #00ffff, #ff00ff, #ffff00, #00ff00);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      position: relative;
    }

    .vocabulary-header h1::after {
      content: 'üöÄ';
      position: absolute;
      right: -40px;
      top: 0;
      font-size: 1.5rem;
    }

    .vocabulary-header p {
      font-size: 1.1rem;
      opacity: 0.9;
      color: #b0b0b0;
    }

    .vocabulary-download-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }

    .vocabulary-download-card {
      background: rgba(20, 20, 40, 0.8);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 
        0 10px 30px rgba(0,0,0,0.3),
        0 0 0 1px rgba(0,255,255,0.1);
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(0,255,255,0.2);
    }

    .vocabulary-download-card:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 15px 35px rgba(0,0,0,0.4),
        0 0 0 1px rgba(0,255,255,0.3);
    }

    .vocabulary-download-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #00ffff, #ff00ff, #ffff00);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }

    .vocabulary-download-card:hover::before {
      transform: scaleX(1);
    }

    .vocabulary-card-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .vocabulary-card-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 20px;
      font-size: 24px;
      color: white;
      position: relative;
      overflow: hidden;
      transition: all 0.2s ease;
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      box-shadow: 0 0 20px rgba(0,255,255,0.3);
    }

    .vocabulary-card-icon:hover {
      transform: scale(1.02);
      box-shadow: 0 0 25px rgba(0,255,255,0.5);
    }

    .vocabulary-basic-icon {
      background: linear-gradient(135deg, #00ffff, #0080ff);
    }

    .vocabulary-ielts-icon {
      background: linear-gradient(135deg, #ff00ff, #ff0080);
    }

    .vocabulary-auto-icon {
      background: linear-gradient(135deg, #ffff00, #ff8000);
    }

    .vocabulary-daily-icon {
      background: linear-gradient(135deg, #00ff00, #00ff80);
    }

    .vocabulary-toeic-icon {
      background: linear-gradient(135deg, #ff8000, #ff4000);
    }

    .vocabulary-toefl-icon {
      background: linear-gradient(135deg, #8000ff, #4000ff);
    }

    .vocabulary-business-icon {
      background: linear-gradient(135deg, #ff0080, #ff0040);
    }

    .vocabulary-sports-icon {
      background: linear-gradient(135deg, #00ff80, #00ff40);
    }

    .vocabulary-card-title {
      font-size: 1.5rem;
      font-weight: bold;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(0,255,255,0.3);
    }

    .vocabulary-card-subtitle {
      color: #b0b0b0;
      font-size: 0.9rem;
      margin-top: 5px;
    }

    .vocabulary-card-stats {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
      padding: 15px;
      background: rgba(0,0,0,0.3);
      border-radius: 15px;
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
      border: 1px solid rgba(0,255,255,0.2);
    }

    .vocabulary-stat-item {
      text-align: center;
      transition: all 0.2s ease;
    }

    .vocabulary-stat-item:hover {
      transform: scale(1.02);
    }

    .vocabulary-stat-number {
      font-size: 1.5rem;
      font-weight: bold;
      color: #00ffff;
      text-shadow: 0 0 10px rgba(0,255,255,0.5);
    }

    .vocabulary-stat-label {
      font-size: 0.8rem;
      color: #b0b0b0;
      margin-top: 5px;
      font-weight: 500;
    }

    .vocabulary-card-description {
      color: #d0d0d0;
      line-height: 1.6;
      margin-bottom: 25px;
    }

    .vocabulary-download-btn {
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: 10px;
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      color: white;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 20px rgba(0,255,255,0.3);
    }

    .vocabulary-download-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 25px rgba(0,255,255,0.5);
      background: linear-gradient(135deg, #00e6e6, #e600e6);
    }

    .vocabulary-download-btn:active {
      transform: translateY(0);
    }

    .vocabulary-download-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .vocabulary-preview-section {
      background: rgba(20, 20, 40, 0.8);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 30px;
      margin-top: 40px;
      box-shadow: 
        0 10px 30px rgba(0,0,0,0.3),
        0 0 0 1px rgba(0,255,255,0.2);
      border: 1px solid rgba(0,255,255,0.2);
    }

    .vocabulary-preview-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .vocabulary-preview-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      color: white;
      box-shadow: 0 0 15px rgba(0,255,255,0.4);
    }

    .vocabulary-preview-title {
      font-size: 1.3rem;
      font-weight: bold;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(0,255,255,0.3);
    }

    .vocabulary-preview-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      background: rgba(0,0,0,0.4);
      border: 1px solid rgba(0,255,255,0.2);
    }

    .vocabulary-preview-table th {
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      color: white;
      padding: 18px 15px;
      text-align: left;
      font-weight: bold;
      position: relative;
      text-shadow: 0 0 10px rgba(0,255,255,0.5);
    }

    .vocabulary-preview-table th::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
    }

    .vocabulary-preview-table td {
      padding: 15px;
      border-bottom: 1px solid rgba(0,255,255,0.1);
      transition: all 0.2s ease;
      color: #e0e0e0;
    }

    .vocabulary-preview-table tr:nth-child(even) {
      background: rgba(0,255,255,0.05);
    }

    .vocabulary-preview-table tr:hover {
      background: rgba(0,255,255,0.1);
    }

    .vocabulary-preview-table tr:hover td {
      color: #00ffff;
      font-weight: 500;
    }

    .vocabulary-loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(0,255,255,0.3);
      border-radius: 50%;
      border-top-color: #00ffff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .vocabulary-success-message {
      background: linear-gradient(135deg, rgba(0,255,0,0.2), rgba(0,200,0,0.1));
      color: #00ff00;
      padding: 20px;
      border-radius: 15px;
      margin-top: 20px;
      border: 1px solid rgba(0,255,0,0.3);
      box-shadow: 0 5px 15px rgba(0,255,0,0.2);
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    .vocabulary-error-message {
      background: linear-gradient(135deg, rgba(255,0,0,0.2), rgba(200,0,0,0.1));
      color: #ff0000;
      padding: 20px;
      border-radius: 15px;
      margin-top: 20px;
      border: 1px solid rgba(255,0,0,0.3);
      box-shadow: 0 5px 15px rgba(255,0,0,0.2);
      backdrop-filter: blur(10px);
    }

    .vocabulary-search-section {
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(15px);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 30px;
      border: 1px solid rgba(0,255,255,0.2);
      box-shadow: 0 0 20px rgba(0,255,255,0.1);
    }

    .vocabulary-search-input {
      flex: 1;
      min-width: 200px;
      padding: 12px 15px;
      border: none;
      border-radius: 10px;
      background: rgba(0,0,0,0.6);
      color: #ffffff;
      font-size: 1rem;
      border: 1px solid rgba(0,255,255,0.3);
      transition: all 0.3s ease;
    }

    .vocabulary-search-input:focus {
      box-shadow: 0 0 15px rgba(0,255,255,0.4);
    }

    .vocabulary-level-select {
      padding: 12px 15px;
      border: none;
      border-radius: 10px;
      background: rgba(0,0,0,0.6);
      color: #ffffff;
      font-size: 1rem;
      min-width: 120px;
      border: 1px solid rgba(0,255,255,0.3);
      transition: all 0.3s ease;
    }

    .vocabulary-level-select:focus {
      box-shadow: 0 0 15px rgba(0,255,255,0.4);
    }

    .vocabulary-reset-btn {
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      background: linear-gradient(135deg, #00ffff, #ff00ff);
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 15px rgba(0,255,255,0.3);
    }

    .vocabulary-reset-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 25px rgba(0,255,255,0.5);
    }

    .vocabulary-stars-display {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 170, 0, 0.1));
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 15px;
      padding: 15px 25px;
      margin-bottom: 30px;
      text-align: center;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
      animation: starGlow 2s ease-in-out infinite alternate;
    }

    @keyframes starGlow {
      0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.2); }
      100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.4); }
    }

    @keyframes starRewardPop {
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
      20% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      80% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }

    /* ÈüøÊáâÂºèË®≠Ë®à */
    @media (max-width: 600px) {
      h1 {
        font-size: 1.6rem;
        margin: 3px 0 6px;
      }

      .subtitle {
        font-size: 1.2rem;
        margin-bottom: 8px;
      }

      #container {
        width: 95%;
        padding: 12px;
        margin: 2px auto 0 auto;
        min-height: auto;
        display: block;
      }

      .btn {
        width: 100%;
        margin: 4px 0;
        padding: 10px 20px;
        font-size: 1rem;
      }

      .avatar-grid {
        grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
        gap: 8px;
        margin: 12px 0;
        padding: 12px;
      }

      .avatar-option {
        width: 60px;
        height: 60px;
      }

      #characterPreview {
        width: 200px;
        height: 280px;
        margin: 8px auto;
        background: rgba(10, 20, 40, 0.2);
        backdrop-filter: blur(4px);
      }

      .nav-buttons {
        gap: 8px;
        margin-top: 16px;
        margin-bottom: 20px;
      }

      .nav-btn {
        padding: 8px 14px;
        font-size: 0.9rem;
        overflow: visible !important; /* Á¢∫‰øùÊàêÂ∞±ÊåâÈàïÂú®ÊâãÊ©üÁâà‰πüËÉΩÊ≠£Â∏∏È°ØÁ§∫Ê≥°Ê≥° */
      }

      #characterSlogan {
        font-size: 1rem;
        margin: 8px 0;
        min-height: 1.2rem;
      }

      .main-buttons {
        margin: 12px 0;
      }

      /* Â¢ûÂä†Â∫ïÈÉ®ÈñìË∑ù */
      body {
        padding-bottom: 20px;
      }

      /* ÂÑ™ÂåñÂÆπÂô®È´òÂ∫¶ */
      #container {
        margin-bottom: 20px;
      }

      /* ÊîπÂñÑÊåâÈàïÈñìË∑ù */
      .main-buttons .btn {
        margin: 6px 0;
      }

      .nav-buttons .nav-btn {
        margin: 4px 0;
      }
    }

    /* Âπ≥ÊùøÂ∞∫ÂØ∏ÈüøÊáâÂºè */
    @media (min-width: 601px) and (max-width: 1024px) {
      #container {
        width: 85%;
        padding: 20px;
        margin: 10px auto 0 auto;
        min-height: auto;
      }

      h1 {
        font-size: 2.2rem;
        margin: 8px 0 12px;
      }

      .subtitle {
        font-size: 1.3rem;
        margin-bottom: 15px;
      }

      .btn {
        padding: 14px 28px;
        font-size: 1.05rem;
        margin: 6px;
      }

      .nav-btn {
        padding: 12px 20px;
        font-size: 1rem;
      }

      .avatar-grid {
        grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
        gap: 12px;
        margin: 18px 0;
        padding: 18px;
      }

      .avatar-option {
        width: 70px;
        height: 70px;
      }

      #characterPreview {
        width: 250px;
        height: 350px;
        margin: 15px auto;
      }

      #characterSlogan {
        font-size: 1.15rem;
        margin: 12px 0;
      }
    }

    /* Â§ßËû¢ÂπïÂÑ™Âåñ */
    @media (min-width: 1025px) {
      #container {
        width: 80%;
        max-width: 900px;
        padding: 30px;
        margin: 20px auto 0 auto;
        min-height: auto;
      }

      h1 {
        font-size: 3rem;
        margin: 10px 0 15px;
      }

      .subtitle {
        font-size: 1.5rem;
        margin-bottom: 20px;
      }

      .btn {
        padding: 16px 32px;
        font-size: 1.1rem;
        margin: 8px;
      }

      .nav-btn {
        padding: 14px 24px;
        font-size: 1.05rem;
      }

      .avatar-grid {
        grid-template-columns: repeat(auto-fit, minmax(85px, 1fr));
        gap: 15px;
        margin: 20px 0;
        padding: 20px;
      }

      .avatar-option {
        width: 85px;
        height: 85px;
      }

      #characterPreview {
        width: 300px;
        height: 400px;
        margin: 20px auto;
      }

      #characterSlogan {
        font-size: 1.3rem;
        margin: 15px 0;
      }
    }

    /* Ë∂ÖÂ∞èËû¢ÂπïÂÑ™Âåñ */
    @media (max-width: 480px) {
      #container {
        width: 98%;
        padding: 10px;
        margin: 1px auto 0 auto;
        min-height: auto;
      }

      h1 {
        font-size: 1.4rem;
        margin: 2px 0 4px;
      }

      .subtitle {
        font-size: 1.1rem;
        margin-bottom: 6px;
      }

      .btn {
        padding: 8px 16px;
        font-size: 0.9rem;
        margin: 3px 0;
      }

      .nav-btn {
        padding: 6px 12px;
        font-size: 0.85rem;
        margin: 2px 0;
      }

      .avatar-grid {
        grid-template-columns: repeat(auto-fit, minmax(55px, 1fr));
        gap: 6px;
        margin: 10px 0;
        padding: 10px;
      }

      .avatar-option {
        width: 55px;
        height: 55px;
      }

      #characterPreview {
        width: 180px;
        height: 250px;
        margin: 6px auto;
      }

      #characterSlogan {
        font-size: 0.9rem;
        margin: 6px 0;
      }

      /* Â¢ûÂä†Êõ¥Â§öÂ∫ïÈÉ®ÈñìË∑ù */
      body {
        padding-bottom: 30px;
      }

      #container {
        margin-bottom: 30px;
      }
    }

    /* Êñ∞Â¢ûÊ®£Âºè */
    .input-group {
      margin: 12px 0;
    }

    #characterPreview {
      width: 300px;
      height: 400px;
      margin: 12px auto;
      border-radius: 15px;
      overflow: hidden;
      background: rgba(10, 20, 40, 0.2);
      backdrop-filter: blur(1px);
    }

    #characterImage {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: transparent;
      mix-blend-mode: screen;
    }

    .nav-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      margin-top: 20px;
    }

    .nav-btn {
      background: linear-gradient(135deg, #a259ff 0%, #ff6b6b 100%);
      color: #fff;
      border: none;
      padding: 10px 18px;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      letter-spacing: 1px;
      transition: all 0.3s ease;
      box-shadow: 0 0 16px #a259ff, 0 0 32px #ff6b6b99, 0 6px 12px rgba(0, 0, 0, 0.3);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
      transform-origin: center;
      will-change: transform;
    }

    .nav-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
      pointer-events: none; /* Á¢∫‰øù‰∏çÊúÉÂπ≤ÊìæÊªëÈº†‰∫ã‰ª∂ */
    }

    .nav-btn:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 0 24px #a259ff, 0 0 48px #ff6b6bcc, 0 8px 16px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #a259ff 0%, #ff6b6b 50%, #ffd700 100%);
    }

    .nav-btn:hover::before {
      left: 100%;
    }

    .nav-btn.primary {
      background: linear-gradient(135deg, #00ffff 0%, #a259ff 100%);
      color: #000;
      font-weight: 700;
      box-shadow: 0 0 20px #00ffff, 0 0 40px #a259ff99, 0 8px 16px rgba(0, 0, 0, 0.3);
    }

    .nav-btn.primary:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 0 30px #00ffff, 0 0 60px #a259ffcc, 0 12px 24px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #00ffff 0%, #a259ff 50%, #ff6b6b 100%);
    }

    /* ‰∏ªÊåâÈàïÂçÄÂüü */
    .main-buttons {
      margin: 16px 0;
      overflow: visible !important;
      position: relative;
    }

    /* ËßíËâ≤Ê®ôË™û */
    #characterSlogan {
      font-size: 1.2rem;
      color: #ffe9a3;
      margin: 10px 0;
      text-shadow: 0 1px 8px #2e3a5e, 0 0 12px #ffd700;
      font-weight: 600;
      letter-spacing: 1px;
      min-height: 1.5rem;
      font-style: italic;
      transition: all 0.2s ease-out;
      opacity: 1;
      transform: translateY(0);
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
    }

    /* ‰∏ªË¶ÅÂÖßÂÆπÂ≠óÈ´î */
    #container, #container * {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      color: #f3f6fa;
    }

    /* ÊåâÈàïÂ≠óÈ´îÈ°èËâ≤ÂæÆË™ø */
    .btn, .nav-btn {
      color: #222b3a;
      font-family: 'Orbitron', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
    }

    /* Êñ∞Â¢ûÔºöÊàêÂ∞±Êï∏ÈáèÊ≥°Ê≥°Ê®£Âºè */
    .achievement-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: linear-gradient(135deg, #ff6b6b, #ff4757);
      color: white;
      border-radius: 50%;
      min-width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: bold;
      box-shadow: 0 0 10px rgba(255, 107, 107, 0.6);
      border: 2px solid white;
      animation: badgePulse 2s ease-in-out infinite;
      z-index: 1000;
      pointer-events: none;
      transform-origin: center;
      will-change: transform;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    @keyframes badgePulse {
      0%, 100% {
        transform: scale(1);
        box-shadow: 0 0 10px rgba(255, 107, 107, 0.6);
      }
      50% {
        transform: scale(1.1);
        box-shadow: 0 0 15px rgba(255, 107, 107, 0.8);
      }
    }
    
    .achievement-badge.hidden {
      display: none;
    }

    /* ÊàêÂ∞±ÊåâÈàïÁâπÊÆäËôïÁêÜÔºöÈÅøÂÖçhoverÊôÇÊ≥°Ê≥°‰ΩçÁΩÆÈåØ‰∫Ç */
    .nav-btn#achievementBtn {
      overflow: visible !important;
      position: relative;
      isolation: isolate; /* ÂâµÂª∫Êñ∞ÁöÑÂ±§Áñä‰∏ä‰∏ãÊñá */
    }

    /* ÊàêÂ∞±ÊåâÈàïhoverÊôÇÔºå‰øùÊåÅÊ≥°Ê≥°ÁöÑÁõ∏Â∞ç‰ΩçÁΩÆ */
    .nav-btn#achievementBtn:hover .achievement-badge {
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(255, 107, 107, 0.8);
      animation: none; /* Êö´ÂÅúÂéüÊú¨ÁöÑÂãïÁï´ */
    }

    /* ÊàêÂ∞±ÊåâÈàïhoverÁµêÊùüÂæåÔºåÊÅ¢Âæ©Ê≥°Ê≥°ÂãïÁï´ */
    .nav-btn#achievementBtn:not(:hover) .achievement-badge {
      animation: badgePulse 2s ease-in-out infinite;
    }

    /* ÂÑ™ÂåñhoverÂãïÁï´ÔºåÈÅøÂÖçËàáÊ≥°Ê≥°Ë°ùÁ™Å */
    .nav-btn:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 0 24px #a259ff, 0 0 48px #ff6b6bcc, 0 8px 16px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, #a259ff 0%, #ff6b6b 50%, #ffd700 100%);
      z-index: 10; /* Á¢∫‰øùhoverÊôÇÂú®ÊúÄ‰∏äÂ±§ */
    }

    /* Á¢∫‰øùÊâÄÊúâÊåâÈàïÂãïÁï´ÈÉΩ‰ΩøÁî®GPUÂä†ÈÄü */
    .nav-btn, .btn {
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      -moz-backface-visibility: hidden;
    }

    /* ÂÑ™ÂåñÂãïÁï´ÊÄßËÉΩ */
    .nav-btn:hover, .btn:hover {
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      -moz-backface-visibility: hidden;
    }



    /* Ëá™Ë®ÇË®äÊÅØÊ®£Âºè */
    .custom-message {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 20px;
      border-radius: 10px;
      color: #fff;
      font-weight: 600;
      font-size: 0.95rem;
      z-index: 10000;
      animation: messageSlideIn 0.3s ease-out;
      backdrop-filter: blur(5px);
      border: 2px solid;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .custom-message-success {
      background: rgba(46, 204, 113, 0.9);
      border-color: #2ecc71;
    }

    .custom-message-warning {
      background: rgba(241, 196, 15, 0.9);
      border-color: #f1c40f;
      color: #2c3e50;
    }

    .custom-message-info {
      background: rgba(52, 152, 219, 0.9);
      border-color: #3498db;
    }

    .custom-message-error {
      background: rgba(231, 76, 60, 0.9);
      border-color: #e74c3c;
    }

    @keyframes messageSlideIn {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    @media (max-width: 600px) {
      .custom-message {
        top: 10px;
        left: 10px;
        right: 10px;
        transform: none;
        text-align: center;
      }
    }

    /* ÂΩàÁ™óÊ®£Âºè */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      animation: modalFadeIn 0.3s ease-out;
    }

    .modal-overlay.show {
      display: flex;
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .modal-content {
      background: linear-gradient(135deg, rgba(10, 20, 40, 0.95) 0%, rgba(20, 40, 80, 0.95) 100%);
      border: 2px solid #00ffff;
      border-radius: 20px;
      padding: 0;
      max-width: 90%;
      width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 0 50px #00ffff44, 0 0 100px #a259ff22;
      backdrop-filter: blur(10px);
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: scale(0.8) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 25px;
      border-bottom: 2px solid rgba(0, 255, 255, 0.3);
      background: rgba(0, 255, 255, 0.1);
    }

    .modal-header h3 {
      margin: 0;
      color: #00ffff;
      font-size: 1.4rem;
      font-weight: 700;
      text-shadow: 0 0 10px #00ffff;
    }

    .modal-close {
      background: none;
      border: 2px solid #ff6b6b;
      color: #ff6b6b;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2rem;
      font-weight: bold;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-close:hover {
      background: #ff6b6b;
      color: #fff;
      box-shadow: 0 0 20px #ff6b6b;
      transform: scale(1.1);
    }

    .modal-body {
      padding: 25px;
      display: flex;
      gap: 25px;
      flex-wrap: wrap;
    }

    .modal-avatar-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      min-width: 200px;
    }

    .modal-avatar-preview {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      border: 3px solid #00ffff;
      overflow: hidden;
      position: relative;
      cursor: pointer;
      background: rgba(10, 20, 40, 0.6);
      box-shadow: 0 0 30px #00ffff44;
      transition: all 0.3s ease;
    }

    .modal-avatar-preview:hover {
      transform: scale(1.05);
      box-shadow: 0 0 40px #00ffff66;
    }

    .modal-avatar-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .modal-upload-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 1rem;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-avatar-preview:hover .modal-upload-overlay {
      opacity: 1;
    }

    .modal-upload-overlay span {
      font-size: 2.5rem;
      margin-bottom: 8px;
    }

    .modal-upload-overlay p {
      margin: 0;
      font-size: 0.9rem;
    }

    .modal-avatar-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .modal-upload-btn, .modal-reset-btn {
      padding: 10px 18px;
      border: 2px solid #00ffff;
      background: rgba(10, 20, 40, 0.8);
      color: #fff;
      border-radius: 10px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      backdrop-filter: blur(2px);
    }

    .modal-upload-btn:hover, .modal-reset-btn:hover {
      background: rgba(0, 255, 255, 0.2);
      box-shadow: 0 0 20px #00ffff;
      transform: translateY(-2px);
    }

    .modal-info-section {
      flex: 1;
      min-width: 250px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .modal-input-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .modal-input-group label {
      font-size: 1rem;
      color: #a3b8ff;
      font-weight: 600;
    }

    .modal-input-group input,
    .modal-input-group textarea,
    .modal-input-group select {
      padding: 12px 15px;
      background: rgba(10, 20, 40, 0.6);
      border: 2px solid #00ffff;
      border-radius: 10px;
      color: #fff;
      font-size: 1rem;
      transition: all 0.3s ease;
      backdrop-filter: blur(2px);
    }

    .modal-input-group input:focus,
    .modal-input-group textarea:focus,
    .modal-input-group select:focus {
      outline: none;
      border-color: #ff6b6b;
      box-shadow: 0 0 20px #00ffff;
    }

    .modal-input-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 15px;
      padding: 20px 25px;
      border-top: 2px solid rgba(0, 255, 255, 0.3);
      background: rgba(0, 255, 255, 0.05);
    }

    .modal-cancel-btn, .modal-save-btn {
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 700;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .modal-cancel-btn {
      background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
      color: #fff;
      box-shadow: 0 0 20px #ff6b6b44;
    }

    .modal-cancel-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 30px #ff6b6b66;
    }

    .modal-save-btn {
      background: linear-gradient(135deg, #00ffff 0%, #a259ff 100%);
      color: #000;
      box-shadow: 0 0 20px #00ffff44;
    }

    .modal-save-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 30px #00ffff66;
      background: linear-gradient(135deg, #00ffff 0%, #a259ff 50%, #ff6b6b 100%);
    }

    /* ÈüøÊáâÂºèË®≠Ë®à */
    @media (max-width: 768px) {
      .modal-content {
        width: 95%;
        max-height: 95vh;
      }

      .modal-body {
        flex-direction: column;
        align-items: center;
      }

      .modal-avatar-section {
        min-width: auto;
      }

      .modal-info-section {
        min-width: 100%;
      }

      .modal-footer {
        flex-direction: column;
      }

      .modal-cancel-btn, .modal-save-btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- ÊòüÊòüÈ°ØÁ§∫ -->
  <div id="starsDisplay">
    ‚≠ê<span id="totalStarsCount">0</span>
  </div>

  <!-- ‰∏ªÂçÄÂüü -->
  <div id="container">
    <h1>üåå ÊòüÈöõËã±ÊâìÂÜíÈö™</h1>
    <p class="subtitle">ÈñãÂßã‰Ω†ÁöÑÊâìÂ≠óËã±ÈõÑ‰πãÊóÖÔºÅ</p>

    <!-- ‰ΩøÁî®ËÄÖÂêçÁ®±Ëº∏ÂÖ• -->
    <div class="input-group">
      <input type="text" id="playerName" placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÂêçÂ≠ó" maxlength="10">
    </div>

    <!-- ËßíËâ≤È†êË¶Ω -->
    <div id="characterPreview">
      <img id="characterImage" src="img/avatars/avatar_astro1.png" alt="ËßíËâ≤È†êË¶Ω">
    </div>

    <!-- ËßíËâ≤Ê®ôË™û -->
    <div id="characterSlogan" style="
      font-size: 1.2rem;
      color: #ffd700;
      margin: 10px 0;
      text-shadow: 0 0 12px #ffd700, 0 0 24px #ff6b6b;
      font-weight: 600;
      letter-spacing: 1px;
      min-height: 1.5rem;
      font-style: italic;
      transition: all 0.2s ease-out;
      opacity: 1;
      transform: translateY(0);
    ">üåü ÂãáÊï¢ÁöÑÊòüÈöõÊà∞Â£´ÔºåÊ∫ñÂÇôÂ•ΩËøéÊé•ÊåëÊà∞‰∫ÜÂóéÔºü</div>

    <!-- È†≠ÂÉèÈÅ∏Êìá -->
    <div class="avatar-grid">
      <div class="avatar-option selected" style="background-image: url('img/avatars/avatar_TL.png');" onclick="selectAvatar(this, 'img/avatars/avatar_TL.png', 'üåü ÂãáÊï¢ÁöÑÊòüÈöõÊà∞Â£´ÔºåÊ∫ñÂÇôÂ•ΩËøéÊé•ÊåëÊà∞‰∫ÜÂóéÔºü', {rate: 0.9, pitch: 1.0, volume: 0.9, characterType: 'warrior'})"></div>
      <div class="avatar-option" style="background-image: url('img/avatars/avatar_TR.png');" onclick="selectAvatar(this, 'img/avatars/avatar_TR.png', '‚ö° ÈñÉÈõªËà¨ÁöÑÈÄüÂ∫¶ÔºåÁÑ°‰∫∫ËÉΩÊïµÔºÅ', {rate: 1.1, pitch: 1.2, volume: 0.9, characterType: 'speedster'})"></div>
      <div class="avatar-option" style="background-image: url('img/avatars/avatar_BL.png');" onclick="selectAvatar(this, 'img/avatars/avatar_BL.png', 'üõ°Ô∏è Â†Ö‰∏çÂèØÊëßÁöÑÈò≤Á¶¶ÔºåÂÆàË≠∑‰Ω†ÁöÑÂ§¢ÊÉ≥ÔºÅ', {rate: 0.8, pitch: 0.9, volume: 0.95, characterType: 'defender'})"></div>
      <div class="avatar-option" style="background-image: url('img/avatars/avatar_BR.png');" onclick="selectAvatar(this, 'img/avatars/avatar_BR.png', 'üéØ Á≤æÊ∫ñÁöÑÁûÑÊ∫ñÔºåÁôæÁôºÁôæ‰∏≠ÔºÅ', {rate: 0.95, pitch: 1.1, volume: 0.9, characterType: 'sharpshooter'})"></div>
      <div class="avatar-option" style="background-image: url('img/avatars/avatar_spacekid.png');" onclick="selectAvatar(this, 'img/avatars/avatar_spacekid.png', 'üåà Á¥îÁúüÁöÑÂøÉÈùàÔºåÂâµÈÄ†Â•áËπüÁöÑÂäõÈáèÔºÅ', {rate: 1.0, pitch: 1.3, volume: 0.85, characterType: 'magician'})"></div>
      <div class="avatar-option" style="background-image: url('img/avatars/avatar_astro1.png');" onclick="selectAvatar(this, 'img/avatars/avatar_astro1.png', 'üöÄ Êé¢Á¥¢Êú™Áü•ÁöÑÂÆáÂÆôÔºåÁôºÁèæÁÑ°ÈôêÂèØËÉΩÔºÅ', {rate: 0.85, pitch: 1.05, volume: 0.9, characterType: 'explorer'})"></div>
      <div class="avatar-option" style="background-image: url('img/avatars/vDS8zQP9HdvxX0g (1).png');" onclick="selectAvatar(this, 'img/avatars/vDS8zQP9HdvxX0g (1).png', 'üå∏ Ê∫´ÊüîÁöÑÊ´ªËä±Á≤æÈùàÔºåÊï£Êí≠ÁæéÂ•ΩËàáÂ∏åÊúõÔºÅ', {rate: 0.85, pitch: 1.05, volume: 0.9, characterType: 'fairy'})"></div>
      <div class="avatar-option custom-avatar-option" onclick="selectCustomAvatar(this)">
        <div class="custom-avatar-icon">üé®</div>
        <div class="custom-avatar-text">Ëá™Ë®Ç</div>
      </div>
    </div>

    <!-- ÂÖ¨ÂëäÈ°ØÁ§∫ÂçÄÂüü -->
    <div id="homeAnnouncements" class="home-announcements">
      <div class="announcements-header">
        <h3>üì£ ÊúÄÊñ∞ÂÖ¨Âëä</h3>
                  <div style="display: flex; gap: 10px; align-items: center;">
            <button class="view-all-btn" onclick="location.href='announcements.html'">Êü•ÁúãÂÖ®ÈÉ®</button>
          </div>
      </div>
      <div id="announcementsContent" class="announcements-content">
        <div class="loading-announcement">ËºâÂÖ•‰∏≠...</div>
      </div>
    </div>



    <!-- Ëá™Ë®ÇË®≠ÂÆöÂΩàÁ™ó -->
    <div id="customModal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h3>üé® Ëá™Ë®ÇËßíËâ≤Ë®≠ÂÆö</h3>
          <button class="modal-close" onclick="closeCustomModal()">‚úï</button>
        </div>
        
        <div class="modal-body">
          <div class="modal-avatar-section">
            <div class="modal-avatar-preview" id="modalAvatarPreview">
              <img id="modalAvatarImage" src="img/avatars/avatar_TL.png" alt="ÂΩàÁ™óÈ†≠ÂÉèÈ†êË¶Ω">
              <div class="modal-upload-overlay">
                <span>üì∑</span>
                <p>ÈªûÊìä‰∏äÂÇ≥</p>
              </div>
            </div>
            <input type="file" id="modalAvatarUpload" accept="image/*" style="display: none;">
            <div class="modal-avatar-buttons">
              <button class="modal-upload-btn" onclick="document.getElementById('modalAvatarUpload').click()">
                üìÅ ÈÅ∏ÊìáÂúñÁâá
              </button>
              <button class="modal-reset-btn" onclick="resetModalAvatar()">
                üîÑ ÈáçÁΩÆ
              </button>
            </div>
          </div>
          
          <div class="modal-info-section">
            <div class="modal-input-group">
              <label for="modalPlayerName">ËßíËâ≤ÂêçÁ®±:</label>
              <input type="text" id="modalPlayerName" placeholder="Ëº∏ÂÖ•‰Ω†ÁöÑËßíËâ≤ÂêçÁ®±" maxlength="15">
            </div>
            
            <div class="modal-input-group">
              <label for="modalSlogan">ËßíËâ≤Ê®ôË™û:</label>
              <textarea id="modalSlogan" placeholder="ÂØ´‰∏ã‰Ω†ÁöÑËßíËâ≤Ê®ôË™û..." maxlength="50" rows="2"></textarea>
            </div>
            
            <div class="modal-input-group">
              <label for="modalCharacterType">ËßíËâ≤È°ûÂûã:</label>
              <select id="modalCharacterType">
                <option value="warrior">Êà∞Â£´</option>
                <option value="speedster">ÈÄüÂ∫¶ËÄÖ</option>
                <option value="defender">Èò≤Á¶¶ËÄÖ</option>
                <option value="sharpshooter">Â∞ÑÊâã</option>
                <option value="magician">È≠îÊ≥ïÂ∏´</option>
                <option value="explorer">Êé¢Èö™ÂÆ∂</option>
                <option value="fairy">Á≤æÈùà</option>
                <option value="custom">Ëá™Ë®Ç</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="modal-footer">
          <button class="modal-cancel-btn" onclick="closeCustomModal()">
            ‚ùå ÂèñÊ∂à
          </button>
          <button class="modal-save-btn" onclick="saveModalCustomUser()">
            üíæ ÂÑ≤Â≠òË®≠ÂÆö
          </button>
        </div>
      </div>
    </div>

    <!-- ‰∏ªÊåâÈàïÂçÄÂüü -->
    <div class="main-buttons">
      <button class="btn" onclick="location.href='atlas.html'">üöÄ ÈñãÂßãÂÜíÈö™</button>
      <button class="btn" onclick="location.href='book.html'">üìö ÂñÆÂ≠óÊú¨</button>
      <button class="btn" onclick="location.href='grammar_tower_select.html'">üèõÔ∏è ÊñáÊ≥ïÂ°î</button>
      <button class="btn" onclick="location.href='article_practice.html'">üìù ÊñáÁ´†Á∑¥Áøí</button>
      <button class="btn" onclick="location.href='game_center_simple.html'">üéÆ ÈÅäÊà≤Â§ßÂª≥</button>
      <button class="btn" onclick="location.href='firebase_chat_enhanced.html'">üé≤ ÊäΩÂç°ËÅäÂ§©ÂÆ§</button>
      <button class="btn" onclick="location.href='shop.html'">üõí ÂïÜÂüé</button>
      <button class="btn" onclick="location.href='gacha.html'">üé≤ ÊäΩÂç°</button>
      <button class="btn" onclick="window.open('vocabulary_download.html', '_blank')" style="background: linear-gradient(135deg, #00ff88 0%, #00bfff 100%);">üì• ÂñÆÂ≠ó‰∏ãËºâ</button>
      <button class="btn announcement-btn" onclick="location.href='announcements.html'" style="background: linear-gradient(135deg, #ff6b6b 0%, #ffd700 100%); position: relative;">
        üì£ ÊúÄÊñ∞ÂÖ¨Âëä
        <span class="notification-badge" id="announcementBadge" style="display: none;">0</span>
      </button>

    </div>

    <div class="nav-buttons">
      <button class="nav-btn" id="cardsBtn" onclick="location.href='cards.html'">üìÅ Âç°ÁâáÊî∂Ëóè</button>
      <button class="nav-btn" id="achievementBtn" onclick="location.href='achievement.html'">üèÜ ÊàêÂ∞±Âã≥Á´†</button>
      <button class="nav-btn" onclick="location.href='stars_leaderboard.html'" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);">‚≠ê ÊòüÊòüÊéíË°åÊ¶ú</button>
    </div>
  </div>

  <!-- Èü≥ÊïàÊéßÂà∂ -->
  <div id="audioControls">
    <button id="toggleMusic" title="ËÉåÊôØÈü≥Ê®Ç">
      <span class="material-icons">music_note</span>
    </button>
  </div>

  <!-- Èü≥ÊïàÂÖÉÁ¥† -->
  <audio id="typingSound" preload="auto">
    <source src="sound/type.mp3" type="audio/mpeg">
  </audio>

  <audio id="backgroundMusic" loop>
    <source src="sound/ÂçàÂæåÊîæÈ¨ÜÊôÇÂÖâÔºàÁ¥îÈü≥Ê®ÇÔºâ.mp3" type="audio/mpeg">
  </audio>

  <!-- ÂñÆÂ≠ó‰∏ãËºâ‰∏≠ÂøÉÊ®°ÊÖãË¶ñÁ™ó -->
  <div id="vocabularyDownloadModal" class="modal-overlay" style="display: none;">
    <div class="modal-content" style="max-width: 1200px; max-height: 90vh; overflow-y: auto; background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%);">
      <div class="modal-header">
        <h2>üöÄ ÂñÆÂ≠óÊ™îÊ°à‰∏ãËºâ‰∏≠ÂøÉ üåå</h2>
        <button class="close-btn" onclick="closeVocabularyDownload()">‚úï</button>
      </div>
      <div class="modal-body">
        <div id="vocabularyDownloadApp">
          <!-- Vue.js ÊáâÁî®Â∞áÂú®ÈÄôË£°Ê∏≤Êüì -->
        </div>
      </div>
    </div>
  </div>

  <script src="js/userData.js"></script>
  <script src="js/sound.js"></script>
  <script src="js/achievementSystem.js"></script>
  <script src="js/characterDialogue.js"></script>
  <script src="js/cards.js"></script>
  <script>
    console.log('=== JavaScriptÈñãÂßãÂü∑Ë°å ===');
    
    // ÊàêÂ∞±Á≥ªÁµ±Êï∏ÊìöÔºàËàáachievement.html‰øùÊåÅ‰∏ÄËá¥Ôºâ
    const achievements = [
      { id: 'bronze', name: 'ÈäÖÁâåÊî∂ÈõÜËÄÖ', requirement: 10, reward: 5, icon: 'ü•â', type: 'collection', description: 'Êî∂ÈõÜ10ÂºµÂç°ÁâáÔºåÈñãÂßã‰Ω†ÁöÑÊî∂ÈõÜ‰πãÊóÖ' },
      { id: 'silver', name: 'ÈäÄÁâåÊî∂ÈõÜËÄÖ', requirement: 25, reward: 15, icon: 'ü•à', type: 'collection', description: 'Êî∂ÈõÜ25ÂºµÂç°ÁâáÔºåÂ±ïÁèæ‰Ω†ÁöÑÊî∂ÈõÜÂØ¶Âäõ' },
      { id: 'gold', name: 'ÈáëÁâåÊî∂ÈõÜËÄÖ', requirement: 50, reward: 30, icon: 'ü•á', type: 'collection', description: 'Êî∂ÈõÜ50ÂºµÂç°ÁâáÔºåÊàêÁÇ∫ÁúüÊ≠£ÁöÑÊî∂ÈõÜËÄÖ' },
      { id: 'platinum', name: 'ÁôΩÈáëÊî∂ÈõÜËÄÖ', requirement: 100, reward: 60, icon: 'üíé', type: 'collection', description: 'Êî∂ÈõÜ100ÂºµÂç°ÁâáÔºåÈÅîÂà∞ÁôΩÈáëÁ≠âÁ¥ö' },
      { id: 'diamond', name: 'ÈëΩÁü≥Êî∂ÈõÜËÄÖ', requirement: 200, reward: 120, icon: 'üí†', type: 'collection', description: 'Êî∂ÈõÜ200ÂºµÂç°ÁâáÔºåÁç≤ÂæóÈëΩÁü≥Ê¶ÆËÄÄ' },
      { id: 'master', name: 'Êî∂ÈõÜÂ§ßÂ∏´', requirement: 500, reward: 300, icon: 'üëë', type: 'collection', description: 'Êî∂ÈõÜ500ÂºµÂç°ÁâáÔºåÊàêÁÇ∫Êî∂ÈõÜÂ§ßÂ∏´' },
      { id: 'common_master', name: 'ÊôÆÈÄöÂç°Â§ßÂ∏´', requirement: 50, reward: 20, icon: 'üìö', type: 'rarity', rarity: 'ÊôÆÈÄö', description: 'Êî∂ÈõÜ50ÂºµÊôÆÈÄöÂç°ÁâáÔºåÊéåÊè°Âü∫Á§éË©ûÂΩô' },
      { id: 'rare_master', name: 'Á®ÄÊúâÂç°Â§ßÂ∏´', requirement: 30, reward: 40, icon: 'üîÆ', type: 'rarity', rarity: 'Á®ÄÊúâ', description: 'Êî∂ÈõÜ30ÂºµÁ®ÄÊúâÂç°ÁâáÔºåÊì¥Â±ïË©ûÂΩôÁØÑÂúç' },
      { id: 'epic_master', name: 'Ë∂ÖÁ®ÄÊúâÂ§ßÂ∏´', requirement: 20, reward: 80, icon: 'üåü', type: 'rarity', rarity: 'Ë∂ÖÁ®ÄÊúâ', description: 'Êî∂ÈõÜ20ÂºµË∂ÖÁ®ÄÊúâÂç°ÁâáÔºåÊéåÊè°È´òÁ¥öË©ûÂΩô' },
      { id: 'shard_collector', name: 'Á¢éÁâáÊî∂ÈõÜËÄÖ', requirement: 100, reward: 25, icon: 'üíé', type: 'shards', description: 'Êî∂ÈõÜ100ÂÄãÁ¢éÁâáÔºåÈñãÂßãÁ¢éÁâáÊî∂ÈõÜ‰πãË∑Ø' },
      { id: 'shard_hoarder', name: 'Á¢éÁâáÂõ§Á©çËÄÖ', requirement: 500, reward: 100, icon: 'üè¶', type: 'shards', description: 'Êî∂ÈõÜ500ÂÄãÁ¢éÁâáÔºåÊàêÁÇ∫Á¢éÁâáÂõ§Á©çËÄÖ' },
      { id: 'shard_master', name: 'Á¢éÁâáÂ§ßÂ∏´', requirement: 1000, reward: 200, icon: 'üíç', type: 'shards', description: 'Êî∂ÈõÜ1000ÂÄãÁ¢éÁâáÔºåÊàêÁÇ∫Á¢éÁâáÂ§ßÂ∏´' },
      { id: 'first_card', name: 'ÂàùÂ≠∏ËÄÖ', requirement: 1, reward: 1, icon: 'üéØ', type: 'special', description: 'Áç≤ÂæóÁ¨¨‰∏ÄÂºµÂç°ÁâáÔºåÈñãÂßãÂ≠∏Áøí‰πãÊóÖ' },
      { id: 'lucky_starter', name: 'Âπ∏ÈÅãÊñ∞Êâã', requirement: 5, reward: 5, icon: 'üçÄ', type: 'special', description: 'Áç≤Âæó5ÂºµÂç°ÁâáÔºåÂ±ïÁèæ‰Ω†ÁöÑÂπ∏ÈÅã' },
      { id: 'dedicated', name: 'Â∞àÊ≥®Â≠∏ÁøíËÄÖ', requirement: 25, reward: 20, icon: 'ÔøΩÔøΩ', type: 'special', description: 'Áç≤Âæó25ÂºµÂç°ÁâáÔºåÂ±ïÁèæ‰Ω†ÁöÑÂ∞àÊ≥®' },
      { id: 'persistent', name: 'Â†ÖÊåÅ‰∏çÊáà', requirement: 75, reward: 60, icon: 'üí™', type: 'special', description: 'Áç≤Âæó75ÂºµÂç°ÁâáÔºåÂ±ïÁèæ‰Ω†ÁöÑÂ†ÖÊåÅ' },
      { id: 'vocabulary_king', name: 'Ë©ûÂΩô‰πãÁéã', requirement: 150, reward: 150, icon: 'üëë', type: 'special', description: 'Áç≤Âæó150ÂºµÂç°ÁâáÔºåÊàêÁÇ∫Ë©ûÂΩô‰πãÁéã' },
      { id: 'language_legend', name: 'Ë™ûË®ÄÂÇ≥Â•á', requirement: 300, reward: 300, icon: 'üèÜ', type: 'special', description: 'Áç≤Âæó300ÂºµÂç°ÁâáÔºåÊàêÁÇ∫Ë™ûË®ÄÂÇ≥Â•á' },
      { id: 'daily_1', name: 'ÊØèÊó•Á∞ΩÂà∞1Â§©', requirement: 1, reward: 2, icon: 'üìÖ', type: 'daily', description: 'ÈÄ£Á∫åÁ∞ΩÂà∞1Â§©ÔºåÈ§äÊàêÂ•ΩÁøíÊÖ£' },
      { id: 'daily_7', name: 'ÊØèÊó•Á∞ΩÂà∞7Â§©', requirement: 7, reward: 10, icon: 'üìÜ', type: 'daily', description: 'ÈÄ£Á∫åÁ∞ΩÂà∞7Â§©ÔºåÂ†ÖÊåÅ‰∏ÄÈÄ±' },
      { id: 'daily_30', name: 'ÊØèÊó•Á∞ΩÂà∞30Â§©', requirement: 30, reward: 50, icon: 'üóìÔ∏è', type: 'daily', description: 'ÈÄ£Á∫åÁ∞ΩÂà∞30Â§©ÔºåÂ†ÖÊåÅ‰∏ÄÂÄãÊúà' },
      { id: 'daily_100', name: 'ÊØèÊó•Á∞ΩÂà∞100Â§©', requirement: 100, reward: 200, icon: 'üìä', type: 'daily', description: 'ÈÄ£Á∫åÁ∞ΩÂà∞100Â§©ÔºåÊàêÁÇ∫Âø†ÂØ¶Áî®Êà∂' },
      { id: 'star_collector', name: 'ÊòüÊòüÊî∂ÈõÜËÄÖ', requirement: 100, reward: 10, icon: '‚≠ê', type: 'stars', description: 'Êî∂ÈõÜ100È°ÜÊòüÊòüÔºåÈñãÂßãÊòüÊòüÊî∂ÈõÜ' },
      { id: 'star_hoarder', name: 'ÊòüÊòüÂõ§Á©çËÄÖ', requirement: 500, reward: 50, icon: '‚ú®', type: 'stars', description: 'Êî∂ÈõÜ500È°ÜÊòüÊòüÔºåÊàêÁÇ∫ÊòüÊòüÂõ§Á©çËÄÖ' },
      { id: 'star_master', name: 'ÊòüÊòüÂ§ßÂ∏´', requirement: 1000, reward: 100, icon: 'üåü', type: 'stars', description: 'Êî∂ÈõÜ1000È°ÜÊòüÊòüÔºåÊàêÁÇ∫ÊòüÊòüÂ§ßÂ∏´' },
      { id: 'star_legend', name: 'ÊòüÊòüÂÇ≥Â•á', requirement: 5000, reward: 500, icon: 'üí´', type: 'stars', description: 'Êî∂ÈõÜ5000È°ÜÊòüÊòüÔºåÊàêÁÇ∫ÊòüÊòüÂÇ≥Â•á' },
      { id: 'speed_learner', name: 'Âø´ÈÄüÂ≠∏ÁøíËÄÖ', requirement: 10, reward: 15, icon: '‚ö°', type: 'performance', description: 'ÈÄöÈÅé10ÂÄãÈóúÂç°ÔºåÂ±ïÁèæÂø´ÈÄüÂ≠∏ÁøíËÉΩÂäõ' },
      { id: 'accuracy_master', name: 'Ê∫ñÁ¢∫Â§ßÂ∏´', requirement: 20, reward: 25, icon: 'üéØ', type: 'performance', description: 'ÈÄöÈÅé20ÂÄãÈóúÂç°ÔºåÂ±ïÁèæÊ∫ñÁ¢∫ÁöÑÂ≠∏ÁøíËÉΩÂäõ' },
      { id: 'combo_king', name: 'ÈÄ£Êìä‰πãÁéã', requirement: 15, reward: 30, icon: 'üî•', type: 'performance', description: 'ÈÄöÈÅé15ÂÄãÈóúÂç°ÔºåÂ±ïÁèæÈÄ£ÊìäËÉΩÂäõ' },
      { id: 'fill_beginner', name: 'Â°´Á©∫Êñ∞Êâã', requirement: 1, reward: 5, icon: 'üìù', type: 'fill', description: 'ÂÆåÊàêÁ¨¨‰∏ÄÊ¨°Â°´Á©∫ÊåëÊà∞' },
      { id: 'fill_regular', name: 'Â°´Á©∫Â∏∏ÂÆ¢', requirement: 10, reward: 20, icon: 'üìã', type: 'fill', description: 'ÂÆåÊàê10Ê¨°Â°´Á©∫ÊåëÊà∞' },
      { id: 'fill_expert', name: 'Â°´Á©∫Â∞àÂÆ∂', requirement: 50, reward: 80, icon: 'üìä', type: 'fill', description: 'ÂÆåÊàê50Ê¨°Â°´Á©∫ÊåëÊà∞' },
      { id: 'fill_master', name: 'Â°´Á©∫Â§ßÂ∏´', requirement: 100, reward: 150, icon: 'üèÜ', type: 'fill', description: 'ÂÆåÊàê100Ê¨°Â°´Á©∫ÊåëÊà∞' },
      { id: 'fill_perfect', name: 'ÂÆåÁæéÂ°´Á©∫', requirement: 1, reward: 30, icon: 'üíØ', type: 'fill', description: 'Âú®Â°´Á©∫ÊåëÊà∞‰∏≠Áç≤ÂæóÊªøÂàÜ' },
      { id: 'fill_speed', name: 'Âø´ÈÄüÂ°´Á©∫', requirement: 5, reward: 25, icon: '‚ö°', type: 'fill', description: 'Âú®5Ê¨°Â°´Á©∫ÊåëÊà∞‰∏≠Âπ≥ÂùáÊôÇÈñìÂ∞ëÊñº15Áßí' },
      { id: 'fill_streak', name: 'ÈÄ£Á∫åÂ°´Á©∫', requirement: 7, reward: 40, icon: 'üî•', type: 'fill', description: 'ÈÄ£Á∫å7Â§©ÂÆåÊàêÂ°´Á©∫ÊåëÊà∞' },
      { id: 'fill_vocab', name: 'Ë©ûÂΩôÂ°´Á©∫', requirement: 100, reward: 60, icon: 'üìö', type: 'fill', description: 'Âú®Â°´Á©∫ÊåëÊà∞‰∏≠Á≠îÂ∞ç100ÂÄãÂñÆÂ≠ó' },
      { id: 'vocab_beginner', name: 'ÂñÆÂ≠óÊñ∞Êâã', requirement: 10, reward: 15, icon: 'üìñ', type: 'vocabulary', description: 'Á≠îÂ∞ç10ÂÄãÂñÆÂ≠óÊú¨ÁöÑÂñÆÂ≠óÔºåÈñãÂßãÂñÆÂ≠óÂ≠∏Áøí‰πãÊóÖ' },
      { id: 'vocab_regular', name: 'ÂñÆÂ≠óÂ∏∏ÂÆ¢', requirement: 50, reward: 40, icon: 'üìö', type: 'vocabulary', description: 'Á≠îÂ∞ç50ÂÄãÂñÆÂ≠óÊú¨ÁöÑÂñÆÂ≠óÔºåÂ±ïÁèæÂ≠∏ÁøíÁÜ±ÊÉÖ' },
      { id: 'vocab_expert', name: 'ÂñÆÂ≠óÂ∞àÂÆ∂', requirement: 100, reward: 80, icon: 'üéì', type: 'vocabulary', description: 'Á≠îÂ∞ç100ÂÄãÂñÆÂ≠óÊú¨ÁöÑÂñÆÂ≠óÔºåÊàêÁÇ∫ÂñÆÂ≠óÂ∞àÂÆ∂' },
      { id: 'vocab_master', name: 'ÂñÆÂ≠óÂ§ßÂ∏´', requirement: 200, reward: 150, icon: 'üëë', type: 'vocabulary', description: 'Á≠îÂ∞ç200ÂÄãÂñÆÂ≠óÊú¨ÁöÑÂñÆÂ≠óÔºåÊàêÁÇ∫ÂñÆÂ≠óÂ§ßÂ∏´' },
      { id: 'vocab_legend', name: 'ÂñÆÂ≠óÂÇ≥Â•á', requirement: 500, reward: 300, icon: 'üèÜ', type: 'vocabulary', description: 'Á≠îÂ∞ç500ÂÄãÂñÆÂ≠óÊú¨ÁöÑÂñÆÂ≠óÔºåÊàêÁÇ∫ÂñÆÂ≠óÂÇ≥Â•á' },
      // ÊòüÂ∫ßÊàêÂ∞±
      { id: 'pass_aries', name: 'ÈÄöÈÅéÁôΩÁæäÂ∫ß', requirement: 1, reward: 5, icon: '‚ôà', type: 'zodiac', description: 'ÈÄöÈÅéÁôΩÁæäÂ∫ßÈóúÂç°', rewardRange: [5,5] },
      { id: 'pass_taurus', name: 'ÈÄöÈÅéÈáëÁâõÂ∫ß', requirement: 1, reward: 5, icon: '‚ôâ', type: 'zodiac', description: 'ÈÄöÈÅéÈáëÁâõÂ∫ßÈóúÂç°', rewardRange: [5,5] },
      { id: 'pass_gemini', name: 'ÈÄöÈÅéÈõôÂ≠êÂ∫ß', requirement: 1, reward: 5, icon: '‚ôä', type: 'zodiac', description: 'ÈÄöÈÅéÈõôÂ≠êÂ∫ßÈóúÂç°', rewardRange: [5,5] },
      { id: 'pass_cancer', name: 'ÈÄöÈÅéÂ∑®ËüπÂ∫ß', requirement: 1, reward: 7, icon: '‚ôã', type: 'zodiac', description: 'ÈÄöÈÅéÂ∑®ËüπÂ∫ßÈóúÂç°', rewardRange: [7,10] },
      { id: 'pass_leo', name: 'ÈÄöÈÅéÁçÖÂ≠êÂ∫ß', requirement: 1, reward: 8, icon: '‚ôå', type: 'zodiac', description: 'ÈÄöÈÅéÁçÖÂ≠êÂ∫ßÈóúÂç°', rewardRange: [8,12] },
      { id: 'pass_virgo', name: 'ÈÄöÈÅéËôïÂ•≥Â∫ß', requirement: 1, reward: 9, icon: '‚ôç', type: 'zodiac', description: 'ÈÄöÈÅéËôïÂ•≥Â∫ßÈóúÂç°', rewardRange: [9,13] },
      { id: 'pass_libra', name: 'ÈÄöÈÅéÂ§©Áß§Â∫ß', requirement: 1, reward: 10, icon: '‚ôé', type: 'zodiac', description: 'ÈÄöÈÅéÂ§©Áß§Â∫ßÈóúÂç°', rewardRange: [10,14] },
      { id: 'pass_scorpio', name: 'ÈÄöÈÅéÂ§©Ë†çÂ∫ß', requirement: 1, reward: 11, icon: '‚ôè', type: 'zodiac', description: 'ÈÄöÈÅéÂ§©Ë†çÂ∫ßÈóúÂç°', rewardRange: [11,15] },
      { id: 'pass_sagittarius', name: 'ÈÄöÈÅéÂ∞ÑÊâãÂ∫ß', requirement: 1, reward: 12, icon: '‚ôê', type: 'zodiac', description: 'ÈÄöÈÅéÂ∞ÑÊâãÂ∫ßÈóúÂç°', rewardRange: [12,16] },
      { id: 'pass_capricorn', name: 'ÈÄöÈÅéÊë©ÁæØÂ∫ß', requirement: 1, reward: 13, icon: '‚ôë', type: 'zodiac', description: 'ÈÄöÈÅéÊë©ÁæØÂ∫ßÈóúÂç°', rewardRange: [13,17] },
      { id: 'pass_aquarius', name: 'ÈÄöÈÅéÊ∞¥Áì∂Â∫ß', requirement: 1, reward: 14, icon: '‚ôí', type: 'zodiac', description: 'ÈÄöÈÅéÊ∞¥Áì∂Â∫ßÈóúÂç°', rewardRange: [14,18] },
      { id: 'pass_pisces', name: 'ÈÄöÈÅéÈõôÈ≠öÂ∫ß', requirement: 1, reward: 15, icon: '‚ôì', type: 'zodiac', description: 'ÈÄöÈÅéÈõôÈ≠öÂ∫ßÈóúÂç°', rewardRange: [15,20] },
      { id: 'pass_andromeda', name: 'ÈÄöÈÅé‰ªôÂ•≥Â∫ß', requirement: 1, reward: 16, icon: 'üë∏', type: 'zodiac', description: 'ÈÄöÈÅé‰ªôÂ•≥Â∫ßÈóúÂç°', rewardRange: [16,20] },
      { id: 'pass_cygnus', name: 'ÈÄöÈÅéÂ§©ÈµùÂ∫ß', requirement: 1, reward: 17, icon: 'ü¶¢', type: 'zodiac', description: 'ÈÄöÈÅéÂ§©ÈµùÂ∫ßÈóúÂç°', rewardRange: [17,20] },
      { id: 'pass_orion', name: 'ÈÄöÈÅéÁçµÊà∂Â∫ß', requirement: 1, reward: 17, icon: 'üèπ', type: 'zodiac', description: 'ÈÄöÈÅéÁçµÊà∂Â∫ßÈóúÂç°', rewardRange: [17,20] },
      { id: 'pass_pegasus', name: 'ÈÄöÈÅéÈ£õÈ¶¨Â∫ß', requirement: 1, reward: 17, icon: 'ü¶Ñ', type: 'zodiac', description: 'ÈÄöÈÅéÈ£õÈ¶¨Â∫ßÈóúÂç°', rewardRange: [17,20] },
      { id: 'pass_cassiopeia', name: 'ÈÄöÈÅé‰ªôÂêéÂ∫ß', requirement: 1, reward: 17, icon: 'üëë', type: 'zodiac', description: 'ÈÄöÈÅé‰ªôÂêéÂ∫ßÈóúÂç°', rewardRange: [17,20] },
      { id: 'pass_scorpius', name: 'ÈÄöÈÅéÂ§©Ë†çÂ∫ß', requirement: 1, reward: 17, icon: 'ü¶Ç', type: 'zodiac', description: 'ÈÄöÈÅéÂ§©Ë†çÂ∫ßÈóúÂç°', rewardRange: [17,20] },
      { id: 'pass_phoenix', name: 'ÈÄöÈÅéÈ≥≥Âá∞Â∫ß', requirement: 1, reward: 17, icon: 'üî•', type: 'zodiac', description: 'ÈÄöÈÅéÈ≥≥Âá∞Â∫ßÈóúÂç°', rewardRange: [17,20] },
      { id: 'pass_vela', name: 'ÈÄöÈÅéËàπÂ∏ÜÂ∫ß', requirement: 1, reward: 17, icon: '‚õµ', type: 'zodiac', description: 'ÈÄöÈÅéËàπÂ∏ÜÂ∫ßÈóúÂç°', rewardRange: [17,20] },
    ];

    // Áç≤Âèñ‰∏¶È°ØÁ§∫ÊòüÊòüÁ∏ΩÊï∏
    function updateStarsDisplay() {
      LinkageSystem.stars.updateDisplay();
    }

    // È†ÅÈù¢ËºâÂÖ•ÊôÇÊõ¥Êñ∞ÊòüÊòüÈ°ØÁ§∫
    updateStarsDisplay();

    // ÊàêÂ∞±Á≥ªÁµ±Áõ∏ÈóúÂáΩÊï∏
    function getClaimedAchievements() {
      return JSON.parse(localStorage.getItem('claimedAchievements') || '[]');
    }

    function checkAchievementUnlocked(ach) {
      const ownedCards = JSON.parse(localStorage.getItem('ownedCards') || '{}');
      const shards = JSON.parse(localStorage.getItem('cardShards') || '{}');
      
      switch (ach.type) {
        case 'collection':
        case 'special':
          return Object.keys(ownedCards).length >= ach.requirement;
        case 'rarity':
          // Ê™¢Êü•Á®ÄÊúâÂ∫¶Âç°ÁâáÊï∏Èáè
          if (window.allCards) {
            const cardsByRarity = window.allCards.filter(card => 
              card.rarity === ach.rarity && ownedCards[card.word]
            );
            return cardsByRarity.length >= ach.requirement;
          }
          return false; // Â¶ÇÊûúÊ≤íÊúâallCardsÊï∏ÊìöÔºåËøîÂõûfalse
        case 'shards':
          return Object.values(shards).reduce((sum, c) => sum + c, 0) >= ach.requirement;
        case 'daily':
          return parseInt(localStorage.getItem('loginDays') || '0') >= ach.requirement;
        case 'stars':
          return parseInt(localStorage.getItem('totalStars') || '0') >= ach.requirement;
        case 'performance':
          const fillGames = parseInt(localStorage.getItem('fillGamesCompleted') || '0');
          const cardGames = parseInt(localStorage.getItem('cardGamesCompleted') || '0');
          const quizGames = parseInt(localStorage.getItem('quizGamesCompleted') || '0');
          const spellingGames = parseInt(localStorage.getItem('spellingGamesCompleted') || '0');
          const matchingGames = parseInt(localStorage.getItem('matchingGamesCompleted') || '0');
          const timeChallengeGames = parseInt(localStorage.getItem('timeChallengeGamesCompleted') || '0');
          return (fillGames + cardGames + quizGames + spellingGames + matchingGames + timeChallengeGames) >= ach.requirement;
        case 'fill':
          switch (ach.id) {
            case 'fill_beginner':
            case 'fill_regular':
            case 'fill_expert':
            case 'fill_master':
              return parseInt(localStorage.getItem('fillGamesCompleted') || '0') >= ach.requirement;
            case 'fill_perfect':
              return parseInt(localStorage.getItem('fillPerfectScores') || '0') >= ach.requirement;
            case 'fill_speed':
              return parseInt(localStorage.getItem('fillSpeedGames') || '0') >= ach.requirement;
            case 'fill_streak':
              return parseInt(localStorage.getItem('fillStreakDays') || '0') >= ach.requirement;
            case 'fill_vocab':
              return parseInt(localStorage.getItem('fillCorrectWords') || '0') >= ach.requirement;
            default:
              return false;
          }
        case 'vocabulary':
          return parseInt(localStorage.getItem('vocabularyCorrectWords') || '0') >= ach.requirement;
        case 'zodiac':
          // ÊòüÂ∫ßÈóúÂç°ÊàêÂ∞±ÔºöÊ™¢Êü•Ë©≤ÊòüÂ∫ßÊòØÂê¶Â∑≤ÈÄöÈÅé
          const zodiacKey = ach.id.replace('pass_', '');
          const passedAtlas = JSON.parse(localStorage.getItem('passed_atlas') || '[]');
          return passedAtlas.includes(zodiacKey);
        default:
          return false;
      }
    }

    // Ë®àÁÆóÂèØÈ†òÂèñÊàêÂ∞±Êï∏Èáè
    function getUnclaimedAchievementsCount() {
      const claimed = getClaimedAchievements();
      return achievements.filter(ach => 
        checkAchievementUnlocked(ach) && !claimed.includes(ach.id)
      ).length;
    }

    // Êõ¥Êñ∞ÊàêÂ∞±ÊåâÈàïÁöÑÊ≥°Ê≥°
    function updateAchievementBadge() {
      const achievementBtn = document.getElementById('achievementBtn');
      if (!achievementBtn) {
        console.log('Êâæ‰∏çÂà∞ÊàêÂ∞±ÊåâÈàï');
        return;
      }

      const unclaimedCount = getUnclaimedAchievementsCount();
      console.log('ÂèØÈ†òÂèñÊàêÂ∞±Êï∏Èáè:', unclaimedCount);
      
      // ÁßªÈô§ÁèæÊúâÁöÑÊ≥°Ê≥°
      const existingBadge = achievementBtn.querySelector('.achievement-badge');
      if (existingBadge) {
        existingBadge.remove();
      }

      // Â¶ÇÊûúÊúâÂèØÈ†òÂèñÁöÑÊàêÂ∞±ÔºåÊ∑ªÂä†Ê≥°Ê≥°
      if (unclaimedCount > 0) {
        console.log('Ê∑ªÂä†ÊàêÂ∞±Ê≥°Ê≥°ÔºåÊï∏Èáè:', unclaimedCount);
        const badge = document.createElement('div');
        badge.className = 'achievement-badge';
        badge.textContent = unclaimedCount;
        achievementBtn.appendChild(badge);
      } else {
        console.log('Ê≤íÊúâÂèØÈ†òÂèñÁöÑÊàêÂ∞±');
      }
    }

    // ÂÆöÊúüÊ™¢Êü•ÊàêÂ∞±ÁãÄÊÖãÔºàÊØè30ÁßíÊ™¢Êü•‰∏ÄÊ¨°Ôºâ
    setInterval(updateAchievementBadge, 30000);

    // È†ÅÈù¢Áç≤ÂæóÁÑ¶ÈªûÊôÇ‰πüÊ™¢Êü•‰∏ÄÊ¨°
    window.addEventListener('focus', updateAchievementBadge);
    


    // È†≠ÂÉèÈÅ∏Êìá
    function selectAvatar(element, imagePath, slogan, voiceSettings) {
      // ÁßªÈô§ÂÖ∂‰ªñÈ†≠ÂÉèÁöÑÈÅ∏‰∏≠ÁãÄÊÖã
      document.querySelectorAll('.avatar-option').forEach(avatar => {
        avatar.classList.remove('selected');
      });
      
      // Ê∑ªÂä†ÈÅ∏‰∏≠ÁãÄÊÖã
      element.classList.add('selected');
      
      // Êõ¥Êñ∞È†≠ÂÉèÂíåËßíËâ≤È†êË¶Ω
      LinkageSystem.player.setAvatar(imagePath);
      
      // ‰øùÂ≠òÈÅ∏ÊìáÂà∞Êú¨Âú∞Â≠òÂÑ≤
      localStorage.setItem('selectedAvatar', imagePath);
      localStorage.setItem('selectedSlogan', slogan);
      localStorage.setItem('selectedVoiceSettings', JSON.stringify(voiceSettings));
      
      // Êõ¥Êñ∞ËßíËâ≤È†êË¶ΩÂúñÁâá
      document.getElementById('characterImage').src = imagePath;
      
      // Êõ¥Êñ∞ËßíËâ≤Ê®ôË™ûÔºàÂ∏∂ÂãïÁï´ÊïàÊûúÔºâ
      const sloganElement = document.getElementById('characterSlogan');
      sloganElement.style.opacity = '0';
      sloganElement.style.transform = 'translateY(20px)';
      
      setTimeout(() => {
        sloganElement.textContent = slogan;
        sloganElement.style.opacity = '1';
        sloganElement.style.transform = 'translateY(0)';
        
        // Ë™ûÈü≥ÊúóËÆÄÂäüËÉΩÂ∑≤ÁßªÈô§
        
        // Ëß∏ÁôºËßíËâ≤Â∞çË©±Á≥ªÁµ±
        if (window.CharacterDialogue) {
          // Êõ¥Êñ∞Áï∂ÂâçËßíËâ≤Ë®≠ÂÆö
          window.CharacterDialogue.currentCharacter = voiceSettings.characterType || 'warrior';
          // È°ØÁ§∫ËßíËâ≤Ê≠°ËøéÂ∞çË©±
          setTimeout(() => {
            window.CharacterDialogue.showWelcomeDialogue();
          }, 1000);
        }
      }, 200);
    }

    // Ëá™Ë®ÇÈ†≠ÂÉèÈÅ∏Êìá
    function selectCustomAvatar(element) {
      // ÁßªÈô§ÂÖ∂‰ªñÈ†≠ÂÉèÁöÑÈÅ∏‰∏≠ÁãÄÊÖã
      document.querySelectorAll('.avatar-option').forEach(avatar => {
        avatar.classList.remove('selected');
      });
      
      // Ê∑ªÂä†ÈÅ∏‰∏≠ÁãÄÊÖã
      element.classList.add('selected');
      
      // È°ØÁ§∫ÂΩàÁ™ó
      showCustomModal();
      
      // Êí≠ÊîæÈü≥Êïà
      playTypingSound();
    }

    // È°ØÁ§∫Ëá™Ë®ÇË®≠ÂÆöÂΩàÁ™ó
    function showCustomModal() {
      const modal = document.getElementById('customModal');
      
      if (!modal) {
        console.error('‚ùå Êâæ‰∏çÂà∞Ëá™Ë®ÇÂΩàÁ™óÂÖÉÁ¥†');
        showCustomMessage('‚ùå ÂΩàÁ™óËºâÂÖ•Â§±Êïó', 'error');
        return;
      }
      
      console.log('üé® È°ØÁ§∫Ëá™Ë®ÇËßíËâ≤ÂΩàÁ™ó');
      
      // ËºâÂÖ•ÁèæÊúâÁöÑËá™Ë®ÇË≥áÊñôÂà∞ÂΩàÁ™ó
      loadModalData();
      
      // È°ØÁ§∫ÂΩàÁ™ó
      modal.classList.add('show');
      
      // Á¶ÅÊ≠¢ËÉåÊôØÊªæÂãï
      document.body.style.overflow = 'hidden';
      
      console.log('‚úÖ Ëá™Ë®ÇËßíËâ≤ÂΩàÁ™óÂ∑≤È°ØÁ§∫');
    }

    // ÈóúÈñâËá™Ë®ÇË®≠ÂÆöÂΩàÁ™ó
    function closeCustomModal() {
      console.log('üîí ÈóúÈñâËá™Ë®ÇËßíËâ≤ÂΩàÁ™ó...');
      
      const modal = document.getElementById('customModal');
      if (modal) {
        modal.classList.remove('show');
        console.log('‚úÖ ÂΩàÁ™óÂ∑≤Èö±Ëóè');
      } else {
        console.error('‚ùå Êâæ‰∏çÂà∞ÂΩàÁ™óÂÖÉÁ¥†');
      }
      
      // ÊÅ¢Âæ©ËÉåÊôØÊªæÂãï
      document.body.style.overflow = 'auto';
      console.log('‚úÖ ËÉåÊôØÊªæÂãïÂ∑≤ÊÅ¢Âæ©');
      
      // Âº∑Âà∂ÈáçÊñ∞ÂïüÁî®ÊªæÂãï
      setTimeout(() => {
        document.body.style.overflow = 'auto';
        document.documentElement.style.overflow = 'auto';
        console.log('üîÑ Âº∑Âà∂ÊÅ¢Âæ©ÊªæÂãïÂÆåÊàê');
      }, 100);
    }

    // ËºâÂÖ•Ë≥áÊñôÂà∞ÂΩàÁ™ó
    function loadModalData() {
      console.log('üìÇ ËºâÂÖ•ÂΩàÁ™óË≥áÊñô...');
      
      const customUserData = localStorage.getItem('customUserData');
      if (customUserData) {
        try {
          const customData = JSON.parse(customUserData);
          console.log('üìÇ ÊâæÂà∞Ëá™Ë®ÇË≥áÊñô:', customData);
          
          // Êõ¥Êñ∞ÂΩàÁ™ó‰∏≠ÁöÑË≥áÊñô
          const nameInput = document.getElementById('modalPlayerName');
          const sloganInput = document.getElementById('modalSlogan');
          const typeSelect = document.getElementById('modalCharacterType');
          const avatarImg = document.getElementById('modalAvatarImage');
          
          if (nameInput) nameInput.value = customData.name || '';
          if (sloganInput) sloganInput.value = customData.slogan || '';
          if (typeSelect) typeSelect.value = customData.characterType || 'warrior';
          
          if (customData.avatarDataUrl && avatarImg) {
            avatarImg.src = customData.avatarDataUrl;
          }
          
          console.log('‚úÖ ÂΩàÁ™óË≥áÊñôËºâÂÖ•ÂÆåÊàê');
        } catch (e) {
          console.error('‚ùå ËºâÂÖ•ÂΩàÁ™óË≥áÊñôÂ§±Êïó:', e);
        }
      } else {
        console.log('üìÇ Ê≤íÊúâÊâæÂà∞Ëá™Ë®ÇË≥áÊñôÔºå‰ΩøÁî®È†êË®≠ÂÄº');
      }
    }

    // ÈáçÁΩÆÂΩàÁ™óÈ†≠ÂÉè
    function resetModalAvatar() {
      document.getElementById('modalAvatarImage').src = 'img/avatars/avatar_TL.png';
      document.getElementById('modalPlayerName').value = '';
      document.getElementById('modalSlogan').value = '';
      document.getElementById('modalCharacterType').value = 'warrior';
      document.getElementById('modalAvatarUpload').value = '';
      
      showCustomMessage('üîÑ Â∑≤ÈáçÁΩÆÂΩàÁ™óË®≠ÂÆö', 'info');
    }

    // ÂÑ≤Â≠òÂΩàÁ™óËá™Ë®Ç‰ΩøÁî®ËÄÖ
    function saveModalCustomUser() {
      console.log('üíæ ÂÑ≤Â≠òËá™Ë®ÇËßíËâ≤...');
      
      const modalName = document.getElementById('modalPlayerName')?.value?.trim() || '';
      const modalSlogan = document.getElementById('modalSlogan')?.value?.trim() || '';
      const modalType = document.getElementById('modalCharacterType')?.value || 'warrior';
      const modalAvatarSrc = document.getElementById('modalAvatarImage')?.src || '';
      
      console.log('üìù ËßíËâ≤Ë≥áÊñô:', { modalName, modalSlogan, modalType, modalAvatarSrc });
      
      if (!modalName) {
        showCustomMessage('‚ö†Ô∏è Ë´ãËº∏ÂÖ•ËßíËâ≤ÂêçÁ®±', 'warning');
        return;
      }
      
      if (!modalSlogan) {
        showCustomMessage('‚ö†Ô∏è Ë´ãËº∏ÂÖ•ËßíËâ≤Ê®ôË™û', 'warning');
        return;
      }
      
      // Ê™¢Êü•ÊòØÂê¶ÁÇ∫È†êË®≠È†≠ÂÉèÔºàÂÖÅË®±‰ΩøÁî®È†êË®≠È†≠ÂÉèÔºå‰ΩÜË¶ÅÊ±ÇËá≥Â∞ëËº∏ÂÖ•ÂêçÁ®±ÂíåÊ®ôË™ûÔºâ
      if (modalAvatarSrc.includes('avatar_TL.png') && !modalName && !modalSlogan) {
        showCustomMessage('‚ö†Ô∏è Ë´ãËá≥Â∞ëËº∏ÂÖ•ËßíËâ≤ÂêçÁ®±ÂíåÊ®ôË™û', 'warning');
        return;
      }
      
      // ÂÑ≤Â≠òËá™Ë®Ç‰ΩøÁî®ËÄÖË≥áÊñô
      const customUserData = {
        name: modalName,
        slogan: modalSlogan,
        characterType: modalType,
        avatarDataUrl: modalAvatarSrc,
        createdAt: new Date().toISOString()
      };
      
      localStorage.setItem('customUserData', JSON.stringify(customUserData));
      console.log('üíæ Ëá™Ë®ÇËßíËâ≤Ë≥áÊñôÂ∑≤ÂÑ≤Â≠ò:', customUserData);
      
      // Êõ¥Êñ∞‰∏ª‰ªãÈù¢ÁöÑËßíËâ≤Ë≥áË®ä
      if (typeof LinkageSystem !== 'undefined' && LinkageSystem.player) {
        LinkageSystem.player.setName(modalName);
      }
      
      const characterImage = document.getElementById('characterImage');
      const characterSlogan = document.getElementById('characterSlogan');
      
      if (characterImage) characterImage.src = modalAvatarSrc;
      if (characterSlogan) characterSlogan.textContent = modalSlogan;
      
      // Êõ¥Êñ∞ËßíËâ≤Â∞çË©±Á≥ªÁµ±
      if (window.CharacterDialogue) {
        window.CharacterDialogue.currentCharacter = modalType;
      }
      
      // ÈóúÈñâÂΩàÁ™ó
      closeCustomModal();
      
      // È°ØÁ§∫ÊàêÂäüË®äÊÅØ
      showCustomMessage('üíæ Ëá™Ë®ÇËßíËâ≤ÂÑ≤Â≠òÊàêÂäüÔºÅ', 'success');
      
      // Êí≠ÊîæÊàêÂäüÈü≥Êïà
      playTypingSound();
      
      console.log('‚úÖ Ëá™Ë®ÇËßíËâ≤ÂÑ≤Â≠òÂÆåÊàê');
    }

    // Ë™ûÈü≥ÊúóËÆÄÊ®ôË™ûÂäüËÉΩÂ∑≤ÁßªÈô§

    // Èü≥ÊïàÊéßÂà∂
    let isSoundEnabled = true;
    const typingSound = document.getElementById('typingSound');

    function toggleAudio() {
      const button = document.querySelector('#audioControls button');
      isSoundEnabled = !isSoundEnabled;
      if (isSoundEnabled) {
        button.textContent = 'üîä';
      } else {
        button.textContent = 'üîá';
      }
    }

    // Êí≠ÊîæÊâìÂ≠óÈü≥Êïà
    function playTypingSound() {
      if (isSoundEnabled) {
        typingSound.currentTime = 0;
        typingSound.play().catch(error => {
          console.log('Èü≥ÊïàÊí≠ÊîæÂ§±Êïó:', error);
        });
      }
    }

    // Ëá™Ë®Ç‰ΩøÁî®ËÄÖÂäüËÉΩ - Â∑≤Êï¥ÂêàÂà∞ÂΩàÁ™óÁ≥ªÁµ±‰∏≠
    // ËàäÁöÑÁç®Á´ãÂáΩÊï∏Â∑≤ÁßªÈô§ÔºåÁèæÂú®Áµ±‰∏Ä‰ΩøÁî®ÂΩàÁ™óÁ≥ªÁµ±

    // È°ØÁ§∫Ëá™Ë®ÇË®äÊÅØ
    function showCustomMessage(message, type = 'info') {
      // ÁßªÈô§ÁèæÊúâÁöÑË®äÊÅØ
      const existingMessage = document.querySelector('.custom-message');
      if (existingMessage) {
        existingMessage.remove();
      }
      
      // ÂâµÂª∫Êñ∞Ë®äÊÅØ
      const messageDiv = document.createElement('div');
      messageDiv.className = `custom-message custom-message-${type}`;
      messageDiv.textContent = message;
      
      // Ê∑ªÂä†Âà∞body
      document.body.appendChild(messageDiv);
      
      // 3ÁßíÂæåËá™ÂãïÁßªÈô§
      setTimeout(() => {
        if (messageDiv.parentNode) {
          messageDiv.remove();
        }
      }, 3000);
    }

    // Á∑äÊÄ•‰øÆÂæ©ÊªæÂãïÂäüËÉΩ
    function emergencyFixScroll() {
      console.log('üö® Âü∑Ë°åÁ∑äÊÄ•ÊªæÂãï‰øÆÂæ©...');
      
      // ÈóúÈñâÊâÄÊúâÂΩàÁ™ó
      const modals = document.querySelectorAll('.modal-overlay');
      modals.forEach(modal => {
        modal.classList.remove('show');
      });
      
      // ÊÅ¢Âæ©ÊâÄÊúâÊªæÂãï
      document.body.style.overflow = 'auto';
      document.documentElement.style.overflow = 'auto';
      
      // ÁßªÈô§ÊâÄÊúâÂèØËÉΩÈòªÊ≠¢ÊªæÂãïÁöÑÊ®£Âºè
      document.body.style.position = '';
      document.body.style.top = '';
      document.body.style.left = '';
      document.body.style.right = '';
      document.body.style.bottom = '';
      
      console.log('‚úÖ Á∑äÊÄ•‰øÆÂæ©ÂÆåÊàê');
      showCustomMessage('üîÑ ÊªæÂãïÂäüËÉΩÂ∑≤‰øÆÂæ©', 'success');
    }



    // Á∑äÊÄ•‰øÆÂæ©ÊòüÊòüÈ°ØÁ§∫
    function emergencyFixStarsDisplay() {
      console.log('üö® Âü∑Ë°åÁ∑äÊÄ•ÊòüÊòüÈ°ØÁ§∫‰øÆÂæ©...');
      
      const starsDisplay = document.getElementById('starsDisplay');
      const totalStarsCount = document.getElementById('totalStarsCount');
      
      if (starsDisplay) {
        // Âº∑Âà∂È°ØÁ§∫ÊòüÊòüÈ°ØÁ§∫
        starsDisplay.style.cssText = `
          position: fixed !important;
          top: 15px !important;
          left: 15px !important;
          background: rgba(10, 20, 40, 0.9) !important;
          padding: 4px 8px !important;
          border-radius: 8px !important;
          color: #ffd700 !important;
          font-weight: bold !important;
          box-shadow: 0 0 8px #ffd700, 0 0 16px #00ffff !important;
          border: 1px solid #00ffff !important;
          font-size: 1rem !important;
          backdrop-filter: blur(5px) !important;
          z-index: 1000 !important;
          display: flex !important;
          align-items: center !important;
          gap: 3px !important;
          width: fit-content !important;
          text-align: center !important;
          transition: all 0.3s ease !important;
        `;
        console.log('‚úÖ ÊòüÊòüÈ°ØÁ§∫Â∑≤Âº∑Âà∂‰øÆÂæ©');
      }
      
      if (totalStarsCount) {
        // Âº∑Âà∂È°ØÁ§∫ÊòüÊòüÊï∏Èáè
        totalStarsCount.style.cssText = `
          font-weight: bold !important;
          color: #ffd700 !important;
          text-shadow: 0 0 10px rgba(255, 215, 0, 0.5) !important;
          font-size: 1rem !important;
        `;
        console.log('‚úÖ ÊòüÊòüÊï∏ÈáèÈ°ØÁ§∫Â∑≤Âº∑Âà∂‰øÆÂæ©');
      }
      
      // ÈáçÊñ∞Êõ¥Êñ∞ÊòüÊòüÈ°ØÁ§∫
      if (typeof updateStarsDisplay === 'function') {
        updateStarsDisplay();
      }
      
      console.log('‚úÖ Á∑äÊÄ•ÊòüÊòüÈ°ØÁ§∫‰øÆÂæ©ÂÆåÊàê');
      showCustomMessage('‚úÖ ÊòüÊòüÈ°ØÁ§∫Â∑≤‰øÆÂæ©', 'success');
    }



    // ÈªûÊìäÂΩàÁ™óÈ†≠ÂÉèÈ†êË¶ΩËß∏ÁôºÊ™îÊ°àÈÅ∏Êìá
    document.addEventListener('DOMContentLoaded', function() {
      const modalAvatarPreview = document.getElementById('modalAvatarPreview');
      if (modalAvatarPreview) {
        modalAvatarPreview.addEventListener('click', function() {
          console.log('üñ±Ô∏è ÈªûÊìäÈ†≠ÂÉèÈ†êË¶ΩÂçÄÂüü');
          const modalAvatarUpload = document.getElementById('modalAvatarUpload');
          if (modalAvatarUpload) {
            modalAvatarUpload.click();
          } else {
            console.error('‚ùå Êâæ‰∏çÂà∞È†≠ÂÉè‰∏äÂÇ≥ÂÖÉÁ¥†');
            showCustomMessage('‚ùå ‰∏äÂÇ≥ÂäüËÉΩËºâÂÖ•Â§±Êïó', 'error');
          }
        });
        console.log('‚úÖ È†≠ÂÉèÈ†êË¶ΩÈªûÊìä‰∫ã‰ª∂Â∑≤Á∂ÅÂÆö');
      } else {
        console.error('‚ùå Êâæ‰∏çÂà∞È†≠ÂÉèÈ†êË¶ΩÂÖÉÁ¥†');
      }
    });

    // ‰ΩøÁî®ËÄÖÂêçÁ®±ËôïÁêÜ
    document.getElementById('playerName').addEventListener('input', function(e) {
      const name = e.target.value.trim();
      if (name) {
        LinkageSystem.player.setName(name);
        playTypingSound();
      }
    });

    // È†ÅÈù¢ËºâÂÖ•ÊôÇËºâÂÖ•Â∑≤ÂÑ≤Â≠òÁöÑË≥áÊñô
    window.addEventListener('load', function() {
      // ËºâÂÖ•‰ΩøÁî®ËÄÖÂêçÁ®±ÂíåÈ†≠ÂÉè
      LinkageSystem.player.updateDisplay();
      
      // Ê™¢Êü•ÊòØÂê¶ÊúâËá™Ë®Ç‰ΩøÁî®ËÄÖË≥áÊñô
      const customUserData = localStorage.getItem('customUserData');
      if (customUserData) {
        try {
          const customData = JSON.parse(customUserData);
          // Â¶ÇÊûúÊúâËá™Ë®ÇË≥áÊñôÔºåÂÑ™ÂÖà‰ΩøÁî®Ëá™Ë®ÇË≥áÊñô
          LinkageSystem.player.setName(customData.name);
          document.getElementById('characterImage').src = customData.avatarDataUrl;
          document.getElementById('characterSlogan').textContent = customData.slogan;
          
          if (window.CharacterDialogue) {
            window.CharacterDialogue.currentCharacter = customData.characterType;
          }
          
          // ÈÅ∏‰∏≠Ëá™Ë®ÇÈ†≠ÂÉèÈÅ∏È†Ö
          const customAvatarOption = document.querySelector('.custom-avatar-option');
          if (customAvatarOption) {
            document.querySelectorAll('.avatar-option').forEach(avatar => {
              avatar.classList.remove('selected');
            });
            customAvatarOption.classList.add('selected');
          }
          
          console.log('‰ΩøÁî®Ëá™Ë®Ç‰ΩøÁî®ËÄÖË≥áÊñô');
          return; // Â¶ÇÊûúÊúâËá™Ë®ÇË≥áÊñôÔºåÂ∞±‰∏çËºâÂÖ•È†êË®≠È†≠ÂÉè
        } catch (e) {
          console.log('Ëá™Ë®Ç‰ΩøÁî®ËÄÖË≥áÊñôËºâÂÖ•Â§±ÊïóÔºå‰ΩøÁî®È†êË®≠Ë®≠ÂÆö:', e);
        }
      }
      
      // ËºâÂÖ•‰øùÂ≠òÁöÑÈ†≠ÂÉèÈÅ∏ÊìáÁãÄÊÖã
      const savedAvatar = localStorage.getItem('selectedAvatar');
      const savedSlogan = localStorage.getItem('selectedSlogan');
      const savedVoiceSettings = localStorage.getItem('selectedVoiceSettings');
      
      if (savedAvatar) {
        // ÊâæÂà∞Â∞çÊáâÁöÑÈ†≠ÂÉèÈÅ∏È†Ö‰∏¶ÈÅ∏‰∏≠
        const avatarOptions = document.querySelectorAll('.avatar-option');
        let foundAvatar = false;
        
        avatarOptions.forEach(option => {
          const backgroundImage = option.style.backgroundImage;
          // ÊèêÂèñËÉåÊôØÂúñÁâá‰∏≠ÁöÑÊ™îÊ°àÂêç
          const urlMatch = backgroundImage.match(/url\(['"]?([^'"]+)['"]?\)/);
          if (urlMatch) {
            const imageUrl = urlMatch[1];
            // ÊØîËºÉÂÆåÊï¥ÁöÑURLË∑ØÂæë
            if (imageUrl === savedAvatar || imageUrl.endsWith(savedAvatar.split('/').pop())) {
              // ÁßªÈô§ÂÖ∂‰ªñÈ†≠ÂÉèÁöÑÈÅ∏‰∏≠ÁãÄÊÖã
              document.querySelectorAll('.avatar-option').forEach(avatar => {
                avatar.classList.remove('selected');
              });
              
              // Ê∑ªÂä†ÈÅ∏‰∏≠ÁãÄÊÖã
              option.classList.add('selected');
              foundAvatar = true;
              
              // ÊÅ¢Âæ©‰øùÂ≠òÁöÑÊ®ôË™û
              if (savedSlogan) {
                document.getElementById('characterSlogan').textContent = savedSlogan;
              }
              
              // Êõ¥Êñ∞ËßíËâ≤È†êË¶ΩÂúñÁâá
              document.getElementById('characterImage').src = savedAvatar;
              
              // ÊÅ¢Âæ©‰øùÂ≠òÁöÑË™ûÈü≥Ë®≠ÂÆö
              if (savedVoiceSettings) {
                try {
                  const voiceSettings = JSON.parse(savedVoiceSettings);
                  // ÂèØ‰ª•ÈÅ∏ÊìáÊòØÂê¶Âú®ËºâÂÖ•ÊôÇÊí≠ÊîæË™ûÈü≥
                  // speakSlogan(savedSlogan, voiceSettings);
                  
                  // Êõ¥Êñ∞ËßíËâ≤Â∞çË©±Á≥ªÁµ±ÁöÑÁï∂ÂâçËßíËâ≤
                  if (window.CharacterDialogue) {
                    window.CharacterDialogue.currentCharacter = voiceSettings.characterType || 'warrior';
                  }
                } catch (e) {
                  console.log('Ë™ûÈü≥Ë®≠ÂÆöÊÅ¢Âæ©Â§±Êïó:', e);
                }
              }
            }
          }
        });
        
        // Â¶ÇÊûúÊ≤íÊúâÊâæÂà∞‰øùÂ≠òÁöÑÈ†≠ÂÉèÔºå‰ΩøÁî®È†êË®≠È†≠ÂÉè
        if (!foundAvatar) {
          console.log('Êú™ÊâæÂà∞‰øùÂ≠òÁöÑÈ†≠ÂÉèÔºå‰ΩøÁî®È†êË®≠È†≠ÂÉè');
          // Ê∏ÖÈô§ÂèØËÉΩÊêçÂ£ûÁöÑ‰øùÂ≠òÊï∏Êìö
          localStorage.removeItem('selectedAvatar');
          localStorage.removeItem('selectedSlogan');
          localStorage.removeItem('selectedVoiceSettings');
        }
      }
      
      // Ê™¢Êü•ÊòØÂê¶ÁÇ∫È¶ñÊ¨°Ë®™ÂïèÔºåÂ¶ÇÊûúÊòØÂâáÈ°ØÁ§∫ËßíËâ≤Â∞çË©±
      const hasShownWelcome = localStorage.getItem('hasShownWelcomeDialogue');
      if (!hasShownWelcome && window.CharacterDialogue) {
        setTimeout(() => {
          window.CharacterDialogue.showWelcomeDialogue();
          localStorage.setItem('hasShownWelcomeDialogue', 'true');
        }, 2000);
      }
    });

    // ËÉåÊôØÈü≥Ê®ÇÊéßÂà∂Á≥ªÁµ±
    let backgroundMusic = null;
    let toggleMusicBtn = null;
    let isMusicPlaying = false;

    // ÂàùÂßãÂåñËÉåÊôØÈü≥Ê®ÇÁ≥ªÁµ±
    function initBackgroundMusic() {
      console.log('üéµ ÂàùÂßãÂåñËÉåÊôØÈü≥Ê®ÇÁ≥ªÁµ±...');
      
      backgroundMusic = document.getElementById('backgroundMusic');
      toggleMusicBtn = document.getElementById('toggleMusic');
      
      if (!backgroundMusic) {
        console.error('‚ùå Êâæ‰∏çÂà∞ËÉåÊôØÈü≥Ê®ÇÂÖÉÁ¥†');
        return;
      }
      
      if (!toggleMusicBtn) {
        console.error('‚ùå Êâæ‰∏çÂà∞Èü≥Ê®ÇÊéßÂà∂ÊåâÈàï');
        return;
      }
      
      // Ë®≠ÂÆöÈü≥Ê®ÇÂ±¨ÊÄß
      backgroundMusic.volume = 0.3;
      backgroundMusic.loop = true;
      
      // È†êËºâÂÖ•Èü≥Ê®ÇÊ™îÊ°à
      backgroundMusic.load();
      
      // ÂÑ™ÂÖà‰ΩøÁî® SoundSystemÔºàÂ¶ÇÊûúÂèØÁî®Ôºâ
      if (typeof SoundSystem !== 'undefined' && SoundSystem.bgm) {
        console.log('üéµ ‰ΩøÁî® SoundSystem ÁÆ°ÁêÜËÉåÊôØÈü≥Ê®Ç');
        // ÂàùÂßãÂåñ SoundSystem ÁöÑËÉåÊôØÈü≥Ê®Ç
        SoundSystem.bgm.initGlobalAudio();
        
        // Âæû SoundSystem Áç≤ÂèñÁãÄÊÖã
        isMusicPlaying = SoundSystem.bgm.getPlayingState();
        console.log('üîó SoundSystem Èü≥Ê®ÇÁãÄÊÖã:', isMusicPlaying);
      }
      // ÂÖ∂Ê¨°‰ΩøÁî® LinkageSystem
      else if (typeof LinkageSystem !== 'undefined' && LinkageSystem.music) {
        isMusicPlaying = LinkageSystem.music.isPlaying();
        console.log('üîó LinkageSystem Èü≥Ê®ÇÁãÄÊÖã:', isMusicPlaying);
      } 
      // ÊúÄÂæå‰ΩøÁî® localStorage
      else {
        const musicState = localStorage.getItem('bgMusicState');
        isMusicPlaying = musicState === 'playing';
        console.log('üì¶ localStorage Èü≥Ê®ÇÁãÄÊÖã:', isMusicPlaying);
      }
      
      // Êõ¥Êñ∞ÊåâÈàïÁãÄÊÖã
      updateMusicButtonState();
      
      // Â¶ÇÊûúÈü≥Ê®ÇÊáâË©≤Êí≠ÊîæÔºåÂòóË©¶Êí≠Êîæ
      if (isMusicPlaying) {
        playBackgroundMusic();
      }
      
      console.log('‚úÖ ËÉåÊôØÈü≥Ê®ÇÁ≥ªÁµ±ÂàùÂßãÂåñÂÆåÊàê');
    }

    // Êí≠ÊîæËÉåÊôØÈü≥Ê®Ç
    function playBackgroundMusic() {
      if (!backgroundMusic) return;
      
      // ÂÑ™ÂÖà‰ΩøÁî® SoundSystem
      if (typeof SoundSystem !== 'undefined' && SoundSystem.bgm) {
        SoundSystem.bgm.play();
        isMusicPlaying = true;
        updateMusicButtonState();
        console.log('üéµ ÈÄèÈÅé SoundSystem Êí≠ÊîæËÉåÊôØÈü≥Ê®Ç');
        return;
      }
      
      // ÂÇôÁî®ÊñπÊ°àÔºöÁõ¥Êé•Êí≠ÊîæÊú¨Âú∞Èü≥Ê®ÇÂÖÉÁ¥†
      backgroundMusic.play().then(() => {
        isMusicPlaying = true;
        updateMusicButtonState();
        
        // ÂêåÊ≠•Âà∞ LinkageSystem
        if (typeof LinkageSystem !== 'undefined' && LinkageSystem.music) {
          LinkageSystem.music.setPlaying(true);
        } else {
          localStorage.setItem('bgMusicState', 'playing');
        }
        
        console.log('üéµ ËÉåÊôØÈü≥Ê®ÇÈñãÂßãÊí≠Êîæ');
      }).catch(err => {
        console.error('‚ùå ËÉåÊôØÈü≥Ê®ÇÊí≠ÊîæÂ§±Êïó:', err);
        isMusicPlaying = false;
        updateMusicButtonState();
      });
    }

    // Êö´ÂÅúËÉåÊôØÈü≥Ê®Ç
    function pauseBackgroundMusic() {
      if (!backgroundMusic) return;
      
      // ÂÑ™ÂÖà‰ΩøÁî® SoundSystem
      if (typeof SoundSystem !== 'undefined' && SoundSystem.bgm) {
        SoundSystem.bgm.pause();
        isMusicPlaying = false;
        updateMusicButtonState();
        console.log('üîá ÈÄèÈÅé SoundSystem Êö´ÂÅúËÉåÊôØÈü≥Ê®Ç');
        return;
      }
      
      // ÂÇôÁî®ÊñπÊ°àÔºöÁõ¥Êé•Êö´ÂÅúÊú¨Âú∞Èü≥Ê®ÇÂÖÉÁ¥†
      backgroundMusic.pause();
      isMusicPlaying = false;
      updateMusicButtonState();
      
      // ÂêåÊ≠•Âà∞ LinkageSystem
      if (typeof LinkageSystem !== 'undefined' && LinkageSystem.music) {
        LinkageSystem.music.setPlaying(false);
      } else {
        localStorage.setItem('bgMusicState', 'paused');
      }
      
      console.log('üîá ËÉåÊôØÈü≥Ê®ÇÂ∑≤Êö´ÂÅú');
    }

    // ÂàáÊèõËÉåÊôØÈü≥Ê®Ç
    function toggleBackgroundMusic() {
      if (isMusicPlaying) {
        pauseBackgroundMusic();
      } else {
        playBackgroundMusic();
      }
    }

    // Êõ¥Êñ∞Èü≥Ê®ÇÊåâÈàïÁãÄÊÖã
    function updateMusicButtonState() {
      if (!toggleMusicBtn) return;
      
      if (isMusicPlaying) {
        toggleMusicBtn.style.background = 'rgba(0, 255, 255, 0.2)';
        toggleMusicBtn.innerHTML = '<span class="material-icons">üîä</span>';
      } else {
        toggleMusicBtn.style.background = 'rgba(10, 20, 40, 0.85)';
        toggleMusicBtn.innerHTML = '<span class="material-icons">üîá</span>';
      }
    }

    // Áõ£ËÅΩÈü≥Ê®ÇÊéßÂà∂ÊåâÈàïÈªûÊìä
    document.addEventListener('DOMContentLoaded', function() {
      // Âª∂ÈÅ≤ÂàùÂßãÂåñÔºåÁ¢∫‰øùÊâÄÊúâÂÖÉÁ¥†ÈÉΩÂ∑≤ËºâÂÖ•
      setTimeout(() => {
        initBackgroundMusic();
        
        // Á∂ÅÂÆöÊåâÈàï‰∫ã‰ª∂
        const musicBtn = document.getElementById('toggleMusic');
        if (musicBtn) {
          musicBtn.addEventListener('click', toggleBackgroundMusic);
          console.log('üéµ Èü≥Ê®ÇÊéßÂà∂ÊåâÈàï‰∫ã‰ª∂Â∑≤Á∂ÅÂÆö');
        }
        
        // Ê∑ªÂä†Áî®Êà∂‰∫íÂãïËß∏ÁôºÈü≥Ê®ÇÊí≠Êîæ
        let hasUserInteracted = false;
        
        function handleUserInteraction() {
          if (!hasUserInteracted) {
            hasUserInteracted = true;
            console.log('üëÜ Áî®Êà∂È¶ñÊ¨°‰∫íÂãïÔºåÂòóË©¶Êí≠ÊîæÈü≥Ê®Ç');
            
            // Â¶ÇÊûúÈü≥Ê®ÇÊáâË©≤Êí≠Êîæ‰ΩÜÈÇÑÊ≤íÈñãÂßãÔºåÁèæÂú®ÂòóË©¶Êí≠Êîæ
            if (isMusicPlaying && backgroundMusic && backgroundMusic.paused) {
              playBackgroundMusic();
            }
            
            // ÁßªÈô§‰∫ã‰ª∂Áõ£ËÅΩÂô®
            document.removeEventListener('click', handleUserInteraction);
            document.removeEventListener('keydown', handleUserInteraction);
            document.removeEventListener('touchstart', handleUserInteraction);
          }
        }
        
        // Áõ£ËÅΩÁî®Êà∂‰∫íÂãï‰∫ã‰ª∂
        document.addEventListener('click', handleUserInteraction);
        document.addEventListener('keydown', handleUserInteraction);
        document.addEventListener('touchstart', handleUserInteraction);
        
      }, 500);
    });

    // Áõ£ËÅΩÈ†ÅÈù¢ÂèØË¶ãÊÄßËÆäÂåñÔºåËôïÁêÜÈü≥Ê®ÇÊö´ÂÅú/ÊÅ¢Âæ©
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        // È†ÅÈù¢Èö±ËóèÊôÇÊö´ÂÅúÈü≥Ê®Ç
        if (isMusicPlaying && backgroundMusic) {
          backgroundMusic.pause();
        }
      } else {
        // È†ÅÈù¢È°ØÁ§∫ÊôÇÊÅ¢Âæ©Èü≥Ê®Ç
        if (isMusicPlaying && backgroundMusic && backgroundMusic.paused) {
          backgroundMusic.play().catch(err => {
            console.log('È†ÅÈù¢ÊÅ¢Âæ©ÊôÇÈü≥Ê®ÇÊí≠ÊîæÂ§±Êïó:', err);
          });
        }
      }
    });



    // ËôïÁêÜÂΩàÁ™óÈ†≠ÂÉè‰∏äÂÇ≥
    document.addEventListener('DOMContentLoaded', function() {
      const modalAvatarUpload = document.getElementById('modalAvatarUpload');
      if (modalAvatarUpload) {
        modalAvatarUpload.addEventListener('change', function(e) {
          console.log('üìÅ ËôïÁêÜÈ†≠ÂÉè‰∏äÂÇ≥...');
          const file = e.target.files[0];
          if (file) {
            console.log('üìÅ ÈÅ∏ÊìáÁöÑÊ™îÊ°à:', file.name, file.size, 'bytes');
            const reader = new FileReader();
            reader.onload = function(event) {
              const modalAvatarImage = document.getElementById('modalAvatarImage');
              if (modalAvatarImage) {
                modalAvatarImage.src = event.target.result;
                console.log('‚úÖ È†≠ÂÉè‰∏äÂÇ≥ÊàêÂäü');
                showCustomMessage('‚úÖ È†≠ÂÉè‰∏äÂÇ≥ÊàêÂäüÔºÅ', 'success');
              } else {
                console.error('‚ùå Êâæ‰∏çÂà∞È†≠ÂÉèÈ†êË¶ΩÂÖÉÁ¥†');
                showCustomMessage('‚ùå È†≠ÂÉèÈ†êË¶ΩËºâÂÖ•Â§±Êïó', 'error');
              }
            };
            reader.onerror = function() {
              console.error('‚ùå Ê™îÊ°àËÆÄÂèñÂ§±Êïó');
              showCustomMessage('‚ùå Ê™îÊ°àËÆÄÂèñÂ§±Êïó', 'error');
            };
            reader.readAsDataURL(file);
          } else {
            console.log('üìÅ Ê≤íÊúâÈÅ∏ÊìáÊ™îÊ°à');
          }
        });
        console.log('‚úÖ È†≠ÂÉè‰∏äÂÇ≥‰∫ã‰ª∂Áõ£ËÅΩÂô®Â∑≤Á∂ÅÂÆö');
      } else {
        console.error('‚ùå Êâæ‰∏çÂà∞È†≠ÂÉè‰∏äÂÇ≥ÂÖÉÁ¥†');
      }
    });

    // ÂÖ¨ÂëäÊ™¢Êü•ÂíåÊï∏Â≠óÊ≥°Ê≥°ÂäüËÉΩ
    const GOOGLE_SHEETS_API = "https://script.google.com/macros/s/AKfycbyfM8pLiWIjRsvg7u3rJ5Zh4XdKLFuScaQ5t_0yQviBp11IwOZSyrgZ-KFHkrJT43UBPg/exec";
    
    // Ê™¢Êü•Êñ∞ÂÖ¨Âëä‰∏¶Êõ¥Êñ∞Êï∏Â≠óÊ≥°Ê≥°
    function checkNewAnnouncements() {
      const badge = document.getElementById('announcementBadge');
      if (!badge) return;

      // Âæû localStorage Áç≤Âèñ‰∏äÊ¨°Ê™¢Êü•ÁöÑÊôÇÈñì
      const lastCheckTime = localStorage.getItem('lastAnnouncementCheck') || '0';
      const currentTime = Date.now();

      // ÂÖàÂòóË©¶Âæû Google Sheets Áç≤ÂèñÊï∏Êìö
      fetch(GOOGLE_SHEETS_API)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          if (data && data.length > 0) {
            updateBadgeWithData(data, lastCheckTime, badge);
          } else {
            throw new Error('No data received');
          }
        })
        .catch(error => {
          console.log('Google Sheets ËºâÂÖ•Â§±ÊïóÔºå‰ΩøÁî®Êú¨Âú∞Êï∏Êìö:', error);
          // ‰ΩøÁî®Êú¨Âú∞ÂÖ¨ÂëäÊï∏ÊìöÈÄ≤Ë°åÊ∏¨Ë©¶
          const localAnnouncements = [
            {
              type: "üî¥",
              content: "Á≥ªÁµ±Á∂≠Ë≠∑‰∏≠ÔºåÈÉ®ÂàÜÂäüËÉΩÂèØËÉΩÊö´ÊôÇÁÑ°Ê≥ï‰ΩøÁî®",
              time: "2024-01-15 10:00"
            },
            {
              type: "üü¢",
              content: "Ê≠°Ëøé‰ΩøÁî®Ëã±ÊâìÂ∞èËã±ÈõÑÔºÅÊñ∞ÂäüËÉΩÈô∏Á∫åÊé®Âá∫‰∏≠",
              time: "2024-01-10 09:30"
            },
            {
              type: "üîµ",
              content: "Â¶ÇÊúâÂïèÈ°åË´ãËÅØÁπ´ÂÆ¢ÊúçÊàñ‰ΩøÁî®Áé©ÂÆ∂‰ø°ÁÆ±ÂäüËÉΩ",
              time: "2024-01-05 14:20"
            },
            {
              type: "üü°",
              content: "Êñ∞Â¢ûÂÆáÂÆôÁßëÊäÄÈ¢®Ê†ºÂÖ¨ÂëäÈ†ÅÈù¢ÔºÅ",
              time: new Date().toISOString().slice(0, 19).replace('T', ' ')
            }
          ];
          
          updateBadgeWithData(localAnnouncements, lastCheckTime, badge);
        });
    }

    // Êõ¥Êñ∞Êï∏Â≠óÊ≥°Ê≥°ÁöÑËºîÂä©ÂáΩÊï∏
    function updateBadgeWithData(announcements, lastCheckTime, badge) {
      let newAnnouncementCount = 0;
      
      // Ê™¢Êü•ÊØèÂÄãÂÖ¨ÂëäÁöÑÊôÇÈñì
      announcements.forEach(announcement => {
        if (announcement.time) {
          const announcementTime = new Date(announcement.time).getTime();
          if (announcementTime > parseInt(lastCheckTime)) {
            newAnnouncementCount++;
          }
        }
      });

      // Êõ¥Êñ∞Êï∏Â≠óÊ≥°Ê≥°
      if (newAnnouncementCount > 0) {
        badge.textContent = newAnnouncementCount > 99 ? '99+' : newAnnouncementCount.toString();
        badge.style.display = 'flex';
        
        // Ê∑ªÂä†ÈñÉÁàçÂãïÁï´
        badge.style.animation = 'badgePulse 1s ease-in-out infinite';
        
        console.log(`üì£ ÁôºÁèæ ${newAnnouncementCount} ÂÄãÊñ∞ÂÖ¨Âëä`);
      } else {
        badge.style.display = 'none';
        console.log('üì£ Ê≤íÊúâÊñ∞ÂÖ¨Âëä');
      }
    }

    // ÈªûÊìäÂÖ¨ÂëäÊåâÈàïÊôÇÊõ¥Êñ∞Ê™¢Êü•ÊôÇÈñì
    function updateAnnouncementCheckTime() {
      localStorage.setItem('lastAnnouncementCheck', Date.now().toString());
      const badge = document.getElementById('announcementBadge');
      if (badge) {
        badge.style.display = 'none';
      }
    }

    // ÂñÆÂ≠ó‰∏ãËºâ‰∏≠ÂøÉÂäüËÉΩ
    function showVocabularyDownload() {
      console.log('üöÄ ÈñãÂïüÂñÆÂ≠ó‰∏ãËºâ‰∏≠ÂøÉ...');
      const modal = document.getElementById('vocabularyDownloadModal');
      if (modal) {
        modal.style.display = 'flex';
        // ÂàùÂßãÂåñ Vue.js ÊáâÁî®
        initVocabularyDownloadApp();
      } else {
        console.error('‚ùå Êâæ‰∏çÂà∞ÂñÆÂ≠ó‰∏ãËºâÊ®°ÊÖãË¶ñÁ™ó');
      }
    }

    function closeVocabularyDownload() {
      console.log('üîí ÈóúÈñâÂñÆÂ≠ó‰∏ãËºâ‰∏≠ÂøÉ...');
      const modal = document.getElementById('vocabularyDownloadModal');
      if (modal) {
        modal.style.display = 'none';
        // Èä∑ÊØÄ Vue.js ÊáâÁî®
        if (window.vocabularyDownloadApp) {
          window.vocabularyDownloadApp.unmount();
          window.vocabularyDownloadApp = null;
        }
      }
    }

    function initVocabularyDownloadApp() {
        console.log('üéØ ÂàùÂßãÂåñ Vue.js ÊáâÁî®...');
        if (window.vocabularyDownloadApp) {
          window.vocabularyDownloadApp.unmount();
        }

        const { createApp } = Vue;

        window.vocabularyDownloadApp = createApp({
          template: `
            <div class="vocabulary-download-container">
              <!-- ÊòüÊòüÈ°ØÁ§∫ÂçÄÂüü -->
              <div class="vocabulary-stars-display">
                <div style="
                  font-size: 1.5rem;
                  font-weight: bold;
                  color: #ffd700;
                  text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  gap: 10px;
                ">
                  <span id="totalStarsCount">‚≠ê 0</span>
                  <span style="font-size: 1rem; color: #b0b0b0;">| ‰ΩøÁî®ÊòüÊòüËß£ÈéñÊ™îÊ°à‰∏ãËºâ</span>
                </div>
              </div>

              <div class="vocabulary-header">
                <h1>üöÄ ÂñÆÂ≠óÊ™îÊ°à‰∏ãËºâ‰∏≠ÂøÉ üåå</h1>
                <p>‚ú® Á≤æÈÅ∏È´òÂìÅË≥™ÂñÆÂ≠óÊ™îÊ°àÔºåÂä©ÊÇ®ÊèêÂçáËã±Ë™ûËÉΩÂäõ ‚ú®</p>
              </div>

              <!-- ÊêúÂ∞ãÂíåÁØ©ÈÅ∏ÂäüËÉΩ -->
              <div class="vocabulary-search-section">
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                  <input 
                    v-model="searchQuery" 
                    type="text" 
                    placeholder="ÊêúÂ∞ãÂñÆÂ≠óÊ™îÊ°à..." 
                    class="vocabulary-search-input"
                  >
                  <select 
                    v-model="selectedLevel" 
                    class="vocabulary-level-select"
                  >
                    <option value="">ÊâÄÊúâÁ≠âÁ¥ö</option>
                    <option value="ÂàùÁ¥ö">ÂàùÁ¥ö</option>
                    <option value="‰∏≠Á¥ö">‰∏≠Á¥ö</option>
                    <option value="‰∏≠È´òÁ¥ö">‰∏≠È´òÁ¥ö</option>
                    <option value="È´òÁ¥ö">È´òÁ¥ö</option>
                  </select>
                  <button 
                    @click="resetFilters" 
                    class="vocabulary-reset-btn"
                  >
                    üîÑ ÈáçÁΩÆÁØ©ÈÅ∏
                  </button>
                </div>
                <div style="margin-top: 15px; color: #00ffff; font-size: 0.9rem;">
                  ‚ú® ÊâæÂà∞ {{ filteredFiles.length }} ÂÄãÊ™îÊ°à
                </div>
              </div>

              <div class="vocabulary-download-grid">
                <div class="vocabulary-download-card" v-for="file in filteredFiles" :key="file.id" @click="selectFile(file)">
                  <div class="vocabulary-card-header">
                    <div class="vocabulary-card-icon" :class="'vocabulary-' + file.iconClass">
                      {{ file.icon }}
                    </div>
                    <div>
                      <div class="vocabulary-card-title">{{ file.title }}</div>
                      <div class="vocabulary-card-subtitle">{{ file.subtitle }}</div>
                    </div>
                  </div>

                  <div class="vocabulary-card-stats">
                    <div class="vocabulary-stat-item">
                      <div class="vocabulary-stat-number">{{ file.wordCount }}</div>
                      <div class="vocabulary-stat-label">ÂñÆÂ≠óÊï∏Èáè</div>
                    </div>
                    <div class="vocabulary-stat-item">
                      <div class="vocabulary-stat-number">{{ file.fileSize }}</div>
                      <div class="vocabulary-stat-label">Ê™îÊ°àÂ§ßÂ∞è</div>
                    </div>
                    <div class="vocabulary-stat-item">
                      <div class="vocabulary-stat-number" style="color: #ffd700;">{{ file.unlockCost || 10 }}</div>
                      <div class="vocabulary-stat-label">Ëß£ÈéñË≤ªÁî®</div>
                    </div>
                  </div>

                  <div class="vocabulary-card-description">
                    {{ file.description }}
                  </div>

                  <button 
                    class="vocabulary-download-btn" 
                    @click.stop="isUnlocked(file.id) ? downloadFile(file) : unlockFile(file)"
                    :disabled="downloading === file.id || (!isUnlocked(file.id) && !canUnlock(file))"
                    :style="getUnlockButtonStyle(file)"
                  >
                    <span v-if="downloading === file.id" class="vocabulary-loading"></span>
                    <span v-else-if="isUnlocked(file.id)">
                      üì• ‰∏ãËºâÊ™îÊ°à
                    </span>
                    <span v-else>
                      üîì Ëß£ÈéñÊ™îÊ°à ({{ file.unlockCost || 10 }} ‚≠ê)
                    </span>
                  </button>
                </div>
              </div>

              <div class="vocabulary-preview-section" v-if="selectedFile">
                <div class="vocabulary-preview-header">
                  <div class="vocabulary-preview-icon">üëÅÔ∏è</div>
                  <div class="vocabulary-preview-title">{{ selectedFile.title }} - Ê™îÊ°àÈ†êË¶Ω</div>
                  <button 
                    @click="selectedFile = null" 
                    style="margin-left: auto; background: none; border: none; color: #667eea; font-size: 1.5rem; cursor: pointer;"
                  >
                    ‚úï
                  </button>
                </div>
                
                <table class="vocabulary-preview-table">
                  <thead>
                    <tr>
                      <th>Ëã±ÊñáÂñÆÂ≠ó</th>
                      <th>‰∏≠ÊñáÁøªË≠Ø</th>
                      <th>Ëã±Êñá‰æãÂè•</th>
                      <th>‰∏≠Êñá‰æãÂè•</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr v-for="word in selectedFile.preview" :key="word.english">
                      <td><strong>{{ word.english }}</strong></td>
                      <td>{{ word.chinese }}</td>
                      <td>{{ word.example_en }}</td>
                      <td>{{ word.example_ch }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <div v-if="message" :class="messageClass">
                {{ message }}
              </div>
            </div>
          `,
          data() {
            return {
              downloading: null,
              message: '',
              messageClass: '',
              selectedFile: null,
              searchQuery: '',
              selectedLevel: '',
              totalStars: 0,
              vocabularyFiles: [
                {
                  id: 'basic400',
                  title: 'üåü ÂÆáÂÆôÂÖ•ÈñÄÂñÆÂ≠óÈõÜ',
                  subtitle: '400ÂÄãÂü∫Á§éËã±ÊñáÂñÆÂ≠ó - Êé¢Á¥¢Ëã±Ë™ûÁöÑËµ∑Èªû',
                  icon: '‚≠ê',
                  iconClass: 'basic-icon',
                  wordCount: '400',
                  fileSize: '26KB',
                  level: 'ÂàùÁ¥ö',
                  unlockCost: 5,
                  description: 'Á≤æÈÅ∏ÊúÄÂü∫Á§éÁöÑ400ÂÄãËã±ÊñáÂñÆÂ≠óÔºåÈÅ©ÂêàËã±Ë™ûÂàùÂ≠∏ËÄÖÔºåÂåÖÂê´Êó•Â∏∏ÁîüÊ¥ªÊúÄÂ∏∏Áî®ÁöÑË©ûÂΩôÂíåÁ∞°ÂñÆ‰æãÂè•„ÄÇ',
                  filename: '400ÂñÆ.csv',
                  preview: [
                    { english: 'I', chinese: 'Êàë', example_en: 'I am a student.', example_ch: 'ÊàëÊòØ‰∏ÄÂêçÂ≠∏Áîü„ÄÇ' },
                    { english: 'you', chinese: '‰Ω†Ôºõ‰Ω†ÂÄë', example_en: 'You are my friend.', example_ch: '‰Ω†ÊòØÊàëÁöÑÊúãÂèã„ÄÇ' },
                    { english: 'he', chinese: '‰ªñ', example_en: 'He has a dog.', example_ch: '‰ªñÊúâ‰∏ÄÈöªÁãó„ÄÇ' },
                    { english: 'she', chinese: 'Â•π', example_en: 'She is my sister.', example_ch: 'Â•πÊòØÊàëÂßêÂßê„ÄÇ' },
                    { english: 'it', chinese: 'Áâ†ÔºõÂÆÉ', example_en: 'It is a cat.', example_ch: 'Áâ†ÊòØ‰∏ÄÈöªË≤ì„ÄÇ' }
                  ]
                },
                {
                  id: 'ielts',
                  title: 'üå† ÊòüÈöõËÄÉË©¶ÂñÆÂ≠óÈõÜ',
                  subtitle: '1000ÂÄãIELTSÂøÖÂÇôÂñÆÂ≠ó - ÂæÅÊúçËã±Ë™ûËÄÉË©¶',
                  icon: 'üå†',
                  iconClass: 'ielts-icon',
                  wordCount: '1000+',
                  fileSize: '75KB',
                  level: '‰∏≠Á¥ö',
                  unlockCost: 15,
                  description: 'Á≤æÈÅ∏ IELTS ËÄÉË©¶‰∏≠ÊúÄÂ∏∏Âá∫ÁèæÁöÑ 1000 ÂÄãÂñÆÂ≠óÔºåÂåÖÂê´Ë©≥Á¥∞ÁöÑ‰∏≠Ëã±ÊñáÁøªË≠ØÂíåÂØ¶Áî®‰æãÂè•ÔºåÂπ´Âä©ÊÇ®Âø´ÈÄüÊèêÂçáË©ûÂΩôÈáè„ÄÇ',
                  filename: '1000Ëã±Ê™¢ÂñÆÂ≠ó.csv',
                  preview: [
                    { english: 'abandon', chinese: 'ÊããÊ£Ñ', example_en: 'He decided to abandon the car on the roadside.', example_ch: '‰ªñÊ±∫ÂÆöÊääËªäÂ≠êÊããÊ£ÑÂú®Ë∑ØÈÇä„ÄÇ' },
                    { english: 'ability', chinese: 'ËÉΩÂäõ', example_en: 'She has the ability to solve complex problems.', example_ch: 'Â•πÊúâËÉΩÂäõËß£Ê±∫Ë§áÈõúÁöÑÂïèÈ°å„ÄÇ' },
                    { english: 'accept', chinese: 'Êé•Âèó', example_en: 'He accepted the job offer.', example_ch: '‰ªñÊé•Âèó‰∫ÜÈÇ£‰ªΩÂ∑•‰ΩúÊ©üÊúÉ„ÄÇ' },
                    { english: 'active', chinese: 'Ê¥ªË∫çÁöÑ', example_en: 'He is very active in school activities.', example_ch: '‰ªñÂú®Â≠∏Ê†°Ê¥ªÂãï‰∏≠ÈùûÂ∏∏Ê¥ªË∫ç„ÄÇ' },
                    { english: 'advice', chinese: 'Âª∫Ë≠∞', example_en: 'She gave me good advice.', example_ch: 'Â•πÁµ¶‰∫ÜÊàëÂ•ΩÁöÑÂª∫Ë≠∞„ÄÇ' }
                  ]
                },
                {
                  id: 'daily',
                  title: 'üè† Âú∞ÁêÉÁîüÊ¥ªÂñÆÂ≠óÈõÜ',
                  subtitle: '150ÂÄãÊó•Â∏∏ÁîüÊ¥ªÂñÆÂ≠ó - Âú∞ÁêÉ‰∫∫ÁöÑÊó•Â∏∏',
                  icon: 'üè†',
                  iconClass: 'daily-icon',
                  wordCount: '150+',
                  fileSize: '15KB',
                  level: 'ÂàùÁ¥ö',
                  unlockCost: 8,
                  description: 'Á≤æÈÅ∏Êó•Â∏∏ÁîüÊ¥ª‰∏≠ÊúÄÂ∏∏Áî®ÁöÑËã±ÊñáÂñÆÂ≠óÔºåÂåÖÂê´È£üÁâ©„ÄÅÂÆ∂Â∫≠„ÄÅÂ∑•‰Ωú„ÄÅÂ§©Ê∞£Á≠âÂØ¶Áî®Ë©ûÂΩôÔºåÈÅ©ÂêàÊó•Â∏∏‰∫§ÊµÅ‰ΩøÁî®„ÄÇ',
                  filename: 'Âü∫Á§éÁîüÊ¥ªÂñÆÂ≠ó.csv',
                  preview: [
                    { english: 'breakfast', chinese: 'Êó©È§ê', example_en: 'I eat breakfast at 7 AM every morning.', example_ch: 'ÊàëÊØèÂ§©Êó©‰∏ä7ÈªûÂêÉÊó©È§ê„ÄÇ' },
                    { english: 'lunch', chinese: 'ÂçàÈ§ê', example_en: 'Let\'s have lunch together today.', example_ch: '‰ªäÂ§©ÊàëÂÄë‰∏ÄËµ∑ÂêÉÂçàÈ§êÂêß„ÄÇ' },
                    { english: 'dinner', chinese: 'ÊôöÈ§ê', example_en: 'We usually have dinner at 6 PM.', example_ch: 'ÊàëÂÄëÈÄöÂ∏∏Êôö‰∏ä6ÈªûÂêÉÊôöÈ§ê„ÄÇ' },
                    { english: 'coffee', chinese: 'ÂíñÂï°', example_en: 'I drink coffee every morning.', example_ch: 'ÊàëÊØèÂ§©Êó©‰∏äÈÉΩÂñùÂíñÂï°„ÄÇ' },
                    { english: 'water', chinese: 'Ê∞¥', example_en: 'Please drink more water.', example_ch: 'Ë´ãÂ§öÂñùÊ∞¥„ÄÇ' }
                  ]
                }
              ]
            }
          },
          methods: {
            getStars() {
              return parseInt(localStorage.getItem('totalStars') || '0');
            },
            
            updateStarsDisplay() {
              const starsCount = document.getElementById('totalStarsCount');
              if (starsCount) {
                starsCount.textContent = `‚≠ê ${this.totalStars}`;
              }
            },

            unlockFile(file) {
              if (this.isUnlocked(file.id)) {
                this.message = `‚úÖ ${file.title} Â∑≤Á∂ìËß£ÈéñÔºåÂèØ‰ª•Áõ¥Êé•‰∏ãËºâÔºÅ`;
                return;
              }
              
              const unlockCost = file.unlockCost || 10;
              const currentStars = this.getStars();
              
              if (currentStars < unlockCost) {
                this.message = `‚ùå ÊòüÊòü‰∏çË∂≥ÔºÅÈúÄË¶Å ${unlockCost} È°ÜÊòüÊòüÔºåÁï∂ÂâçÂè™Êúâ ${currentStars} È°ÜÊòüÊòü`;
                this.messageClass = 'vocabulary-error-message';
                setTimeout(() => {
                  this.message = '';
                }, 3000);
                return;
              }
              
              const newStars = currentStars - unlockCost;
              localStorage.setItem('totalStars', newStars);
              this.totalStars = newStars;
              this.updateStarsDisplay();
              
              let unlockedFiles = JSON.parse(localStorage.getItem('unlockedFiles') || '[]');
              if (!unlockedFiles.includes(file.id)) {
                unlockedFiles.push(file.id);
                localStorage.setItem('unlockedFiles', JSON.stringify(unlockedFiles));
              }
              
              this.message = `üîì ${file.title} Ëß£ÈéñÊàêÂäüÔºÅÊâ£Èô§ ${unlockCost} È°ÜÊòüÊòü`;
              this.messageClass = 'vocabulary-success-message';
              
              setTimeout(() => {
                this.message = '';
              }, 3000);
            },
            
            downloadFile(file) {
              if (!this.isUnlocked(file.id)) {
                this.message = `‚ùå Ë´ãÂÖàËß£ÈéñÊ™îÊ°àÊâçËÉΩ‰∏ãËºâÔºÅ`;
                this.messageClass = 'vocabulary-error-message';
                setTimeout(() => {
                  this.message = '';
                }, 3000);
                return;
              }
              
              this.downloading = file.id;
              this.message = '';
              
              // Ê®°Êì¨‰∏ãËºâÊàêÂäü
              setTimeout(() => {
                this.message = `‚úÖ ${file.title} ‰∏ãËºâÊàêÂäüÔºÅ`;
                this.messageClass = 'vocabulary-success-message';
                this.selectedFile = file;
                this.downloading = null;
                
                setTimeout(() => {
                  this.message = '';
                }, 3000);
              }, 1000);
            },
            
            canUnlock(file) {
              const unlockCost = file.unlockCost || 10;
              return this.getStars() >= unlockCost;
            },
            
            isUnlocked(fileId) {
              const unlockedFiles = JSON.parse(localStorage.getItem('unlockedFiles') || '[]');
              return unlockedFiles.includes(fileId);
            },
            
            selectFile(file) {
              this.selectedFile = file;
            },
            
            resetFilters() {
              this.searchQuery = '';
              this.selectedLevel = '';
              this.selectedFile = null;
            },

            getUnlockButtonStyle(file) {
              if (this.isUnlocked(file.id)) {
                return {
                  background: 'linear-gradient(135deg, #00ffff, #ff00ff)',
                  color: '#ffffff',
                  boxShadow: '0 0 20px rgba(0,255,255,0.3)'
                };
              } else if (this.canUnlock(file)) {
                return {
                  background: 'linear-gradient(135deg, #ffd700, #ffaa00)',
                  color: '#000000',
                  boxShadow: '0 0 20px rgba(255,215,0,0.3)'
                };
              } else {
                return {
                  background: 'linear-gradient(135deg, #666666, #444444)',
                  color: '#cccccc',
                  boxShadow: 'none',
                  cursor: 'not-allowed'
                };
              }
            }
          },
          computed: {
            filteredFiles() {
              let files = this.vocabularyFiles;

              if (this.searchQuery) {
                const query = this.searchQuery.toLowerCase();
                files = files.filter(file => 
                  file.title.toLowerCase().includes(query) ||
                  file.subtitle.toLowerCase().includes(query) ||
                  file.description.toLowerCase().includes(query)
                );
              }

              if (this.selectedLevel) {
                files = files.filter(file => file.level === this.selectedLevel);
              }

              return files;
            }
          },
          mounted() {
            this.totalStars = this.getStars();
            this.updateStarsDisplay();
            this.selectedFile = this.vocabularyFiles[0];
            console.log('üåü ÂñÆÂ≠ó‰∏ãËºâ‰∏≠ÂøÉÂ∑≤ÂàùÂßãÂåñÔºåÁï∂ÂâçÊòüÊòü:', this.totalStars);
          }
        }).mount('#vocabularyDownloadApp');
      }

      // ÈªûÊìäÂñÆÂ≠ó‰∏ãËºâÊ®°ÊÖãË¶ñÁ™óÂ§ñÈÉ®ÈóúÈñâ
      document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('vocabularyDownloadModal');
        if (modal) {
          modal.addEventListener('click', function(e) {
            if (e.target === modal) {
              closeVocabularyDownload();
            }
          });
        }
      });

    // ËºâÂÖ•È¶ñÈ†ÅÂÖ¨ÂëäÂäüËÉΩ
    function loadHomeAnnouncements() {
      const GOOGLE_SHEETS_API = "https://script.google.com/macros/s/AKfycbyfM8pLiWIjRsvg7u3rJ5Zh4XdKLFuScaQ5t_0yQviBp11IwOZSyrgZ-KFHkrJT43UBPg/exec";
      
      // Êú¨Âú∞ÂÇôÁî®ÂÖ¨ÂëäÊï∏Êìö
      const fallbackAnnouncements = [
        {
          type: "üî¥",
          content: "Á≥ªÁµ±Á∂≠Ë≠∑‰∏≠ÔºåÈÉ®ÂàÜÂäüËÉΩÂèØËÉΩÊö´ÊôÇÁÑ°Ê≥ï‰ΩøÁî®",
          time: "2024-01-15 10:00"
        },
        {
          type: "üü¢",
          content: "Ê≠°Ëøé‰ΩøÁî®Ëã±ÊâìÂ∞èËã±ÈõÑÔºÅÊñ∞ÂäüËÉΩÈô∏Á∫åÊé®Âá∫‰∏≠",
          time: "2024-01-10 09:30"
        },
        {
          type: "üîµ",
          content: "Â¶ÇÊúâÂïèÈ°åË´ãËÅØÁπ´ÂÆ¢ÊúçÊàñ‰ΩøÁî®Áé©ÂÆ∂‰ø°ÁÆ±ÂäüËÉΩ",
          time: "2024-01-05 14:20"
        },
        {
          type: "üü°",
          content: "Êñ∞Â¢ûÂÆáÂÆôÁßëÊäÄÈ¢®Ê†ºÂÖ¨ÂëäÈ†ÅÈù¢ÔºÅ",
          time: new Date().toISOString().slice(0, 19).replace('T', ' ')
        }
      ];

      const contentDiv = document.getElementById('announcementsContent');
      const homeAnnouncements = document.getElementById('homeAnnouncements');
      
      if (!contentDiv) {
        console.error('Êâæ‰∏çÂà∞ÂÖ¨ÂëäÂÖßÂÆπÂÖÉÁ¥†');
        return;
      }
      
      if (!homeAnnouncements) {
        console.error('Êâæ‰∏çÂà∞ÂÖ¨ÂëäÂçÄÂüüÂÖÉÁ¥†');
        return;
      }
      
      // Á¢∫‰øùÂÖ¨ÂëäÂçÄÂüüÂèØË¶ã
      homeAnnouncements.style.display = 'block';
      homeAnnouncements.style.visibility = 'visible';
      homeAnnouncements.style.opacity = '1';
      
      console.log('ÈñãÂßãËºâÂÖ•È¶ñÈ†ÅÂÖ¨Âëä...');
      
      // Âæû Google Sheets ËºâÂÖ•
      fetch(GOOGLE_SHEETS_API)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          console.log('È¶ñÈ†ÅÂÖ¨ÂëäËºâÂÖ•ÊàêÂäü:', data);
          if (data && data.length > 0) {
            displayHomeAnnouncements(data.slice(0, 3)); // Âè™È°ØÁ§∫ÊúÄÊñ∞ÁöÑ3Ê¢ùÂÖ¨Âëä
          } else {
            throw new Error('No data received');
          }
        })
        .catch(error => {
          console.log('È¶ñÈ†ÅÂÖ¨ÂëäËºâÂÖ•Â§±ÊïóÔºå‰ΩøÁî®Êú¨Âú∞Êï∏Êìö:', error);
          displayHomeAnnouncements(fallbackAnnouncements.slice(0, 3));
        });
    }

    function displayHomeAnnouncements(announcements) {
      const contentDiv = document.getElementById('announcementsContent');
      const homeAnnouncements = document.getElementById('homeAnnouncements');
      
      if (!contentDiv) {
        console.error('Êâæ‰∏çÂà∞ÂÖ¨ÂëäÂÖßÂÆπÂÖÉÁ¥†');
        return;
      }
      
      if (!homeAnnouncements) {
        console.error('Êâæ‰∏çÂà∞ÂÖ¨ÂëäÂçÄÂüüÂÖÉÁ¥†');
        return;
      }
      
      // Á¢∫‰øùÂÖ¨ÂëäÂçÄÂüüÂèØË¶ã
      homeAnnouncements.style.display = 'block';
      homeAnnouncements.style.visibility = 'visible';
      homeAnnouncements.style.opacity = '1';
      
      if (!announcements || announcements.length === 0) {
        contentDiv.innerHTML = '<div class="no-announcements">ÁõÆÂâçÊ≤íÊúâÂÖ¨Âëä</div>';
        return;
      }

      console.log('È°ØÁ§∫ÂÖ¨Âëä:', announcements);

      const announcementsHTML = announcements.map(announcement => {
        let className = 'announcement-item';
        if (announcement.type === 'üî¥') className += ' urgent';
        else if (announcement.type === 'üü¢') className += ' info';
        else if (announcement.type === 'üîµ') className += ' update';
        else if (announcement.type === 'üü°') className += ' update';

        return `
          <div class="${className}">
            <div class="announcement-content">
              <span class="announcement-type">${announcement.type}</span>
              ${announcement.content}
            </div>
            <div class="announcement-time">üïí ${announcement.time}</div>
          </div>
        `;
      }).join('');

      contentDiv.innerHTML = announcementsHTML;
      console.log('ÂÖ¨ÂëäÈ°ØÁ§∫ÂÆåÊàê');
      
      // Âº∑Âà∂ÈáçÊñ∞Ê∏≤Êüì
      homeAnnouncements.offsetHeight;
    }



    // È†ÅÈù¢ËºâÂÖ•ÊôÇËá™ÂãïÊ™¢Êü•ÊØèÊó•Á∞ΩÂà∞ÁçéÂãµ
    document.addEventListener('DOMContentLoaded', function() {
      console.log('üìÑ È†ÅÈù¢ËºâÂÖ•ÂÆåÊàêÔºåÊ™¢Êü•ÊªæÂãïÁãÄÊÖã...');
      
      // Á¢∫‰øùÊªæÂãïÂäüËÉΩÊ≠£Â∏∏
      document.body.style.overflow = 'auto';
      document.documentElement.style.overflow = 'auto';
      
      // Á¢∫‰øùÊòüÊòüÈ°ØÁ§∫ÂèØË¶ã
      const starsDisplay = document.getElementById('starsDisplay');
      if (starsDisplay) {
                     starsDisplay.style.cssText = `
               position: fixed !important;
               top: 15px !important;
               left: 15px !important;
               background: rgba(10, 20, 40, 0.8) !important;
               padding: 4px 8px !important;
               border-radius: 8px !important;
               color: #ffd700 !important;
               font-weight: bold !important;
               box-shadow: 0 0 8px #ffd700, 0 0 16px #00ffff !important;
               border: 1px solid #00ffff !important;
               font-size: 1rem !important;
               backdrop-filter: blur(5px) !important;
               z-index: 1000 !important;
               display: flex !important;
               align-items: center !important;
               gap: 3px !important;
               width: fit-content !important;
               text-align: center !important;
               transition: all 0.3s ease !important;
             `;
        console.log('‚úÖ ÊòüÊòüÈ°ØÁ§∫Â∑≤Á¢∫‰øùÂèØË¶ã');
      }
      
      // Á¢∫‰øùÂÖ¨ÂëäÂçÄÂüüÂèØË¶ã
      const homeAnnouncements = document.getElementById('homeAnnouncements');
      if (homeAnnouncements) {
        homeAnnouncements.style.display = 'block';
        homeAnnouncements.style.visibility = 'visible';
        homeAnnouncements.style.opacity = '1';
        homeAnnouncements.style.position = 'relative';
        homeAnnouncements.style.zIndex = '1000';
        console.log('‚úÖ ÂÖ¨ÂëäÂçÄÂüüÂ∑≤Á¢∫‰øùÂèØË¶ã');
      }
      
      // Âª∂ÈÅ≤‰∏ÄÈªûÊôÇÈñìÁ¢∫‰øùÊâÄÊúâÁ≥ªÁµ±ÈÉΩÂ∑≤ËºâÂÖ•
      setTimeout(() => {
        checkDailyReward();
        // Á¢∫‰øùcards.jsËºâÂÖ•ÂÆåÊàêÂæåÂÜçÊ™¢Êü•ÊàêÂ∞±
        if (window.allCards) {
          updateAchievementBadge();
        } else {
          // Â¶ÇÊûúcards.jsÈÇÑÊ≤íËºâÂÖ•ÔºåÂÜçÁ≠â‰∏Ä‰∏ã
          setTimeout(updateAchievementBadge, 2000);
        }
        
        // ËºâÂÖ•È¶ñÈ†ÅÂÖ¨Âëä
        console.log('üîÑ Ê∫ñÂÇôËºâÂÖ•È¶ñÈ†ÅÂÖ¨Âëä...');
        loadHomeAnnouncements();
        
        // ÂÜçÊ¨°Á¢∫‰øùÂÖ¨ÂëäÂçÄÂüüÂèØË¶ã
        setTimeout(() => {
          if (homeAnnouncements) {
            homeAnnouncements.style.cssText = `
              display: block !important;
              visibility: visible !important;
              opacity: 1 !important;
              position: relative !important;
              z-index: 1000 !important;
              margin: 20px 0 !important;
              background: rgba(10, 20, 40, 0.8) !important;
              border-radius: 15px !important;
              border: 2px solid rgba(0, 255, 255, 0.5) !important;
              box-shadow: 0 0 20px rgba(0, 255, 255, 0.3) !important;
            `;
            console.log('‚úÖ ÂÖ¨ÂëäÂçÄÂüüÂ∑≤Âº∑Âà∂È°ØÁ§∫');
          }
        }, 2000);
      }, 1000);
