<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>è‹±æ‰“å°è‹±é›„ - æ‰“å­—éŸ³æ•ˆç‰ˆ</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--c:#00ffff;--m:#a259ff;--g:#ffd700}
body{margin:0;font-family:'Orbitron',sans-serif;color:#fff;background:linear-gradient(#020111,#000010)}
#wrap{max-width:520px;margin:40px auto;padding:20px;background:rgba(10,20,40,.7);border:2px solid var(--c);border-radius:16px;box-shadow:0 0 30px #0ff4;text-align:center}
h1{color:var(--c);text-shadow:0 0 12px #0ff,0 0 32px #a259ff}
#word{font-size:2.2rem;color:#ffd700;text-shadow:0 0 10px #ffd700;margin:20px 0}
#ipt{font-family:'Roboto Mono';font-size:1.2rem;width:85%;padding:14px;border-radius:14px;border:3px solid #00ffff;background:rgba(10,20,40,.9);color:#fff;text-align:center;outline:none}
#ipt:focus{border-color:#ffd700;box-shadow:0 0 20px #ffd70080}
#fb{height:28px;margin:10px 0;color:#ffd700;font-weight:700}
.row{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;margin-top:10px}
button{font-family:'Orbitron';font-weight:700;border:none;border-radius:10px;padding:10px 18px;cursor:pointer;color:#000;box-shadow:0 0 14px #0ff;background:linear-gradient(90deg,#00ffff,#a259ff);transition:.15s}
button:hover{transform:scale(1.07)}
#skipBtn{background:linear-gradient(90deg,#ff8a00,#ff3c3c);color:#fff;text-shadow:0 0 5px #fff;box-shadow:0 0 16px rgba(255,60,60,.6)}
#spk{background:linear-gradient(90deg,#ffd700,#ffaa00)}
#hint{background:linear-gradient(90deg,#a259ff,#ff6b6b);color:#fff}
</style>
</head>
<body>
<div id="wrap">
  <h1>â­ è‡ªè¨‚é—œå¡ï¼š<span id="bookName">è‹±æª¢å–®å­—</span></h1>
  <div id="word">æº–å‚™ä¸­...</div>
  <input id="ipt" placeholder="è«‹è¼¸å…¥è‹±æ–‡..." autocomplete="off">
  <div id="fb"></div>
  <div class="row">
    <button onclick="checkAns()">âœ… é€å‡º</button>
    <button id="skipBtn" onclick="skipWord()">â­ï¸ è·³é</button>
    <button id="spk" onclick="speakCur()">ğŸ”ˆ ç™¼éŸ³</button>
    <button id="hint" onclick="showHint()">ğŸ’¡ æç¤º</button>
    <button onclick="restart()">ğŸ” é‡ç©</button>
  </div>
</div>

<audio id="typeSound" src="sound/type.mp3" preload="auto"></audio>

<script>
const ipt=document.getElementById('ipt');
const fb=document.getElementById('fb');
const word=document.getElementById('word');
const typeSound=document.getElementById('typeSound');
let words=[{zh:'èœ‚èœœï¼›è¦ªæ„›çš„',word:'honey'},{zh:'æ˜‚è²´çš„',word:'expensive'},{zh:'çƒé¾œ',word:'turtle'}];
let curIndex=0;
let order=[];
let orderPos=0;
let lastWordKey='';

function playType(){typeSound.currentTime=0;typeSound.play().catch(()=>{})}
function speakCur(){if('speechSynthesis'in window){const u=new SpeechSynthesisUtterance(words[curIndex].word);u.lang='en-US';speechSynthesis.speak(u)}}

function shuffleInPlace(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

function rebuildOrder(){
  order=shuffleInPlace(Array.from({length:words.length},(_,i)=>i));
  // é¿å…ã€Œæ–°ä¸€è¼ªç¬¬ä¸€é¡Œã€é¦¬ä¸Šç­‰æ–¼ä¸Šä¸€è¼ªæœ€å¾Œä¸€é¡Œ
  if(words.length>1 && lastWordKey && words[order[0]] && words[order[0]].word===lastWordKey){
    [order[0],order[1]]=[order[1],order[0]];
  }
  orderPos=0;
}

function next(){
  if(!Array.isArray(words) || words.length===0){
    word.textContent='é¡Œåº«ç‚ºç©º';
    return;
  }
  if(order.length!==words.length || orderPos>=order.length){
    rebuildOrder();
  }
  curIndex=order[orderPos++];
  lastWordKey=words[curIndex]?.word||'';
  word.textContent=words[curIndex].zh;
  ipt.value='';
  fb.textContent='';
  speakCur();
}
function checkAns(){playType();if(ipt.value.trim().toLowerCase()===words[curIndex].word.toLowerCase()){fb.textContent='âœ… æ­£ç¢ºï¼';setTimeout(next,800)}else{fb.textContent='âŒ æ­£è§£ï¼š'+words[curIndex].word;setTimeout(next,1000)}}
function skipWord(){playType();fb.textContent='â­ï¸ å·²è·³éï¼š'+words[curIndex].zh+'ï¼ˆ'+words[curIndex].word+'ï¼‰';setTimeout(next,1000)}
function showHint(){fb.textContent='ğŸ’¡ æç¤ºï¼š'+words[curIndex].word[0].toUpperCase()+'...';playType()}
function restart(){curIndex=-1;next();playType()}

ipt.addEventListener('input',()=>playType());
ipt.addEventListener('keydown',e=>{if(e.key==='Enter')checkAns()});
next();
</script>
</body>
</html>
