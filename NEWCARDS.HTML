<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>新卡亮相區｜卡池資訊總攬</title>
  <link rel="stylesheet" href="card-style.css">
  <link rel="stylesheet" href="responsive.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      min-height: 100vh;
      background: radial-gradient(ellipse at 60% 20%, #1a2a4f 60%, #0a0f1c 100%) fixed, #0a0f1c;
      position: relative;
      overflow-x: hidden;
    }
    body::before {
      content: '';
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 0;
      background: url('data:image/svg+xml;utf8,<svg width="100%25" height="100%25" xmlns="http://www.w3.org/2000/svg"><circle cx="10%25" cy="20%25" r="1.5" fill="white" opacity="0.7"/><circle cx="80%25" cy="30%25" r="1.2" fill="white" opacity="0.5"/><circle cx="50%25" cy="80%25" r="1.8" fill="white" opacity="0.6"/><circle cx="70%25" cy="60%25" r="1.1" fill="white" opacity="0.4"/><circle cx="30%25" cy="70%25" r="1.3" fill="white" opacity="0.5"/><circle cx="90%25" cy="90%25" r="1.7" fill="white" opacity="0.4"/></svg>');
      background-repeat: repeat;
      background-size: cover;
      opacity: 0.7;
    }
    .container {
      position: relative;
      z-index: 1;
      background: rgba(10,20,40,0.72);
      border-radius: 18px;
      box-shadow: 0 0 48px #00ffff33, 0 0 128px #a259ff22;
      padding: 32px 12px 32px 12px;
      margin-top: 32px;
      margin-bottom: 32px;
    }
    .title {
      font-family: 'Orbitron', 'Noto Sans TC', sans-serif;
      font-size: 2.3rem;
      color: #fff;
      text-align: center;
      letter-spacing: 2px;
      text-shadow: 0 0 24px #00ffff, 0 0 48px #a259ff, 0 0 8px #fff;
      position: relative;
      margin-bottom: 18px;
    }
    .title::after {
      content: '';
      display: block;
      margin: 16px auto 0 auto;
      width: 120px;
      height: 3px;
      border-radius: 2px;
      background: linear-gradient(90deg,#00ffff 0%,#a259ff 50%,#ffd700 100%);
      box-shadow: 0 0 16px #00ffff99;
    }
    .section-title {
      font-size: 1.35rem;
      margin: 38px 0 16px 0;
      color: #fff;
      text-shadow: 0 0 12px #00ffff, 0 0 24px #a259ff, 0 0 4px #fff;
      letter-spacing: 1.5px;
      border-left: 5px solid #00ffff;
      padding-left: 16px;
      position: relative;
      background: linear-gradient(90deg,rgba(0,255,255,0.10),rgba(162,89,255,0.10));
      border-radius: 8px;
      box-shadow: 0 0 8px #00ffff22;
    }
    .section-title::before {
      content: '';
      position: absolute;
      left: -18px; top: 50%;
      width: 12px; height: 12px;
      background: radial-gradient(circle,#ffd700 60%,#00ffff 100%);
      border-radius: 50%;
      transform: translateY(-50%);
      box-shadow: 0 0 12px #ffd70099;
    }
    .category-badge { background: linear-gradient(90deg,#ffd700,#a259ff); color:#222; border-radius: 8px; padding: 2px 10px; font-weight: bold; margin-left: 8px; font-size: 1rem; box-shadow:0 0 8px #ffd70099; }
    .category-badge.new { background: linear-gradient(90deg,#ff8a00,#ffd700); color:#fff; box-shadow:0 0 12px #ff8a00cc; }
    .carousel { display: flex; gap: 24px; justify-content: center; align-items: center; margin: 16px 0; }
    .carousel .card {
      width: 240px; height: 360px;
    }
    .theme-demo { display: flex; gap: 24px; margin: 16px 0; }
    .theme-card { border-radius: 12px; padding: 18px 24px; min-width: 180px; min-height: 120px; display: flex; flex-direction: column; align-items: flex-start; box-shadow: 0 0 32px #00ffff55, 0 0 32px #a259ff33; border: 2px solid #00ffff; background: linear-gradient(135deg,#0ff,#222 80%); }
    .theme-orbitron { font-family: 'Orbitron', sans-serif; background: linear-gradient(135deg,#0ff,#222 80%); color: #fff; }
    .theme-cyber { font-family: 'Share Tech Mono', monospace; background: linear-gradient(135deg,#222,#a259ff 80%); color: #ffd700; }
    .theme-neon { font-family: 'Noto Sans TC', sans-serif; background: linear-gradient(135deg,#222,#ff00cc 80%); color: #00ffff; }
    .json-box { background: rgba(20,30,60,0.95); color: #0ff; border-radius: 8px; padding: 16px; font-size: 0.95rem; overflow-x: auto; margin-bottom: 12px; box-shadow:0 0 12px #00ffff44; border:1.5px solid #00ffff55; }
    .lang-status { display: flex; gap: 18px; align-items: center; margin: 12px 0; }
    .lang-status span { font-size: 1.1rem; font-weight: bold; text-shadow:0 0 8px #00ffff99; }
    .lang-on { color: #00ff99; }
    .lang-off { color: #aaa; text-decoration: line-through; }
    .download-btn { background: linear-gradient(90deg,#00ffff,#a259ff); color: #222; border: none; border-radius: 8px; padding: 8px 18px; font-size: 1rem; font-weight: bold; cursor: pointer; margin-top: 8px; box-shadow: 0 0 8px #00ffff99,0 0 16px #a259ff99; transition: background 0.2s; }
    .download-btn:hover { background: linear-gradient(90deg,#ffd700,#ff00cc); color: #000; }
    /* 卡片科技宇宙強化 */
    .card {
      border-radius: 16px;
      box-shadow: 0 0 24px #00ffff55, 0 0 48px #a259ff33, 0 0 64px #222a;
      border: 2.5px solid #00ffff;
      background: linear-gradient(135deg,rgba(10,20,40,0.95) 70%,rgba(0,255,255,0.08) 100%);
      transition: transform 0.3s, box-shadow 0.3s, border-color 0.3s;
      position: relative;
      overflow: hidden;
      width: 240px;
      height: 360px;
    }
    .card:hover {
      transform: translateY(-10px) scale(1.07) rotate(-2deg);
      box-shadow: 0 15px 48px #00ffffcc, 0 0 64px #a259ffcc, 0 0 128px #ffd70055;
      border-color: #ffd700;
      z-index: 2;
    }
    .card .rank-badge {
      background: linear-gradient(90deg,#ffd700 0%,#a259ff 100%);
      color: #000;
      box-shadow: 0 0 8px #ffd700, 0 0 16px #a259ff;
      border: 2px solid #00ffff;
      font-size: 1.1rem;
      top: 8px;
      right: 8px;
    }
    .card.epic .rank-badge {
      background: linear-gradient(90deg,#ffd700,#ff00cc);
      color: #fff;
      border: 2px solid #ffd700;
    }
    .card.rare .rank-badge {
      background: linear-gradient(90deg,#a259ff,#00ffff);
      color: #fff;
      border: 2px solid #a259ff;
    }
    .card.common .rank-badge {
      background: linear-gradient(90deg,#00ffff,#222);
      color: #fff;
      border: 2px solid #00ffff;
    }
    .card .media-container {
      background: linear-gradient(135deg,#222 60%,#00ffff22 100%);
      border-radius: 10px;
      box-shadow: 0 0 12px #00ffff44;
      width: 100%;
      height: 54%;
    }
    .card-desc {
      background: rgba(0,0,0,0.22);
      border: 1px solid #00ffff33;
      box-shadow: 0 0 8px #00ffff33;
    }
    /* 星星裝飾 */
    .star-deco {
      position: absolute;
      pointer-events: none;
      z-index: 10;
      width: 32px; height: 32px;
      background: url('data:image/svg+xml;utf8,<svg width="32" height="32" xmlns="http://www.w3.org/2000/svg"><circle cx="16" cy="16" r="8" fill="white" opacity="0.18"/><circle cx="16" cy="16" r="3" fill="#ffd700" opacity="0.7"/></svg>') no-repeat center/contain;
      animation: twinkle 2.5s infinite alternate;
    }
    @keyframes twinkle {
      0% { opacity: 0.7; transform: scale(1); }
      100% { opacity: 1; transform: scale(1.2) rotate(10deg); }
    }
    /* 響應式調整 */
    @media (max-width: 600px) {
      .container { padding: 8px 2px; }
      .title { font-size: 1.3rem; }
      .section-title { font-size: 1.05rem; padding-left: 8px; }
      .theme-demo { flex-direction: column; gap: 12px; }
    }
    .card .label {
      margin-top: 6px;
      font-size: 1.05rem;
      color: #00ffff;
      white-space: normal;
      overflow: visible;
      text-overflow: unset;
      width: 100%;
      text-shadow: 0 0 8px #00ffff, 0 0 16px #a259ff;
      line-height: 1.3;
      word-break: break-all;
      word-wrap: break-word;
      hyphens: auto;
      min-height: 2.4em;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(90deg,rgba(0,255,255,0.08) 0%,rgba(162,89,255,0.08) 100%);
      border-radius: 8px;
      padding: 4px 6px 2px 6px;
      box-shadow: 0 0 8px #00ffff22;
    }
    .card .label .chinese-text {
      font-size: 0.89rem;
      color: #eaffff;
      margin-bottom: 2px;
      text-shadow: 0 0 18px #00ffff, 0 0 32px #a259ff, 0 0 6px #fff;
      font-weight: bold;
      word-break: break-all;
      word-wrap: break-word;
      text-align: center;
      letter-spacing: 0.9px;
      line-height: 1.1;
    }
    .card .label .english-text {
      font-size: 0.78rem;
      color: #fffbe0;
      text-shadow: 0 0 14px #ffd700, 0 0 24px #ffaa00, 0 0 4px #fff;
      font-weight: 600;
      letter-spacing: 0.6px;
      word-break: break-all;
      word-wrap: break-word;
      text-align: center;
      margin-bottom: 2px;
      line-height: 1.02;
    }
    .card .category-tag {
      margin-top: 4px;
      font-size: 0.75rem;
      color: #fff6ff;
      text-shadow: 0 0 12px #a259ff, 0 0 18px #00ffff, 0 0 4px #fff;
      font-weight: bold;
      letter-spacing: 0.7px;
      background: linear-gradient(90deg,rgba(0,255,255,0.22),rgba(162,89,255,0.22));
      border-radius: 6px;
      padding: 1.5px 6px;
      display: inline-block;
      box-shadow: 0 0 10px #a259ff66;
      border: 1.5px solid #00ffff99;
    }
    .card-desc {
      margin-top: 8px;
      font-size: 0.68rem;
      color: #eaffff;
      text-shadow: 0 0 14px #00ffffcc, 0 0 4px #fff, 0 0 2px #222;
      min-height: 2em;
      word-break: break-all;
      word-wrap: break-word;
      line-height: 1.28;
      text-align: left;
      background: linear-gradient(90deg,rgba(0,255,255,0.18),rgba(162,89,255,0.18));
      border-radius: 6px;
      padding: 5px 7px 3px 7px;
      width: 100%;
      box-sizing: border-box;
      max-height: 4em;
      overflow-y: auto;
      box-shadow: 0 0 14px #00ffff66;
      border: 1.5px solid #a259ff99;
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
      letter-spacing: 0.2px;
    }
    .category-badge, .category-badge.new {
      font-size: 1.08rem;
      padding: 3px 12px;
      border-radius: 10px;
      font-weight: bold;
      letter-spacing: 1.2px;
      box-shadow: 0 0 8px #ffd70099, 0 0 12px #a259ff66;
      border: 1.5px solid #ffd70099;
    }
    @media (max-width: 600px) {
      .card .label .chinese-text, .card .label .english-text {
        font-size: 0.98rem;
      }
      .card-desc {
        font-size: 0.95rem;
        padding: 4px 4px 2px 4px;
        max-height: 7em;
      }
    }
    .back-to-gacha-btn {
      display: inline-block;
      margin: 20px 0 10px 0;
      padding: 10px 24px;
      background: linear-gradient(90deg, #0ff, #08f);
      color: #fff;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      box-shadow: 0 2px 8px #0ff4;
      transition: background 0.2s, box-shadow 0.2s;
    }
    .back-to-gacha-btn:hover {
      background: linear-gradient(90deg, #08f, #0ff);
      box-shadow: 0 4px 16px #0ff8;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
</head>
<body>
  <!-- 返回抽卡頁按鈕 -->
  <a href="gacha.html" class="back-to-gacha-btn">返回抽卡頁</a>
  <div class="container">
    <div class="star-deco" style="top:-18px;left:12px;"></div>
    <div class="star-deco" style="top:22px;right:24px;"></div>
    <h1 class="title">新卡亮相 & 卡池資訊總攬</h1>
    <!-- 🔥 新卡亮相區 -->
    <section id="new-category-highlight">
      <div id="new-category-banner"></div>
      <div class="carousel" id="new-category-cards"></div>
    </section>
    <!-- 🗂️ 卡池資訊總攬 -->
    <section>
      <div class="section-title">🗂️ 卡池資訊總攬</div>
      <div id="category-list" class="grid"></div>
    </section>
    <!-- 🎨 視覺主題展示 -->
    <!-- 已移除 -->
  </div>
  <script src="js/cards.js"></script>
  <script>
    // 取得 baseCards
    const cards = typeof baseCards !== 'undefined' ? baseCards : [];
    // 1. 找出 createdAt 日期最新的分類
    let latestCategory = null;
    let latestDate = null;
    cards.forEach(card => {
      if(card.createdAt) {
        const d = new Date(card.createdAt);
        if(!latestDate || d > latestDate) {
          latestDate = d;
          latestCategory = card.category;
        }
      }
    });
    // 2. 新卡亮相區
    function renderNewCategoryHighlight() {
      if(!latestCategory) return;
      const newCards = cards.filter(c => c.category === latestCategory && c.createdAt);
      // 代表圖：第一張卡
      const banner = document.getElementById('new-category-banner');
      let bannerHtml = '';
      if(newCards.length > 0) {
        const img = newCards[0].image;
        bannerHtml += `<div style="width:100%;max-width:600px;margin:0 auto 12px auto;"><img src="${img}" style="width:100%;border-radius:18px;box-shadow:0 0 24px #00ffff99;object-fit:cover;max-height:220px;"></div>`;
      }
      // 主題文案依分類切換
      let themeHtml = '';
      if(latestCategory === '都市傳說') {
        themeHtml = `
          <div class="mystery-banner" style="margin:0 auto 18px auto;max-width:600px;text-align:center;">
            <div style="font-size:1.25rem;font-weight:bold;color:#ffd700;text-shadow:0 0 18px #ffd700,0 0 32px #a259ff,0 0 8px #fff;letter-spacing:1.5px;line-height:1.3;">本期主打：都市傳說 <span class='category-badge new'>NEW</span></div>
            <div style="font-size:1.05rem;color:#eaffff;text-shadow:0 0 12px #00ffff,0 0 24px #a259ff,0 0 2px #fff;margin:8px 0 0 0;">你敢打開這副牌，就得承擔打開後的命運。</div>
            <div style="font-size:0.98rem;color:#eaffff;text-shadow:0 0 8px #00ffff,0 0 12px #fff;letter-spacing:1px;margin:8px 0 0 0;">🌃 真相藏在夜色後面，別眨眼──新卡已現身。</div>
            <div style="font-size:0.98rem;color:#ff4b6e;text-shadow:0 0 8px #ff4b6e,0 0 12px #fff;letter-spacing:1px;margin:8px 0 0 0;">👁️‍🗨️ 別回頭，他正在你身後看著。</div>
            <div style="font-size:1.08rem;font-weight:bold;color:#a259ff;text-shadow:0 0 12px #00ffff,0 0 24px #a259ff,0 0 2px #fff;margin:12px 0 0 0;">🃏 都市傳說系列・開抽</div>
            <div style="font-size:0.95rem;color:#eaffff;text-shadow:0 0 8px #00ffff,0 0 16px #a259ff;">謎霧重重的夜，傳說中的祂們正等你翻開下一張。</div>
          </div>
        `;
      } else {
        themeHtml = `
          <div class="mystery-banner" style="margin:0 auto 18px auto;max-width:600px;text-align:center;">
            <div style="font-size:1.25rem;font-weight:bold;color:#ffd700;text-shadow:0 0 18px #ffd700,0 0 32px #a259ff,0 0 8px #fff;letter-spacing:1.5px;line-height:1.3;">本期主打：${latestCategory} <span class='category-badge new'>NEW</span></div>
            <div style="font-size:1.05rem;color:#eaffff;text-shadow:0 0 12px #00ffff,0 0 24px #a259ff,0 0 2px #fff;margin:8px 0 0 0;">探索${latestCategory}的神祕世界，揭開全新卡片的面紗！</div>
            <div style="font-size:0.98rem;color:#eaffff;text-shadow:0 0 8px #00ffff,0 0 12px #fff;letter-spacing:1px;margin:8px 0 0 0;">🌌 每一次翻開，都是未知的冒險。</div>
            <div style="font-size:1.08rem;font-weight:bold;color:#a259ff;text-shadow:0 0 12px #00ffff,0 0 24px #a259ff,0 0 2px #fff;margin:12px 0 0 0;">🃏 ${latestCategory} 系列・開抽</div>
            <div style="font-size:0.95rem;color:#eaffff;text-shadow:0 0 8px #00ffff,0 0 16px #a259ff;">快來收集屬於你的${latestCategory}新卡吧！</div>
          </div>
        `;
      }
      banner.innerHTML = bannerHtml + themeHtml;
      // 輪播三張新卡
      const carousel = document.getElementById('new-category-cards');
      carousel.innerHTML = newCards.slice(0,3).map(card => renderCard(card)).join('');
    }
    // 3. 卡池分類總覽
    function renderCategoryList() {
      const list = document.getElementById('category-list');
      // 統計分類與卡數
      const catMap = {};
      cards.forEach(card => {
        if(!catMap[card.category]) catMap[card.category] = { count:0, isNew:false };
        catMap[card.category].count++;
        if(card.category === latestCategory && card.createdAt) catMap[card.category].isNew = true;
      });
      list.innerHTML = Object.entries(catMap).map(([cat,info]) =>
        `<div style="padding:18px 12px;background:rgba(10,20,40,0.7);border-radius:12px;box-shadow:0 0 8px #00ffff33;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between;">
          <span style="color:#eaffff;font-size:1.13rem;font-weight:bold;letter-spacing:1.2px;text-shadow:0 0 14px #00ffff,0 0 8px #a259ff,0 0 2px #fff;">${cat}${info.isNew ? '<span class="category-badge new">NEW</span>' : ''}</span>
          <span style="color:#ffd700;font-size:1.13rem;font-weight:bold;text-shadow:0 0 12px #ffd700,0 0 6px #fff;">${info.count} 張</span>
        </div>`
      ).join('');
    }
    // 5. JSON 格式展示
    // function renderJsonSample() {
    //   const sample = cards[0] ? JSON.stringify(cards[0], null, 2) : '{}';
    //   document.getElementById('json-sample').textContent = sample;
    // }
    // 6. 下載 JSON
    // document.getElementById('download-json').onclick = function() {
    //   const blob = new Blob([JSON.stringify(cards, null, 2)], {type:'application/json'});
    //   const url = URL.createObjectURL(blob);
    //   const a = document.createElement('a');
    //   a.href = url;
    //   a.download = 'all_cards.json';
    //   a.click();
    //   URL.revokeObjectURL(url);
    // };
    // 卡片渲染
    function renderCard(card) {
      // 判斷圖片或影片
      const isVideo = card.image && (card.image.endsWith('.mp4') || card.image.endsWith('.webm'));
      // 稀有度轉換
      const rarityMap = { '普通': 'A', '稀有': 'R', '超稀有': 'SSR' };
      const rarityLabel = rarityMap[card.rarity] || card.rarity;
      return `<div class="card ${card.rarity === '超稀有' ? 'epic' : card.rarity === '稀有' ? 'rare' : 'common'}">
        <div class="media-container">
          ${isVideo ? `<video class="card-media" src="${card.image}" autoplay loop muted playsinline></video>` : `<img class="card-media" src="${card.image}" alt="${card.zh}">`}
        </div>
        <div class="label">
          <span class="chinese-text">${card.zh}</span>
          <span class="english-text">${card.word}</span>
        </div>
        <div class="category-tag">${card.category}</div>
        <div class="rank-badge">${rarityLabel}</div>
        <div class="card-desc" style="margin-top:8px;font-size:0.95rem;color:#fff;text-shadow:0 0 6px #222;min-height:2.5em;">${card.description ? card.description : ''}</div>
      </div>`;
    }
    // 初始化
    renderNewCategoryHighlight();
    renderCategoryList();
    // renderJsonSample(); // 已移除
  </script>
</body>
</html> 
