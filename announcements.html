<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“£ æœ€æ–°å…¬å‘Š</title>
  <style>
    body { font-family: 'Noto Sans TC', sans-serif; padding: 20px; background: #f9f9f9; }
    #announcements { max-width: 600px; margin: 0 auto; }
    .announcement {
      border-left: 6px solid #888;
      background: #fff;
      padding: 12px 16px;
      margin: 10px 0;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .ğŸ”´ { border-color: crimson; background: #ffecec; }
    .ğŸŸ¢ { border-color: green; background: #ecfff1; }
    .ğŸ”µ { border-color: dodgerblue; background: #e6f2ff; }
    .announcement small { display: block; color: #888; margin-top: 6px; }
    .header {
      text-align: center;
      margin-bottom: 30px;
    }
    .back-btn {
      display: inline-block;
      padding: 8px 16px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }
    .back-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .error-message {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      color: #856404;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
    }
    .loading {
      text-align: center;
      color: #666;
      font-style: italic;
    }
    .refresh-btn {
      display: inline-block;
      padding: 8px 16px;
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      margin-left: 10px;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
    }
    .refresh-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <div class="header">
    <a href="index.html" class="back-btn">ğŸ  è¿”å›é¦–é </a>
    <button class="refresh-btn" onclick="loadAnnouncements()">ğŸ”„ é‡æ–°è¼‰å…¥</button>
    <h2>ğŸ“£ ç³»çµ±å…¬å‘Š</h2>
  </div>
  <div id="announcements">è¼‰å…¥ä¸­...</div>

  <script src="js/announcements.js"></script>
  <script>
    // Google Sheets API ç¶²å€
    const GOOGLE_SHEETS_API = "https://script.google.com/macros/s/AKfycbyfM8pLiWIjRsvg7u3rJ5Zh4XdKLFuScaQ5t_0yQviBp11IwOZSyrgZ-KFHkrJT43UBPg/exec";
    
    // æœ¬åœ°å‚™ç”¨å…¬å‘Šæ•¸æ“š
    const fallbackAnnouncements = [
      {
        type: "ğŸ”´",
        content: "ç³»çµ±ç¶­è­·ä¸­ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½æš«æ™‚ç„¡æ³•ä½¿ç”¨",
        time: "2024-01-15 10:00"
      },
      {
        type: "ğŸŸ¢",
        content: "æ­¡è¿ä½¿ç”¨è‹±æ‰“å°è‹±é›„ï¼æ–°åŠŸèƒ½é™¸çºŒæ¨å‡ºä¸­",
        time: "2024-01-10 09:30"
      },
      {
        type: "ğŸ”µ",
        content: "å¦‚æœ‰å•é¡Œè«‹è¯ç¹«å®¢æœæˆ–ä½¿ç”¨ç©å®¶ä¿¡ç®±åŠŸèƒ½",
        time: "2024-01-05 14:20"
      }
    ];

    function loadAnnouncements() {
      const box = document.getElementById("announcements");
      box.innerHTML = '<div class="loading">æ­£åœ¨å¾ Google Sheets è¼‰å…¥å…¬å‘Š...</div>';

      // å¾ Google Sheets è¼‰å…¥
      fetch(GOOGLE_SHEETS_API)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          if (data && data.length > 0) {
            displayAnnouncements(data);
          } else {
            throw new Error('No data received');
          }
        })
        .catch(error => {
          console.log('Google Sheets è¼‰å…¥å¤±æ•—ï¼Œä½¿ç”¨æœ¬åœ°æ•¸æ“š:', error);
          // å¦‚æœ Google Sheets å¤±æ•—ï¼Œä½¿ç”¨æœ¬åœ°æ•¸æ“š
          if (typeof localAnnouncements !== 'undefined' && localAnnouncements.length > 0) {
            displayAnnouncements(localAnnouncements);
          } else {
            displayAnnouncements(fallbackAnnouncements);
          }
        });
    }

    function displayAnnouncements(announcements) {
      const box = document.getElementById("announcements");
      
      if (!announcements || announcements.length === 0) {
        box.innerHTML = "ğŸš« ç›®å‰æ²’æœ‰å…¬å‘Š";
        return;
      }

      box.innerHTML = announcements.map(a => `
        <div class="announcement ${a.type}">
          <strong>${a.type}</strong> ${a.content}
          <small>ğŸ•’ ${a.time}</small>
        </div>
      `).join("");
    }

    // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
    document.addEventListener('DOMContentLoaded', function() {
      loadAnnouncements();
    });
  </script>
</body>
</html> 