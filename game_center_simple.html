<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>éŠæˆ²ä¸­å¿ƒ - ä¸‰å¤§éŠæˆ²</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      --glow-cyan: #00ffff;
      --glow-magenta: #a259ff;
      --glow-gold: #ffd700;
      --glow-red: #ff6b6b;
      --glow-green: #00ff88;
      --bg-dark: rgba(10, 20, 40, 0.85);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Orbitron', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      background: linear-gradient(135deg, #0a1428 0%, #1a2a4a 50%, #0a1428 100%);
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* èƒŒæ™¯å‹•ç•«æ•ˆæœ */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(162, 89, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    .header {
      background: rgba(10, 20, 40, 0.95);
      padding: 20px;
      text-align: center;
      border-bottom: 3px solid var(--glow-cyan);
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
      backdrop-filter: blur(10px);
    }

    .header h1 {
      margin: 0;
      font-size: 2.5rem;
      background: linear-gradient(45deg, var(--glow-cyan), var(--glow-magenta), var(--glow-gold));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { filter: brightness(1); }
      to { filter: brightness(1.2); }
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .stats-panel {
      background: rgba(10, 20, 40, 0.9);
      border: 2px solid var(--glow-gold);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }

    .lobby-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .lobby-card {
      background: rgba(10, 20, 40, 0.9);
      border: 2px solid var(--glow-cyan);
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 0 22px rgba(0, 255, 255, 0.18);
    }

    .lobby-card h3 {
      margin: 0 0 12px;
      color: var(--glow-cyan);
      font-size: 1.3rem;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
    }

    .input {
      width: 100%;
      padding: 12px 12px;
      border-radius: 10px;
      border: 2px solid rgba(0, 255, 255, 0.35);
      background: rgba(0, 0, 0, 0.25);
      color: #fff;
      outline: none;
      font-family: 'Roboto Mono', monospace;
      font-weight: 700;
    }

    .mini-btn {
      border: none;
      border-radius: 10px;
      padding: 12px 14px;
      cursor: pointer;
      font-weight: 900;
      background: linear-gradient(45deg, var(--glow-cyan), var(--glow-magenta));
      color: #000;
      transition: transform 0.2s, box-shadow 0.2s;
      white-space: nowrap;
    }

    .mini-btn:hover {
      transform: scale(1.03);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.35);
    }

    .mini-btn[disabled] {
      opacity: 0.55;
      cursor: not-allowed;
      filter: grayscale(1);
      box-shadow: none;
      transform: none;
    }

    .hint {
      color: #cbd5e1;
      font-size: 0.95rem;
      line-height: 1.55;
    }

    .history {
      margin: 12px 0 0;
      padding: 0;
      list-style: none;
      max-height: 220px;
      overflow: auto;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.18);
    }

    .history li {
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.06);
      color: #e5e7eb;
      font-family: 'Roboto Mono', monospace;
      font-size: 0.9rem;
    }

    .history li:last-child { border-bottom: none; }

    .gacha-machine {
      position: relative;
      width: 100%;
      max-width: 520px;
      margin: 12px auto 0;
      border-radius: 18px;
      border: 1px solid rgba(0,255,255,.22);
      background: linear-gradient(180deg, rgba(225, 245, 252, 0.22), rgba(10,20,40,.25));
      box-shadow: 0 0 22px rgba(0,255,255,.14);
      overflow: hidden;
      cursor: pointer;
      user-select: none;
      transform: translateZ(0);
    }

    .gacha-machine::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 18px;
      pointer-events: none;
      background: linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,0));
    }

    .gacha-machine.locked {
      opacity: 0.6;
      cursor: not-allowed;
      filter: grayscale(0.35);
    }

    .gacha-machine:focus-visible {
      outline: 2px solid rgba(0,255,255,.55);
      outline-offset: 3px;
    }

    .gacha-top {
      padding: 14px 14px 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .gacha-cabinet {
      margin: 0 14px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(10, 20, 40, 0.20);
      display: grid;
      grid-template-columns: 1fr 155px;
      gap: 12px;
      padding: 12px;
    }

    .gacha-panel {
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.12);
      padding: 10px;
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 10px;
      align-content: start;
    }

    .gacha-slot {
      position: relative;
      height: 34px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(0,0,0,.10));
      overflow: hidden;
    }

    .gacha-slot::after {
      content: '';
      position: absolute;
      left: 50%;
      top: 50%;
      width: 72px;
      height: 10px;
      transform: translate(-50%, -50%);
      border-radius: 999px;
      background: rgba(0,0,0,.30);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.08);
    }

    .gacha-knob {
      width: 86px;
      height: 86px;
      border-radius: 999px;
      margin: 0 auto;
      border: 1px solid rgba(255,255,255,.16);
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), rgba(120, 220, 235, .22));
      box-shadow: 0 0 18px rgba(0,255,255,.10);
      position: relative;
      transform: translateZ(0);
    }

    .gacha-knob::after {
      content: '';
      position: absolute;
      left: 50%;
      top: 12px;
      width: 8px;
      height: 18px;
      transform: translateX(-50%);
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.10);
    }

    .gacha-machine.phase-spin .gacha-knob {
      animation: gachaKnobTurn 1.05s ease-in-out 1;
    }

    @keyframes gachaKnobTurn {
      0% { transform: rotate(0deg); }
      40% { transform: rotate(70deg); }
      100% { transform: rotate(0deg); }
    }

    .gacha-base {
      margin: 0 14px 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(10, 20, 40, 0.22);
      padding: 10px 12px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .gacha-base-left {
      color: #cbd5e1;
      font-size: 0.9rem;
    }

    .gacha-stars {
      display: flex;
      gap: 8px;
      align-items: center;
      opacity: 0.8;
    }

    .gacha-star {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: rgba(255,255,255,.60);
      box-shadow: 0 0 10px rgba(255,255,255,.22);
    }

    .gacha-title {
      font-weight: 900;
      letter-spacing: 0.4px;
      color: #fff;
      text-shadow: 0 0 14px rgba(0,255,255,.18);
    }

    .gacha-sub {
      font-size: 0.88rem;
      color: #cbd5e1;
      margin-top: 2px;
    }

    .gacha-badge {
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      font-family: 'Roboto Mono', monospace;
      color: #e5e7eb;
      white-space: nowrap;
    }

    .gacha-window {
      position: relative;
      height: 150px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), rgba(0,0,0,.12));
      overflow: hidden;
    }

    .gacha-bubbles {
      position: absolute;
      inset: -20px;
      opacity: 0.75;
      background:
        radial-gradient(circle at 15% 25%, rgba(255,190,220,.45) 0 18px, transparent 19px),
        radial-gradient(circle at 35% 55%, rgba(190,255,235,.40) 0 20px, transparent 21px),
        radial-gradient(circle at 65% 30%, rgba(210,210,255,.40) 0 22px, transparent 23px),
        radial-gradient(circle at 80% 68%, rgba(255,235,190,.35) 0 18px, transparent 19px),
        radial-gradient(circle at 55% 78%, rgba(255,210,255,.30) 0 16px, transparent 17px);
      filter: blur(0.2px);
      transform: translateZ(0);
    }

    .gacha-capsule {
      position: absolute;
      left: 50%;
      top: 56%;
      width: 92px;
      height: 56px;
      transform: translate(-50%, -50%);
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: linear-gradient(90deg, rgba(255,255,255,.62), rgba(255,190,220,.46));
      box-shadow: 0 0 18px rgba(255,255,255,.16);
      overflow: hidden;
    }

    .gacha-capsule::after {
      content: '';
      position: absolute;
      left: 50%;
      top: 0;
      width: 2px;
      height: 100%;
      transform: translateX(-50%);
      background: rgba(0,0,0,.10);
    }

    .gacha-capsule.open {
      background: linear-gradient(90deg, rgba(255,255,255,.68), rgba(200,255,240,.46));
    }

    .gacha-controls {
      padding: 0 14px 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
    }

    .gacha-hint {
      color: #cbd5e1;
      font-size: 0.9rem;
    }

    .gacha-action {
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(0,255,255,.30);
      background: rgba(0,255,255,.10);
      color: #fff;
      font-weight: 900;
      cursor: pointer;
      transition: transform .15s ease, box-shadow .15s ease;
      box-shadow: 0 0 18px rgba(0,255,255,.14);
    }

    .gacha-action:disabled {
      opacity: 0.55;
      cursor: not-allowed;
    }

    .gacha-action:not(:disabled):hover {
      transform: translateY(-1px);
      box-shadow: 0 0 26px rgba(0,255,255,.18);
    }

    .gacha-sparkle {
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0;
      background:
        radial-gradient(circle at 20% 25%, rgba(255,255,255,.45) 0 12px, transparent 13px),
        radial-gradient(circle at 80% 35%, rgba(255,255,255,.35) 0 10px, transparent 11px),
        radial-gradient(circle at 55% 70%, rgba(255,255,255,.30) 0 14px, transparent 15px);
      filter: blur(0.2px);
    }

    .gacha-machine.phase-sparkle .gacha-sparkle {
      animation: gachaSparkle 0.9s ease-in-out 1;
    }

    @keyframes gachaSparkle {
      0% { opacity: 0; }
      35% { opacity: 0.9; }
      100% { opacity: 0; }
    }

    .gacha-coin {
      position: absolute;
      right: 64px;
      top: -20px;
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.78), rgba(255,215,0,.72));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 0 14px rgba(255,215,0,.25);
      opacity: 0;
      pointer-events: none;
    }

    .gacha-machine.phase-coin .gacha-coin {
      animation: gachaCoinDrop 0.8s cubic-bezier(.2,.8,.2,1) 1;
    }

    @keyframes gachaCoinDrop {
      0% { transform: translateY(-10px) rotate(0deg); opacity: 0; }
      15% { opacity: 1; }
      100% { transform: translateY(220px) rotate(140deg); opacity: 0; }
    }

    .gacha-machine.phase-spin .gacha-capsule {
      animation: gachaCapsuleSpin 1.05s ease-in-out 1;
    }

    @keyframes gachaCapsuleSpin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      50% { transform: translate(-50%, -50%) rotate(40deg); }
      100% { transform: translate(-50%, -50%) rotate(0deg); }
    }

    .gacha-burst {
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0;
      background: radial-gradient(circle at 50% 55%, rgba(255,255,255,.55), transparent 60%);
    }

    .gacha-machine.phase-open .gacha-burst {
      animation: gachaBurst 1.2s ease-out 1;
    }

    @keyframes gachaBurst {
      0% { opacity: 0; transform: scale(0.98); }
      35% { opacity: 0.75; transform: scale(1.02); }
      100% { opacity: 0; transform: scale(1.06); }
    }

    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.55);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 9999;
    }

    .modal {
      width: min(520px, 96vw);
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(10, 20, 40, 0.92);
      box-shadow: 0 0 28px rgba(0,255,255,.12);
      overflow: hidden;
      animation: modalIn .18s ease-out 1;
    }

    .modal.jackpot {
      box-shadow: 0 0 42px rgba(255, 215, 0, .18), 0 0 28px rgba(0,255,255,.12);
      border-color: rgba(255, 215, 0, .22);
      animation: modalIn .18s ease-out 1, jackpotPulse 1.6s ease-in-out 1;
    }

    @keyframes jackpotPulse {
      0% { transform: translateY(0) scale(1); }
      40% { transform: translateY(-1px) scale(1.01); }
      100% { transform: translateY(0) scale(1); }
    }

    .jackpot-confetti {
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0;
      background:
        radial-gradient(circle at 12% 18%, rgba(255,215,0,.30) 0 6px, transparent 7px),
        radial-gradient(circle at 32% 26%, rgba(0,255,255,.22) 0 5px, transparent 6px),
        radial-gradient(circle at 70% 20%, rgba(255,120,200,.20) 0 6px, transparent 7px),
        radial-gradient(circle at 82% 34%, rgba(255,255,255,.22) 0 4px, transparent 5px),
        radial-gradient(circle at 22% 62%, rgba(190,255,235,.18) 0 6px, transparent 7px),
        radial-gradient(circle at 65% 70%, rgba(255,235,190,.18) 0 5px, transparent 6px);
      filter: blur(0.2px);
    }

    .modal.jackpot .jackpot-confetti {
      animation: confettiFloat 1.8s ease-out 1;
    }

    @keyframes confettiFloat {
      0% { opacity: 0; transform: translateY(-6px); }
      20% { opacity: 0.9; }
      100% { opacity: 0; transform: translateY(10px); }
    }

    .jackpot-badge {
      display: inline-block;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,215,0,.28);
      background: rgba(255,215,0,.10);
      color: #fff;
      font-weight: 900;
      letter-spacing: 0.4px;
      text-shadow: 0 0 14px rgba(255,215,0,.18);
      margin-bottom: 10px;
    }

    @keyframes modalIn {
      from { transform: translateY(6px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-header {
      padding: 12px 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }

    .modal-title {
      font-weight: 900;
      color: #fff;
      letter-spacing: 0.3px;
    }

    .modal-close {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: #fff;
      cursor: pointer;
    }

    .modal-body {
      padding: 14px;
      color: #e5e7eb;
      line-height: 1.6;
    }

    .modal-result {
      font-size: 1.05rem;
      font-weight: 900;
      color: var(--glow-cyan);
      text-shadow: 0 0 12px rgba(0,255,255,.16);
    }

    .reward-hero {
      padding: 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(0,255,255,.10), rgba(0,0,0,.08));
      box-shadow: 0 0 20px rgba(0,255,255,.10);
      margin-bottom: 12px;
    }

    .reward-hero-title {
      font-weight: 900;
      color: #fff;
      margin-bottom: 6px;
    }

    .reward-list {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin: 0;
      padding: 0;
      list-style: none;
      max-height: 280px;
      overflow: auto;
    }

    .reward-item {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }

    .reward-item.main {
      background: rgba(0,255,255,.08);
      border-color: rgba(0,255,255,.22);
    }

    .reward-text {
      font-weight: 900;
      color: #e5e7eb;
      line-height: 1.35;
    }

    .reward-meta {
      margin-top: 4px;
      color: #cbd5e1;
      font-size: 0.85rem;
      font-family: 'Roboto Mono', monospace;
      opacity: 0.9;
    }

    .reward-pill {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      color: #e5e7eb;
      font-family: 'Roboto Mono', monospace;
      font-size: 0.85rem;
      white-space: nowrap;
    }

    .modal-footer {
      padding: 12px 14px;
      border-top: 1px solid rgba(255,255,255,.08);
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .modal-footer-left {
      margin-right: auto;
      display: flex;
      align-items: center;
      gap: 10px;
      color: #cbd5e1;
      font-size: 0.9rem;
      font-family: 'Roboto Mono', monospace;
    }

    .guide {
      margin-top: 12px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(0, 255, 255, 0.22);
      background: rgba(0,0,0,.18);
    }

    .guide-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-top: 10px;
    }

    .guide-steps {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin: 10px 0 0;
      padding: 0;
      list-style: none;
    }

    .guide-step {
      display: grid;
      grid-template-columns: 34px 1fr;
      gap: 10px;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(10, 20, 40, 0.55);
    }

    .step-badge {
      width: 34px;
      height: 34px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 900;
      color: #000;
      background: linear-gradient(45deg, var(--glow-cyan), var(--glow-magenta));
      box-shadow: 0 0 16px rgba(0,255,255,.18);
      font-family: 'Roboto Mono', monospace;
    }

    .step-text {
      color: #e5e7eb;
      line-height: 1.55;
    }

    .stat-item {
      text-align: center;
      padding: 15px;
      background: rgba(0, 255, 255, 0.1);
      border-radius: 8px;
      border: 1px solid var(--glow-cyan);
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: bold;
      color: var(--glow-gold);
    }

    .stat-label {
      color: #ccc;
      font-size: 0.9rem;
      margin-top: 5px;
    }

    .games-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 30px;
      margin-top: 20px;
    }

    .game-card {
      background: rgba(10, 20, 40, 0.8);
      border: 3px solid var(--glow-cyan);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      text-align: center;
    }

    .game-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
      transition: left 0.5s ease;
    }

    .game-card:hover::before {
      left: 100%;
    }

    .game-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.4);
      border-color: var(--glow-magenta);
    }

    .game-icon {
      font-size: 4rem;
      margin-bottom: 20px;
      display: block;
    }

    .game-title {
      font-size: 2rem;
      font-weight: bold;
      color: var(--glow-cyan);
      margin-bottom: 15px;
    }

    .game-subtitle {
      font-size: 1.1rem;
      color: var(--glow-gold);
      margin-bottom: 20px;
    }

    .game-description {
      color: #ccc;
      line-height: 1.6;
      margin-bottom: 25px;
      font-size: 1rem;
    }

    .game-features {
      text-align: left;
      margin-bottom: 25px;
      padding: 0 20px;
    }

    .feature-item {
      color: #ccc;
      margin-bottom: 8px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
    }

    .feature-item::before {
      content: 'âœ“';
      color: var(--glow-green);
      font-weight: bold;
      margin-right: 10px;
    }

    .game-button {
      background: linear-gradient(45deg, var(--glow-cyan), var(--glow-magenta));
      color: #000;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-weight: bold;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }

    .game-button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 25px rgba(0, 255, 255, 0.5);
    }

    /* é–å®šç‹€æ…‹æ¨£å¼ */
    .game-card.locked {
      opacity: 0.6;
      cursor: not-allowed;
      border-color: var(--glow-red);
      box-shadow: 0 0 20px rgba(255, 107, 107, 0.3);
    }

    .game-card.locked:hover {
      transform: none;
      box-shadow: 0 0 20px rgba(255, 107, 107, 0.3);
      border-color: var(--glow-red);
    }

    .game-card.locked::before {
      display: none;
    }

    .game-button.locked {
      background: linear-gradient(45deg, #666, #999);
      color: #ccc;
      cursor: not-allowed;
      opacity: 0.8;
    }

    .game-button.locked:hover {
      transform: none;
      box-shadow: none;
    }

    .game-button[disabled] {
      cursor: not-allowed;
      pointer-events: none;
      opacity: 0.6;
    }

    .game-button.locked {
      background: linear-gradient(45deg, #666, #999);
      color: #ccc;
      cursor: not-allowed;
      opacity: 0.8;
    }

    .game-button.locked:hover {
      transform: none;
      box-shadow: none;
    }

    /* åµŒå…¥å¼éŠæˆ²å®¹å™¨æ¨£å¼ */
    .embedded-game-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 20, 40, 0.95);
      z-index: 2000;
      display: flex;
      flex-direction: column;
    }

    .embedded-game-header {
      background: rgba(10, 20, 40, 0.98);
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid var(--glow-cyan);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
    }

    .embedded-game-header h2 {
      margin: 0;
      color: var(--glow-cyan);
      font-size: 1.5rem;
    }

    .close-game-btn {
      background: linear-gradient(45deg, var(--glow-red), var(--glow-magenta));
      color: #fff;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .close-game-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
    }

    .embedded-game-frame {
      flex: 1;
      width: 100%;
      background: #000;
    }

    .embedded-game-frame iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: linear-gradient(45deg, var(--glow-cyan), var(--glow-magenta));
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .back-button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
    }

    .welcome-message {
      background: rgba(10, 20, 40, 0.9);
      border: 2px solid var(--glow-cyan);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 30px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
    }

    .welcome-title {
      font-size: 1.5rem;
      color: var(--glow-cyan);
      margin-bottom: 10px;
    }

    .welcome-text {
      color: #ccc;
      line-height: 1.6;
    }

    /* æ˜Ÿæ˜Ÿé¡¯ç¤ºå€åŸŸ */
    .stars-display {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 215, 0, 0.05));
      border: 2px solid var(--glow-gold);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 30px;
      text-align: center;
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
      position: relative;
      overflow: hidden;
    }

    .stars-display::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
      animation: shine 3s infinite;
    }

    @keyframes shine {
      0% { left: -100%; }
      50% { left: 100%; }
      100% { left: 100%; }
    }

    .stars-title {
      font-size: 1.8rem;
      color: var(--glow-gold);
      margin-bottom: 10px;
      font-weight: bold;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }

    .stars-count {
      font-size: 3rem;
      font-weight: bold;
      color: var(--glow-gold);
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
      margin-bottom: 10px;
    }

    .stars-icon {
      font-size: 2rem;
      margin: 0 10px;
      animation: twinkle 2s ease-in-out infinite alternate;
    }

    @keyframes twinkle {
      from { transform: scale(1); opacity: 1; }
      to { transform: scale(1.2); opacity: 0.8; }
    }

    .stars-subtitle {
      color: #ccc;
      font-size: 1rem;
      margin-top: 10px;
    }

    /* æ˜Ÿæ˜Ÿæ›´æ–°å‹•ç•« */
    .stars-update {
      animation: starsUpdate 0.5s ease-in-out;
    }

    @keyframes starsUpdate {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); box-shadow: 0 0 50px rgba(255, 215, 0, 0.6); }
      100% { transform: scale(1); }
    }

    /* éŸ³æ•ˆæ§åˆ¶ */
    #audioControls {
      position: fixed;
      bottom: 15px;
      right: 15px;
      display: flex;
      gap: 8px;
    }

    #audioControls button {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: 2px solid var(--glow-cyan);
      background: rgba(10, 20, 40, 0.6);
      color: #fff;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 0 16px var(--glow-cyan);
      backdrop-filter: blur(1px);
    }

    #audioControls button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 32px var(--glow-cyan);
    }

    @media (max-width: 768px) {
      .games-grid {
        grid-template-columns: 1fr;
      }

      .lobby-grid {
        grid-template-columns: 1fr;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .container {
        padding: 10px;
      }

      .game-card {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <button class="back-button" @click="goHome">
      <i class="material-icons">home</i> è¿”å›é¦–é 
    </button>

         <div class="header">
                     <h1>ğŸ® å…«å¤§éŠæˆ²ä¸­å¿ƒ</h1>
     </div>

    <div class="container">
      <div class="modal-overlay" v-if="showLotteryModal" @click.self="closeLotteryModal" @keydown.esc.window="closeLotteryModal">
        <div class="modal" :class="{ jackpot: jackpotActive }" role="dialog" aria-modal="true" aria-label="æŠ½ççµæœ">
          <div class="jackpot-confetti"></div>
          <div class="modal-header">
            <div class="modal-title">ğŸ æŠ½ççµæœæ¸…å–®</div>
            <button class="modal-close" @click="closeLotteryModal" aria-label="é—œé–‰">âœ•</button>
          </div>
          <div class="modal-body">
            <div class="jackpot-badge" v-if="jackpotActive">ğŸ† å¤§çï¼{{ jackpotText }}</div>
            <div class="reward-hero">
              <div class="reward-hero-title">æœ¬æ¬¡ç²å¾—</div>
              <div class="modal-result">{{ lotteryModalText }}</div>
              <div class="hint" style="margin:6px 0 0;" v-if="lotteryModalBonusText">é¡å¤–çå‹µï¼š<b style="color: var(--glow-gold);">{{ lotteryModalBonusText }}</b></div>
              <div class="hint" style="margin:8px 0 0;">æ¶ˆè€—ï¼šğŸª™ {{ lotteryCost }}</div>
            </div>

            <div class="hint" style="margin:0 0 8px;">æœ€è¿‘ç´€éŒ„</div>
            <ul class="reward-list">
              <li class="reward-item" v-for="(row, idx) in lotteryHistoryParsed.slice(0, 10)" :key="idx" :class="{ main: idx===0 }">
                <div>
                  <div class="reward-text">{{ row.text }}</div>
                  <div class="reward-meta">{{ row.time }}</div>
                </div>
                <div class="reward-pill">ğŸª™ {{ row.cost }}</div>
              </li>
            </ul>
          </div>
          <div class="modal-footer">
            <div class="modal-footer-left">
              <div>ğŸ å¯¶ç®±ï¼š{{ lotteryChestCount }}</div>
              <button class="mini-btn" @click="openChest" :disabled="lotteryChestCount<=0">é–‹å•Ÿå¯¶ç®±</button>
            </div>
            <button class="mini-btn" @click="closeLotteryModal">çŸ¥é“äº†</button>
          </div>
        </div>
      </div>

      <!-- æ­¡è¿è¨Šæ¯ -->
      <div class="welcome-message">
        <div class="welcome-title">æ­¡è¿ä¾†åˆ°éŠæˆ²ä¸­å¿ƒï¼</div>
                               <div class="welcome-text">
            é€™è£¡æœ‰æˆ‘å€‘ç²¾å¿ƒè¨­è¨ˆçš„å…«å€‹ç²¾å½©éŠæˆ²ï¼Œæ¯å€‹éŠæˆ²éƒ½æœ‰ç¨ç‰¹çš„ç©æ³•å’ŒæŒ‘æˆ°ã€‚
            é¸æ“‡ä½ å–œæ­¡çš„éŠæˆ²é–‹å§‹å†’éšªå§ï¼
              </div>
      </div>

             <!-- æ˜Ÿæ˜Ÿé¡¯ç¤ºå€åŸŸ -->
       <div class="stars-display" :class="{ 'stars-update': starsAnimation }">
         <div class="stars-title">ä½ çš„æ˜Ÿæ˜Ÿ</div>
         <div class="stars-count">{{ totalStars }}</div>
         <div class="stars-icon">â­</div>
         <div class="stars-subtitle">æ”¶é›†æ˜Ÿæ˜Ÿï¼Œè§£é–æ›´å¤šéŠæˆ²ï¼</div>
         
         <!-- æ˜Ÿæ˜Ÿè©³ç´°è³‡è¨Š -->
         <div style="margin-top: 15px; padding: 10px; background: rgba(255, 215, 0, 0.1); border-radius: 8px;">
           <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9rem;">
             <div>
               <div style="color: var(--glow-green);">ç²å¾—: {{ totalStarsEarned }}</div>
               <div style="color: var(--glow-red);">èŠ±è²»: {{ starsSpent }}</div>
             </div>
             <div>
               <div style="color: var(--glow-cyan);">ç­‰ç´š: {{ playerLevel }}</div>
               <div style="color: var(--glow-gold);">é€²åº¦: {{ levelProgressPercentage }}%</div>
             </div>
           </div>
         </div>
         
                   <div style="color: #999; font-size: 0.8rem; margin-top: 5px;">ğŸ’¡ æç¤ºï¼šéŠç©å…¶ä»–éŠæˆ²å¯ä»¥ç²å¾—æ˜Ÿæ˜Ÿ</div>
          <div style="color: var(--glow-cyan); font-size: 0.8rem; margin-top: 3px;">ğŸ”„ æ˜Ÿæ˜Ÿç³»çµ±å·²èˆ‡é¦–é åŒæ­¥</div>
       </div>

      <!-- çµ±è¨ˆé¢æ¿ -->
      <div class="stats-panel">
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-value">{{ availableGames }}/{{ totalGames }}</div>
            <div class="stat-label">å¯ç”¨éŠæˆ²</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">{{ completedGames }}</div>
            <div class="stat-label">å·²å®Œæˆ</div>
          </div>
          <div class="stat-item" style="background: rgba(255, 215, 0, 0.15); border-color: var(--glow-gold);">
            <div class="stat-value" style="color: var(--glow-gold); text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);">â­ {{ totalStars }}</div>
            <div class="stat-label" style="color: var(--glow-gold);">ç¸½æ˜Ÿæ˜Ÿ</div>
          </div>
          <div class="stat-item" style="background: rgba(255, 215, 0, 0.10); border-color: var(--glow-cyan);">
            <div class="stat-value" style="color: var(--glow-cyan); text-shadow: 0 0 10px rgba(0, 255, 255, 0.35);">ğŸª™ {{ goldCoins }}</div>
            <div class="stat-label" style="color: var(--glow-cyan);">é‡‘å¹£</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">{{ playerLevel }}</div>
            <div class="stat-label">ç©å®¶ç­‰ç´š</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">{{ completionRate }}%</div>
            <div class="stat-label">å®Œæˆç‡</div>
          </div>
        </div>
      </div>

      <!-- éŠæˆ²å¤§å»³åŠŸèƒ½å€ -->
      <div class="lobby-grid">
        <div class="lobby-card">
          <h3>ğŸ’° æ˜Ÿæ˜Ÿå…Œæ›é‡‘å¹£</h3>
          <div class="hint">
            åŒ¯ç‡ï¼š<b style="color: var(--glow-gold);">{{ exchangeRate }}</b> æ˜Ÿæ˜Ÿ = <b style="color: var(--glow-cyan);">{{ exchangeCoinsPerRate }}</b> é‡‘å¹£ã€‚
            ä½ ç›®å‰æœ‰ â­ {{ totalStars }} / ğŸª™ {{ goldCoins }}ã€‚
          </div>
          <div class="form-row">
            <input class="input" type="number" min="1" step="1" v-model.number="exchangeStarsAmount" placeholder="è¼¸å…¥è¦å…Œæ›çš„æ˜Ÿæ˜Ÿæ•¸é‡" />
            <button class="mini-btn" @click="exchangeStarsForCoins" :disabled="exchangeStarsAmount<=0 || totalStars < exchangeStarsAmount">å…Œæ›</button>
          </div>
          <div class="hint" style="margin-top:10px;">
            ä¼°è¨ˆå¯å¾—ï¼šğŸª™ {{ previewCoins }}
          </div>
        </div>

        <div class="lobby-card">
          <h3>ğŸ° é‡‘å¹£æŠ½çï¼ˆè½‰è›‹ï¼‰</h3>
          <div class="hint">
            æ¯æ¬¡æŠ½çæ¶ˆè€— <b style="color: var(--glow-gold);">ğŸª™ {{ effectiveLotteryCost }}</b> é‡‘å¹£ã€‚
            å¯èƒ½æŠ½åˆ°ï¼šé‡‘å¹£ã€æ˜Ÿæ˜Ÿã€å¯¶ç®±ã€ç¨±è™Ÿã€‚
            ä¹Ÿæœ‰æ©ŸæœƒæŠ½åˆ°<b style="color: var(--glow-red);">å£çå‹µ</b>ï¼ˆæ‰£é‡‘å¹£ / æ‰£æ˜Ÿæ˜Ÿ / ç©ºè½‰ï¼‰ã€‚
          </div>
          <div
            class="gacha-machine"
            :class="[
              (goldCoins < effectiveLotteryCost || gachaAnimating) ? 'locked' : '',
              gachaPhase ? ('phase-' + gachaPhase) : ''
            ]"
            role="button"
            tabindex="0"
            @click="startGacha"
            @keydown.enter.prevent="startGacha"
            @keydown.space.prevent="startGacha"
            :aria-disabled="(goldCoins < effectiveLotteryCost || gachaAnimating) ? 'true' : 'false'"
          >
            <div class="gacha-sparkle"></div>
            <div class="gacha-burst"></div>
            <div class="gacha-coin"></div>

            <div class="gacha-top">
              <div>
                <div class="gacha-title">è½‰è›‹æ©Ÿ</div>
                <div class="gacha-sub">é»ä¸€ä¸‹é–‹å§‹æŠ½çï¼ˆä¸åˆºæ¿€ç‰¹æ•ˆï¼‰</div>
              </div>
              <div class="gacha-badge">ğŸª™ {{ goldCoins }}</div>
            </div>

            <div class="gacha-cabinet">
              <div class="gacha-window">
                <div class="gacha-bubbles"></div>
                <div class="gacha-capsule" :class="{ open: gachaPhase==='open' }"></div>
              </div>

              <div class="gacha-panel">
                <div class="gacha-slot"></div>
                <div class="gacha-knob"></div>
                <button class="gacha-action" @click.stop="startGacha" :disabled="goldCoins < effectiveLotteryCost || gachaAnimating">æŠ•å¹£æŠ½ä¸€æ¬¡</button>
              </div>
            </div>

            <div class="gacha-base">
              <div class="gacha-base-left">
                æ¯æ¬¡æ¶ˆè€— ğŸª™ {{ effectiveLotteryCost }}ï½œæœ¬æ¬¡ï¼š{{ gachaAnimating ? 'æŠ½çä¸­â€¦' : 'å¯é»æ“Š' }}
                <div class="hint" style="margin:6px 0 0;">ç´¯ç©æŠ½çï¼š{{ lotterySpinCount }} æ¬¡ï½œå¯¶ç®±ï¼š{{ lotteryChestCount }}</div>
              </div>
              <div class="gacha-stars" aria-hidden="true">
                <div class="gacha-star"></div>
                <div class="gacha-star"></div>
                <div class="gacha-star"></div>
              </div>
            </div>
          </div>

          <div class="hint" style="margin-top:10px;" v-if="lastLotteryResult">æœ¬æ¬¡çµæœï¼š<b style="color: var(--glow-cyan);">{{ lastLotteryResult }}</b></div>
        </div>

        <div class="lobby-card">
          <h3>ğŸ§¾ æŠ½çç´€éŒ„</h3>
          <div class="hint">æœ€è¿‘ 20 ç­†</div>
          <ul class="history">
            <li v-if="lotteryHistory.length===0">ï¼ˆå°šç„¡ç´€éŒ„ï¼‰</li>
            <li v-for="(item,idx) in lotteryHistory" :key="idx">{{ item }}</li>
          </ul>
          <div class="form-row">
            <div></div>
            <button class="mini-btn" @click="clearLotteryHistory" :disabled="lotteryHistory.length===0">æ¸…ç©ºç´€éŒ„</button>
          </div>
        </div>

        <div class="lobby-card">
          <h3>ğŸ·ï¸ ç¨±è™Ÿç³»çµ±</h3>
          <div class="hint">
            ä½ å¯ä»¥å•Ÿç”¨ä¸€å€‹ç¨±è™Ÿç²å¾—åŠ æˆã€‚æŠ½åˆ°ç¨±è™Ÿæœƒè‡ªå‹•åŠ å…¥æ”¶è—ã€‚
          </div>
          <div class="hint" style="margin-top:10px;">ç›®å‰å•Ÿç”¨ï¼š<b style="color: var(--glow-gold);">{{ activeTitle || 'ï¼ˆæœªå•Ÿç”¨ï¼‰' }}</b></div>
          <div class="form-row" style="margin-top:10px;">
            <select class="input" v-model="activeTitle" :disabled="ownedTitles.length===0" style="min-height: 44px;">
              <option value="">ï¼ˆæœªå•Ÿç”¨ï¼‰</option>
              <option v-for="t in ownedTitles" :key="t" :value="t">{{ t }}</option>
            </select>
            <button class="mini-btn" @click="saveTitles" :disabled="ownedTitles.length===0">ä¿å­˜</button>
          </div>
          <div class="hint" style="margin-top:10px;" v-if="activeTitle">
            åŠ æˆï¼š<b style="color: var(--glow-cyan);">{{ titleBonusText }}</b>
          </div>
          <div class="hint" style="margin-top:10px;">å·²æ“æœ‰ï¼š{{ ownedTitles.length ? ownedTitles.join('ã€') : 'ï¼ˆå°šç„¡ï¼‰' }}</div>
        </div>
      </div>

      <!-- éŠæˆ²å¡ç‰‡ -->
      <div class="games-grid">
                 <!-- Little Fox - Word Melody -->
        <div class="game-card" :class="{ locked: !canPlayWordMelody }" @click="openWordMelody">
          <div class="game-icon">ğŸµ</div>
          <div class="game-title">Word Melody</div>
          <div class="game-subtitle">Little Fox è‹±æ–‡éŠæˆ²</div>
          <div class="game-description">
            é€£åˆ° Little Fox çš„ Word Melody éŠæˆ²é é¢ã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">å¤–éƒ¨ç¶²ç«™éŠæˆ²ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">é©åˆç·´ç¿’è‹±æ–‡å–®å­—èˆ‡è½åŠ›</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>

          <div class="guide">
            <div class="guide-title">
              <div class="hint" style="margin:0;">ç©æ³•è§£èªªï¼ˆè·Ÿåœ–ç‰‡æ•™å­¸åŒé¢¨æ ¼ï¼‰</div>
              <button class="mini-btn" @click.stop="toggleWordMelodyGuide">{{ showWordMelodyGuide ? 'æ”¶åˆ' : 'å±•é–‹' }}</button>
            </div>
            <ul class="guide-steps" v-if="showWordMelodyGuide">
              <li class="guide-step">
                <div class="step-badge">1</div>
                <div class="step-text">
                  åˆ° <b>My Stage</b> å¯ä»¥æŸ¥çœ‹æ¯å€‹é—œå¡ï¼ˆStageï¼‰çš„é€²åº¦ï¼›å®Œæˆæ‰€æœ‰ Stage å¾Œä¹Ÿèƒ½åœ¨çç‹€/çå‹µå€æŸ¥çœ‹æˆæœã€‚
                </div>
              </li>
              <li class="guide-step">
                <div class="step-badge">2</div>
                <div class="step-text">
                  æ¯å€‹ Stage åˆ†å…©ç¨®ï¼š<b>Practice</b>ï¼ˆç·´ç¿’ï¼‰èˆ‡ <b>Game</b>ï¼ˆæŒ‘æˆ°ï¼‰ã€‚æƒ³é—–é—œå°±é¸ Gameï¼Œé€šå¸¸è¦å®Œæˆ Play 1 æ‰èƒ½é€²ä¸‹ä¸€å€‹ Playã€‚
                </div>
              </li>
              <li class="guide-step">
                <div class="step-badge">3</div>
                <div class="step-text">
                  éŠæˆ²ä¸­æœƒå‡ºç¾æ³¡æ³¡é¡Œï¼šåœ¨æ™‚é–“å…§ä¾æç¤ºï¼ˆå­—æ¯å/ç™¼éŸ³/å–®å­—ï¼‰æ‰¾å‡ºå°æ‡‰çš„æ³¡æ³¡ä¸¦é»ç ´ï¼Œé€Ÿåº¦è¶Šå¿«è¶Šå®¹æ˜“æ‹¿é«˜åˆ†ã€‚
                </div>
              </li>
              <li class="guide-step">
                <div class="step-badge">4</div>
                <div class="step-text">
                  é€£çºŒç­”å°æœƒæœ‰ <b>Bonus</b> åŠ æˆï¼›ç­”éŒ¯æœƒæ‰£åˆ†ã€‚å»ºè­°å…ˆåš Practice ç†Ÿæ‚‰å¾Œå†é€² Game è¡åˆ†ã€‚
                </div>
              </li>
              <li class="guide-step">
                <div class="step-badge">5</div>
                <div class="step-text">
                  çµç®—ç•«é¢æœƒé¡¯ç¤º Correct/Incorrect/Bonus ç­‰åˆ†æ•¸çµ„æˆï¼›é» <b>My Result</b> å¯ä»¥æŸ¥çœ‹æ¯é¡Œç­”å°/ç­”éŒ¯çš„ç‹€æ³ã€‚
                </div>
              </li>
            </ul>
          </div>

          <button class="game-button" :class="{ locked: !canPlayWordMelody }" @click.stop="openWordMelody" :disabled="!canPlayWordMelody">
            {{ canPlayWordMelody ? 'é–‹å§‹ Word Melody' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <div class="game-card" :class="{ locked: !canPlayScratchGame }" @click="openScratchGame">
          <div class="game-icon">ğŸ•¹ï¸</div>
          <div class="game-title">Scratch éŠæˆ²</div>
          <div class="game-subtitle">åµŒå…¥å¼å°éŠæˆ²</div>
          <div class="game-description">
            Scratch å¹³å°çš„äº’å‹•éŠæˆ²ï¼Œé»æ“Šå¾Œé–‹å•Ÿæœ¬åœ°åµŒå…¥é é¢é–‹å§‹éŠç©ã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">Scratch åµŒå…¥ï¼ˆåœ¨æ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">æ”¯æ´æ‰‹æ©Ÿ/é›»è…¦è‡ªé©æ‡‰</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayScratchGame }" @click.stop="openScratchGame" :disabled="!canPlayScratchGame">
            {{ canPlayScratchGame ? 'é–‹å§‹ Scratch éŠæˆ²' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <div class="game-card" :class="{ locked: !canPlayScratchCard }" @click="openScratchCard">
          <div class="game-icon">ğŸª™</div>
          <div class="game-title">åˆ®åˆ®æ¨‚</div>
          <div class="game-subtitle">åˆ®é–‹éŠ€æ¼†æŠ½ç</div>
          <div class="game-description">
            åˆ®é–‹éŠ€æ¼†æ­æ›‰çé …ï¼Œæ”¯æ´æ»‘é¼ èˆ‡è§¸æ§ã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">Canvas åˆ®é–‹æ•ˆæœ</div>
            <div class="feature-item">åˆ®åˆ°ä¸€å®šæ¯”ä¾‹è‡ªå‹•æ­æ›‰</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayScratchCard }" @click.stop="openScratchCard" :disabled="!canPlayScratchCard">
            {{ canPlayScratchCard ? 'é–‹å§‹åˆ®åˆ®æ¨‚' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <!-- Little Wheel -->
        <div class="game-card" :class="{ locked: !canPlayLittleWheel }" @click="openLittleWheel">
          <div class="game-icon">ğŸ›</div>
          <div class="game-title">Skywire</div>
          <div class="game-subtitle">å¤æ€ªåˆåˆºæ¿€çš„çºœè»Šé—–é—œ</div>
          <div class="game-description">
            æ“æ§çºœè»Šç©¿è¶Šå±éšªè»Œé“ï¼Œé¿é–‹é™·é˜±èˆ‡æ•µäººï¼ŒæŠŠä¹˜å®¢å®‰å…¨é€åˆ°çµ‚é»ã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">å¤–éƒ¨ç¶²ç«™éŠæˆ²ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">åæ‡‰èˆ‡æ“ä½œæŒ‘æˆ°</div>
            <div class="feature-item">èº²é¿é™·é˜±ãƒ»é—–é—œåˆ°çµ‚é»</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayLittleWheel }" @click.stop="openLittleWheel" :disabled="!canPlayLittleWheel">
            {{ canPlayLittleWheel ? 'é–‹å§‹ Skywire' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <!-- Papas Pastaria -->
        <div class="game-card" :class="{ locked: !canPlayPapasPastaria }" @click="openPapasPastaria">
          <div class="game-icon">ğŸ</div>
          <div class="game-title">Papas Pastaria</div>
          <div class="game-subtitle">ç¾©å¤§åˆ©éºµé¤å»³ç¶“ç‡Ÿ</div>
          <div class="game-description">
            ç¶“ç‡Ÿä½ çš„ç¾©å¤§åˆ©éºµé¤å»³ï¼šæ¥å–®ã€ç…®éºµã€åŠ é†¬é…æ–™ä¸¦æº–æ™‚å‡ºé¤ï¼ŒæŒ‘æˆ°ä½ çš„é€Ÿåº¦èˆ‡æ‰‹å¿™è…³äº‚çš„ç®¡ç†èƒ½åŠ›ã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">å¤–éƒ¨ç¶²ç«™éŠæˆ²ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">é¤å»³ç¶“ç‡Ÿï¼‹æ™‚é–“ç®¡ç†</div>
            <div class="feature-item">æ¥å–®ã€çƒ¹é£ªã€æ“ºç›¤ä¸€æ‰‹åŒ…è¾¦</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayPapasPastaria }" @click.stop="openPapasPastaria" :disabled="!canPlayPapasPastaria">
            {{ canPlayPapasPastaria ? 'é–‹å§‹ Papas Pastaria' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <!-- Billiards -->
        <div class="game-card" :class="{ locked: !canPlayBilliards }" @click="openBilliards">
          <div class="game-icon">ğŸ±</div>
          <div class="game-title">Billiards</div>
          <div class="game-subtitle">æ¡Œçƒï¼æ’çƒæŒ‘æˆ°</div>
          <div class="game-description">
            ä¾†ä¸€å±€æ’çƒï¼šç„æº–ã€æ§åˆ¶åŠ›é“èˆ‡è§’åº¦ï¼ŒæŠŠçƒæ‰“é€²æ´ï¼ŒæŒ‘æˆ°ä½ çš„æº–åº¦èˆ‡ç­–ç•¥ã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">å¤–éƒ¨ç¶²ç«™éŠæˆ²ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">ç„æº–èˆ‡åŠ›é“æ§åˆ¶</div>
            <div class="feature-item">ä¼‘é–’å°æˆ°ï¼é—–é—œé¢¨æ ¼</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayBilliards }" @click.stop="openBilliards" :disabled="!canPlayBilliards">
            {{ canPlayBilliards ? 'é–‹å§‹ Billiards' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <!-- Papas Sushiria -->
        <div class="game-card" :class="{ locked: !canPlayPapasSushiria }" @click="openPapasSushiria">
          <div class="game-icon">ğŸ£</div>
          <div class="game-title">Papas Sushiria</div>
          <div class="game-subtitle">å£½å¸åº—ç¶“ç‡Ÿ</div>
          <div class="game-description">
            ç¶“ç‡Ÿä½ çš„å£½å¸åº—ï¼šæ¥å–®ã€æé£¯é…æ–™ã€åˆ‡å·æ“ºç›¤ï¼Œæº–æ™‚æŠŠå£½å¸é€åˆ°å®¢äººæ‰‹ä¸Šã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">å¤–éƒ¨ç¶²ç«™éŠæˆ²ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">é¤å»³ç¶“ç‡Ÿï¼‹æ™‚é–“ç®¡ç†</div>
            <div class="feature-item">è£½ä½œå£½å¸ã€åˆ‡å·ã€æ“ºç›¤å‡ºé¤</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayPapasSushiria }" @click.stop="openPapasSushiria" :disabled="!canPlayPapasSushiria">
            {{ canPlayPapasSushiria ? 'é–‹å§‹ Papas Sushiria' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <!-- Bloom Defender -->
        <div class="game-card" :class="{ locked: !canPlayBloomDefender }" @click="openBloomDefender">
          <div class="game-icon">ğŸŒ¸</div>
          <div class="game-title">Bloom Defender</div>
          <div class="game-subtitle">èŠ±åœ’å¡”é˜²å®ˆè­·æˆ°</div>
          <div class="game-description">
            èŠ±åœ’å¡”é˜²éŠæˆ²ï¼šé…ç½®é˜²ç¦¦ã€å‡ç´šç«åŠ›ï¼Œå®ˆä½ä¸€æ³¢æ³¢æ•µäººã€‚
          </div>
          <div class="game-features">
            <div class="feature-item">å¤–éƒ¨ç¶²ç«™éŠæˆ²ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">å¡”é˜²ç­–ç•¥ï¼‹å‡ç´šå¼·åŒ–</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayBloomDefender }" @click.stop="openBloomDefender" :disabled="!canPlayBloomDefender">
            {{ canPlayBloomDefender ? 'é–‹å§‹ Bloom Defender' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <!-- Stealing the Diamond -->
        <div class="game-card" :class="{ locked: !canPlayStealingTheDiamond }" @click="openStealingTheDiamond">
          <div class="game-icon">ğŸ’</div>
          <div class="game-title">Stealing the Diamond</div>
          <div class="game-subtitle">çˆ†ç¬‘äº’å‹•å¼é¸æ“‡åŠ‡æƒ…</div>
          <div class="game-description">
            é¸æ“‡ä½ çš„è¡Œå‹•è·¯ç·šï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æˆåŠŸå·èµ°é‘½çŸ³ï¼ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰
          </div>
          <div class="game-features">
            <div class="feature-item">å¤–éƒ¨ç¶²ç«™éŠæˆ²ï¼ˆæ–°åˆ†é é–‹å•Ÿï¼‰</div>
            <div class="feature-item">é¸æ“‡åˆ†æ”¯ãƒ»å¤šç¨®çµå±€</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayStealingTheDiamond }" @click.stop="openStealingTheDiamond" :disabled="!canPlayStealingTheDiamond">
            {{ canPlayStealingTheDiamond ? 'é–‹å§‹ Stealing the Diamond' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

                 <!-- æ‹‰éœ¸æ©ŸéŠæˆ² -->
         <div class="game-card" :class="{ locked: !canPlaySlotMachine }" @click="toggleSlotMachine">
           <div class="game-icon">ğŸ°</div>
           <div class="game-title">æ‹‰éœ¸æ©ŸéŠæˆ²</div>
           <div class="game-subtitle">ç¶“å…¸ä¸‰é€£ç·šéŠæˆ²</div>
           <div class="game-description">
             ç¶“å…¸çš„æ‹‰éœ¸æ©ŸéŠæˆ²ï¼Œè½‰å‹•æ‹‰éœ¸æ©Ÿç²å¾—ä¸‰å€‹ç›¸åŒåœ–æ¡ˆå³å¯ç²å‹ã€‚
             éŠæˆ²åŒ…å«è¯éº—çš„è¦–è¦ºæ•ˆæœå’Œå‹•ç•«ï¼Œè®“æ‚¨é«”é©—çœŸæ­£çš„æ‹‰éœ¸æ©Ÿæ¨‚è¶£ã€‚
           </div>
           <div class="game-features">
             <div class="feature-item">ç¶“å…¸æ‹‰éœ¸æ©Ÿç©æ³•</div>
             <div class="feature-item">ä¸‰é€£ç·šç²å‹æ©Ÿåˆ¶</div>
             <div class="feature-item">è¯éº—è¦–è¦ºæ•ˆæœ</div>
             <div class="feature-item">å‹•æ…‹å‹•ç•«æ•ˆæœ</div>
             <div class="feature-item">åˆ†æ•¸çµ±è¨ˆç³»çµ±</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
           </div>
           <button class="game-button" :class="{ locked: !canPlaySlotMachine }" @click.stop="toggleSlotMachine" :disabled="!canPlaySlotMachine">
            {{ canPlaySlotMachine ? 'é–‹å§‹æ‹‰éœ¸æ©ŸéŠæˆ²' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>

        <!-- å¡ç‰Œå°æˆ° -->
        <div class="game-card" :class="{ locked: !canPlayBattleSystem }" @click="openBattleSystem">
          <div class="game-icon">âš”ï¸</div>
          <div class="game-title">å¡ç‰Œå°æˆ°ç³»çµ±</div>
          <div class="game-subtitle">å²è©©ç´šå¡ç‰Œæˆ°é¬¥</div>
          <div class="game-description">
            å®Œæ•´çš„å¡ç‰Œå°æˆ°ç³»çµ±ï¼ŒåŒ…å«æ”»æ“Šã€é˜²ç¦¦ã€ç‰¹æ®ŠæŠ€èƒ½ç­‰å¤šç¨®æˆ°é¬¥æ©Ÿåˆ¶ã€‚
            æ”¶é›†å¼·å¤§å¡ç‰Œï¼Œçµ„å»ºä½ çš„ç‰Œçµ„ï¼Œåœ¨æ¿€çƒˆçš„å°æˆ°ä¸­è­‰æ˜ä½ çš„å¯¦åŠ›ï¼
          </div>
          <div class="game-features">
            <div class="feature-item">å®Œæ•´æˆ°é¬¥ç³»çµ±</div>
            <div class="feature-item">å¤šç¨®å¡ç‰Œé¡å‹</div>
            <div class="feature-item">ç‰¹æ®ŠæŠ€èƒ½æ•ˆæœ</div>
            <div class="feature-item">å‹•æ…‹æˆ°é¬¥å‹•ç•«</div>
            <div class="feature-item">ç‰Œçµ„ç®¡ç†ç³»çµ±</div>
            <div class="feature-item" style="color: var(--glow-gold); font-weight: bold;">ğŸª™ éš¨æ©Ÿæ¶ˆè€— 300 / 500 / 1000 é‡‘å¹£ / æ¯æ¬¡</div>
          </div>
          <button class="game-button" :class="{ locked: !canPlayBattleSystem }" @click.stop="openBattleSystem" :disabled="!canPlayBattleSystem">
            {{ canPlayBattleSystem ? 'é–‹å§‹å¡ç‰Œå°æˆ°' : `éœ€è¦è‡³å°‘ ${gameCoinCostMax} é‡‘å¹£` }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- éŸ³æ•ˆæ§åˆ¶ -->
  <div id="audioControls">
    <button id="toggleMusic" title="èƒŒæ™¯éŸ³æ¨‚">
      <span class="material-icons">music_note</span>
    </button>
  </div>

  <!-- éŸ³æ•ˆå…ƒç´  -->
  <audio id="typingSound" preload="auto">
    <source src="sound/type.mp3" type="audio/mpeg">
  </audio>

  <audio id="gachaCoinSfx" preload="auto">
    <source src="sound/click.mp3" type="audio/mpeg">
  </audio>

  <audio id="gachaSpinSfx" preload="auto">
    <source src="sound/clock-ticking-sound.mp3" type="audio/mpeg">
  </audio>

  <audio id="gachaOpenSfx" preload="auto">
    <source src="sound/shine-7-268909.mp3" type="audio/mpeg">
  </audio>

  <audio id="chestOpenSfx" preload="auto">
    <source src="sound/unlock.mp3" type="audio/mpeg">
  </audio>

  <audio id="jackpotSfx" preload="auto">
    <source src="sound/winning-82808.mp3" type="audio/mpeg">
  </audio>

  <audio id="backgroundMusic" loop>
    <source src="sound/åˆå¾Œæ”¾é¬†æ™‚å…‰ï¼ˆç´”éŸ³æ¨‚ï¼‰.mp3" type="audio/mpeg">
  </audio>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          totalGames: 10,
          availableGames: 10,
          completedGames: 0,
          totalStars: 0,
          goldCoins: 0,
          playerLevel: 1,
          gameCoinCostOptions: [300, 500, 1000],
          gameCoinCostMax: 1000,
          showWordMelodyGuide: false,
          exchangeRate: 1,
          exchangeCoinsPerRate: 10,
          exchangeStarsAmount: 1,
          lotteryCost: 50,
          lastLotteryResult: '',
          lotteryHistory: [],
          gachaAnimating: false,
          gachaPhase: '',
          showLotteryModal: false,
          lotteryModalText: '',
          lotteryModalBonusText: '',
          jackpotActive: false,
          jackpotText: '',
          ownedTitles: [],
          activeTitle: '',
          lastSpinCost: 0,
          lotterySpinCount: 0,
          lotteryChestCount: 0,
          starsAnimation: false, // æ˜Ÿæ˜Ÿå‹•ç•«ç‹€æ…‹
          // æ–°å¢æ˜Ÿæ˜Ÿç³»çµ±ç›¸é—œæ•¸æ“š
          starsEarned: 0, // æœ¬å±€ç²å¾—çš„æ˜Ÿæ˜Ÿ
          totalStarsEarned: 0, // ç¸½å…±ç²å¾—çš„æ˜Ÿæ˜Ÿ
          starsSpent: 0, // èŠ±è²»çš„æ˜Ÿæ˜Ÿ
          achievements: [], // æˆå°±åˆ—è¡¨
          levelProgress: 0, // ç­‰ç´šé€²åº¦
          nextLevelStars: 100 // ä¸‹ä¸€ç­‰ç´šéœ€è¦çš„æ˜Ÿæ˜Ÿ
        }
      },
      computed: {
        completionRate() {
          return Math.round((this.completedGames / this.totalGames) * 100);
        },
        canPlaySlotMachine() {
           return this.goldCoins >= this.gameCoinCostMax;
         },
        canPlayBattleSystem() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayScratchGame() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayScratchCard() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayWordMelody() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayLittleWheel() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayPapasPastaria() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayBilliards() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayPapasSushiria() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayBloomDefender() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        canPlayStealingTheDiamond() {
          return this.goldCoins >= this.gameCoinCostMax;
        },
        previewCoins() {
          const stars = Math.max(0, Math.floor(Number(this.exchangeStarsAmount) || 0));
          if (!stars) { return 0; }
          const perStar = this.exchangeCoinsPerRate / this.exchangeRate;
          return Math.floor(stars * perStar);
        },
        effectiveLotteryCost() {
          const base = Math.max(1, Math.floor(Number(this.lotteryCost) || 1));
          if (this.activeTitle === 'è½‰è›‹ä¹‹ç‹') { return Math.max(1, base - 10); }
          if (this.activeTitle === 'çœéŒ¢é”äºº') { return Math.max(1, base - 5); }
          return base;
        },
        titleBonusText() {
          const t = this.activeTitle;
          if (!t) { return 'ç„¡'; }
          if (t === 'æ–°æ‰‹å†’éšªå®¶') { return 'æ¯æ¬¡æŠ½çé¡å¤– +ğŸª™ 5ï¼ˆå°è£œè²¼ï¼‰'; }
          if (t === 'å¹¸é‹ç©å®¶') { return 'æŠ½åˆ°é‡‘å¹£/æ˜Ÿæ˜Ÿæ™‚ç•¥ç‚ºåŠ æˆï¼ˆå°å¹…æå‡ï¼‰'; }
          if (t === 'é–ƒè€€ä¹‹æ˜Ÿ') { return 'æŠ½åˆ°æ˜Ÿæ˜Ÿæ™‚é¡å¤– +â­ 1ï¼ˆå«é–‹å¯¶ç®±ï¼‰'; }
          if (t === 'è½‰è›‹ä¹‹ç‹') { return 'æŠ½çè²»ç”¨ -ğŸª™ 10'; }
          if (t === 'å‚³èªªæ”¶è—å®¶') { return 'é–‹å¯¶ç®±çå‹µæå‡ï¼ˆå¤§é‡‘å¹£/å¤§æ˜Ÿæ˜Ÿæ›´å®¹æ˜“è§¸ç™¼å¤§çï¼‰'; }
          if (t === 'å¯¶ç®±çµäºº') { return 'æŠ½çæ›´å®¹æ˜“æŠ½åˆ°å¯¶ç®±ï¼ˆ+æ©Ÿç‡ï¼‰'; }
          if (t === 'é‡‘å¹£å¯Œç¿') { return 'æŠ½åˆ°é‡‘å¹£å›é¥‹æ™‚å†é¡å¤– +ğŸª™ 20%'; }
          if (t === 'æ˜Ÿæ˜Ÿå®ˆè­·è€…') { return 'æŠ½åˆ°æ˜Ÿæ˜Ÿæ™‚å†é¡å¤– +â­ 1ï¼ˆä¸å«é–‹å¯¶ç®±ï¼‰'; }
          if (t === 'çœéŒ¢é”äºº') { return 'æŠ½çè²»ç”¨ -ğŸª™ 5'; }
          if (t === 'é€£å‹ä¹‹æ‰‹') { return 'æŠ½åˆ°å¯¶ç®±æ™‚æœ‰æ©Ÿæœƒè®Šæˆ x2'; }
          return 'ç‰¹æ®ŠåŠ æˆ';
        },
        lotteryHistoryParsed() {
          const rows = Array.isArray(this.lotteryHistory) ? this.lotteryHistory : [];
          return rows.map((line) => {
            const s = String(line || '');
            const m = s.match(/^\[(.*?)\]\s*(.*?)(?:ï¼ˆæ¶ˆè€—\s*ğŸª™\s*(\d+)ï¼‰)?$/);
            const time = m ? (m[1] || '') : '';
            const text = m ? (m[2] || s) : s;
            const cost = m && m[3] ? Number(m[3]) : this.effectiveLotteryCost;
            return { time, text, cost };
          });
        },
        // æ–°å¢æ˜Ÿæ˜Ÿç³»çµ±è¨ˆç®—å±¬æ€§
        levelProgressPercentage() {
          return Math.round((this.totalStars % this.nextLevelStars) / this.nextLevelStars * 100);
        },
        canLevelUp() {
          return this.totalStars >= this.nextLevelStars;
        },
        starsEfficiency() {
          return this.totalStarsEarned > 0 ? Math.round((this.totalStars / this.totalStarsEarned) * 100) : 0;
        }
      },
      methods: {
                 toggleWordMelodyGuide() {
           this.showWordMelodyGuide = !this.showWordMelodyGuide;
         },
                 spendRandomGameCoins() {
           const maxCost = Math.max(0, Math.floor(Number(this.gameCoinCostMax) || 0));
           if (this.goldCoins < maxCost) { return null; }
           const options = Array.isArray(this.gameCoinCostOptions) ? this.gameCoinCostOptions : [];
           const safeOptions = options.map(v => Math.floor(Number(v) || 0)).filter(v => v > 0);
           if (safeOptions.length === 0) { return null; }
           const cost = safeOptions[Math.floor(Math.random() * safeOptions.length)];
           this.goldCoins -= cost;
           this.saveEconomyData();
           this.triggerStarsAnimation();
           return cost;
         },
                 trySpendCoins(amount) {
           const cost = Math.max(0, Math.floor(Number(amount) || 0));
           if (!cost) { return true; }
           if (this.goldCoins < cost) { return false; }
           this.goldCoins -= cost;
           this.saveEconomyData();
           this.triggerStarsAnimation();
           return true;
         },
                 openWordMelody() {
           const spent = this.spendRandomGameCoins();
           if (spent === null) {
             alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Word Melodyã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
             return;
           }
           alert(`ğŸµ é–‹å§‹éŠç© Word Melodyï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
           window.open('https://www.littlefox.com/tw/games/word_melody', '_blank');
         },
        openScratchGame() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Scratch éŠæˆ²ã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸ•¹ï¸ é–‹å§‹éŠç© Scratch éŠæˆ²ï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          this.openGame('scratch_game.html');
        },
        openScratchCard() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç©åˆ®åˆ®æ¨‚ã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸª™ é–‹å§‹éŠç©åˆ®åˆ®æ¨‚ï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          this.openGame('scratch_card.html');
        },
        openLittleWheel() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Little Wheelã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸ› é–‹å§‹éŠç© Little Wheelï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          window.open('https://omiplay.com/zh/games/little-wheel/', '_blank');
        },
        openPapasPastaria() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Papas Pastariaã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸ é–‹å§‹éŠç© Papas Pastariaï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          window.open('https://omiplay.com/zh/games/play-papas-pastaria-online/', '_blank');
        },
        openBilliards() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Billiardsã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸ± é–‹å§‹éŠç© Billiardsï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          window.open('https://omiplay.com/zh/games/billiards/', '_blank');
        },
        openPapasSushiria() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Papas Sushiriaã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸ£ é–‹å§‹éŠç© Papas Sushiriaï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          window.open('https://omiplay.com/zh/games/papas-sushiria/', '_blank');
        },
        openBloomDefender() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Bloom Defenderã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸŒ¸ é–‹å§‹éŠç© Bloom Defenderï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          window.open('https://omiplay.com/zh/games/bloom-defender/', '_blank');
        },
        openStealingTheDiamond() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç© Stealing the Diamondã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`ğŸ’ é–‹å§‹éŠç© Stealing the Diamondï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          window.open('https://omiplay.com/zh/games/stealing-the-diamond/', '_blank');
        },
        openBattleSystem() {
          const spent = this.spendRandomGameCoins();
          if (spent === null) {
            alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç©å¡ç‰Œå°æˆ°ç³»çµ±ã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins}`);
            return;
          }
          alert(`âš”ï¸ é–‹å§‹éŠç©å¡ç‰Œå°æˆ°ç³»çµ±ï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent}\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins}`);
          this.openGame('battle_system.html');
        },
        loadEconomyData() {
          const coins = parseInt(localStorage.getItem('goldCoins') || '0', 10);
          this.goldCoins = Number.isFinite(coins) ? coins : 0;

          const spinCount = parseInt(localStorage.getItem('lotterySpinCount_v1') || '0', 10);
          this.lotterySpinCount = Number.isFinite(spinCount) ? spinCount : 0;
          const chestCount = parseInt(localStorage.getItem('lotteryChestCount_v1') || '0', 10);
          this.lotteryChestCount = Number.isFinite(chestCount) ? chestCount : 0;

          try {
            const raw = localStorage.getItem('lotteryHistory_v1');
            const parsed = raw ? JSON.parse(raw) : [];
            this.lotteryHistory = Array.isArray(parsed) ? parsed : [];
          } catch (e) {
            this.lotteryHistory = [];
          }
        },
        loadTitles() {
          try {
            const raw = localStorage.getItem('ownedTitles_v1');
            const parsed = raw ? JSON.parse(raw) : [];
            this.ownedTitles = Array.isArray(parsed) ? parsed.filter(Boolean) : [];
          } catch (e) {
            this.ownedTitles = [];
          }
          const active = localStorage.getItem('activeTitle_v1') || '';
          this.activeTitle = active;
        },
        saveEconomyData() {
          localStorage.setItem('goldCoins', String(this.goldCoins));
          localStorage.setItem('lotteryHistory_v1', JSON.stringify(this.lotteryHistory));
          localStorage.setItem('lotterySpinCount_v1', String(this.lotterySpinCount));
          localStorage.setItem('lotteryChestCount_v1', String(this.lotteryChestCount));
        },
        saveTitles() {
          localStorage.setItem('ownedTitles_v1', JSON.stringify(this.ownedTitles));
          localStorage.setItem('activeTitle_v1', String(this.activeTitle || ''));
        },
        unlockTitle(title) {
          const t = String(title || '').trim();
          if (!t) { return; }
          if (!this.ownedTitles.includes(t)) {
            this.ownedTitles.push(t);
            this.saveTitles();
            const time = new Date().toLocaleString();
            this.lotteryHistory.unshift(`[${time}] ğŸ·ï¸ è§£é–ç¨±è™Ÿï¼š${t}`);
            this.lotteryHistory = this.lotteryHistory.slice(0, 20);
            this.saveEconomyData();
          }
          if (!this.activeTitle) {
            this.activeTitle = t;
            this.saveTitles();
          }
        },
        exchangeStarsForCoins() {
          const stars = Math.max(0, Math.floor(Number(this.exchangeStarsAmount) || 0));
          if (!stars) { return; }
          if (this.totalStars < stars) {
            alert('âŒ æ˜Ÿæ˜Ÿä¸è¶³ï¼Œç„¡æ³•å…Œæ›');
            return;
          }
          const coinsToGet = this.previewCoins;
          if (coinsToGet <= 0) {
            alert('âŒ å…Œæ›æ•¸é‡å¤ªå°');
            return;
          }

          this.totalStars -= stars;
          this.goldCoins += coinsToGet;
          this.starsSpent += stars;

          localStorage.setItem('totalStars', this.totalStars.toString());
          this.savePlayerData();
          this.saveEconomyData();
          this.triggerStarsAnimation();

          alert(`âœ… å…Œæ›æˆåŠŸï¼\n\nä½¿ç”¨æ˜Ÿæ˜Ÿï¼šâ­ ${stars}\nç²å¾—é‡‘å¹£ï¼šğŸª™ ${coinsToGet}\n\nç›®å‰æ˜Ÿæ˜Ÿï¼šâ­ ${this.totalStars}\nç›®å‰é‡‘å¹£ï¼šğŸª™ ${this.goldCoins}`);
        },
        startGacha() {
          if (this.gachaAnimating) { return; }
          if (this.goldCoins < this.effectiveLotteryCost) {
            alert('âŒ é‡‘å¹£ä¸è¶³ï¼Œç„¡æ³•æŠ½ç');
            return;
          }

          this.gachaAnimating = true;
          this.gachaPhase = 'sparkle';

          this.playSfx('gachaCoinSfx', 0.20);

          window.setTimeout(() => {
            this.gachaPhase = 'coin';
            this.lastSpinCost = this.effectiveLotteryCost;
            this.goldCoins -= this.lastSpinCost;
            this.saveEconomyData();
            this.playSfx('gachaCoinSfx', 0.25);
          }, 250);

          window.setTimeout(() => {
            this.gachaPhase = 'spin';
            this.playSfx('gachaSpinSfx', 0.12);
          }, 720);

          window.setTimeout(() => {
            this.gachaPhase = 'open';
            this.playSfx('gachaOpenSfx', 0.18);
          }, 1400);

          window.setTimeout(() => {
            this.applyLotteryRoll();
            this.gachaAnimating = false;
            this.gachaPhase = '';
          }, 2050);
        },
        spinLottery() {
          this.startGacha();
        },
        applyLotteryRoll() {
          const roll = Math.random();
          let resultText = '';
          this.lotteryModalBonusText = '';
          const costUsed = Math.max(1, Math.floor(Number(this.lastSpinCost) || this.effectiveLotteryCost));

          const chestBoost = this.activeTitle === 'å¯¶ç®±çµäºº' ? 0.06 : 0;
          const coinBoostRatio = this.activeTitle === 'é‡‘å¹£å¯Œç¿' ? 0.20 : 0;
          const starExtra = (this.activeTitle === 'é–ƒè€€ä¹‹æ˜Ÿ' ? 1 : 0) + (this.activeTitle === 'æ˜Ÿæ˜Ÿå®ˆè­·è€…' ? 1 : 0);

          // å£çå‹µæ©Ÿç‡ï¼š12%ï¼ˆé¿å…è¶ŠæŠ½è¶Šå¯Œï¼‰
          const badCut = 0.12;

          // çæ± ï¼šé‡‘å¹£ / æ˜Ÿæ˜Ÿ / å¯¶ç®± / ç¨±è™Ÿ
          // åŸºæœ¬æ©Ÿç‡ï¼šå£çå‹µ 12% / é‡‘å¹£ 33% / æ˜Ÿæ˜Ÿ 25% / å¯¶ç®± 10% / ç¨±è™Ÿ 20%
          // å¯¶ç®±çµäººæœƒæŠŠéƒ¨åˆ†æ©Ÿç‡æŒªåˆ°å¯¶ç®±ï¼ˆå¾é‡‘å¹£/æ˜Ÿæ˜Ÿå„æ‰£ä¸€äº›ï¼‰
          const effectiveChestBoost = Math.min(0.05, Math.max(0, chestBoost));
          const coinCut = badCut + (0.33 - (effectiveChestBoost * 0.5));
          const starCut = coinCut + (0.25 - (effectiveChestBoost * 0.5));
          const chestCut = starCut + (0.10 + effectiveChestBoost);

          if (roll < badCut) {
            const badRoll = Math.random();
            if (badRoll < 0.45) {
              const lose = 20 + Math.floor(Math.random() * 61); // 20~80
              const actual = Math.min(this.goldCoins, lose);
              this.goldCoins = Math.max(0, this.goldCoins - actual);
              resultText = `ğŸ’¥ å£çå‹µï¼šğŸª™ é‡‘å¹£ -${actual}`;
            } else if (badRoll < 0.85) {
              const loseStars = 1 + Math.floor(Math.random() * 2); // 1~2
              const actual = Math.min(this.totalStars, loseStars);
              this.totalStars = Math.max(0, this.totalStars - actual);
              localStorage.setItem('totalStars', this.totalStars.toString());
              this.savePlayerData();
              resultText = `ğŸ’¥ å£çå‹µï¼šâ­ æ˜Ÿæ˜Ÿ -${actual}`;
            } else {
              resultText = 'ğŸ’¨ å£çå‹µï¼šç©ºè½‰ï¼ˆæ²’æœ‰ç²å¾—ä»»ä½•æ±è¥¿ï¼‰';
            }
          } else if (roll < coinCut) {
            const coinsBack = Math.floor(10 + Math.random() * 90); // 10~99
            let add = coinsBack;
            if (this.activeTitle === 'å¹¸é‹ç©å®¶') { add += 8; }
            if (this.activeTitle === 'æ–°æ‰‹å†’éšªå®¶') { add += 5; }
            if (coinBoostRatio > 0) { add += Math.max(1, Math.floor(coinsBack * coinBoostRatio)); }
            this.goldCoins += add;
            resultText = `ğŸ‰ é‡‘å¹£å›é¥‹ +${coinsBack}`;

            if (coinsBack >= 90) {
              this.triggerJackpot('é‡‘å¹£å›é¥‹');
            }
          } else if (roll < starCut) {
            const stars = 1 + Math.floor(Math.random() * 3); // 1~3
            let addStars = stars;
            if (this.activeTitle === 'å¹¸é‹ç©å®¶' && stars >= 2) { addStars += 1; }
            if (starExtra > 0) { addStars += starExtra; }
            this.totalStars += addStars;
            this.totalStarsEarned += addStars;
            resultText = `â­ æ˜Ÿæ˜Ÿçå‹µ +${stars}`;

            if (stars >= 3) {
              this.triggerJackpot('æ˜Ÿæ˜Ÿå¤§ç');
            }
          } else if (roll < chestCut) {
            let chestAdd = 1;
            if (this.activeTitle === 'é€£å‹ä¹‹æ‰‹' && Math.random() < 0.25) { chestAdd = 2; }
            this.lotteryChestCount += chestAdd;
            resultText = `ğŸ å¯¶ç®± +${chestAdd}`;
            if (chestAdd >= 2) {
              this.triggerJackpot('å¯¶ç®± x2');
            }
          } else {
            const titles = [
              'æ–°æ‰‹å†’éšªå®¶',
              'å¹¸é‹ç©å®¶',
              'é–ƒè€€ä¹‹æ˜Ÿ',
              'è½‰è›‹ä¹‹ç‹',
              'å‚³èªªæ”¶è—å®¶',
              'å¯¶ç®±çµäºº',
              'é‡‘å¹£å¯Œç¿',
              'æ˜Ÿæ˜Ÿå®ˆè­·è€…',
              'çœéŒ¢é”äºº',
              'é€£å‹ä¹‹æ‰‹'
            ];
            const t = titles[Math.floor(Math.random() * titles.length)];
            resultText = `ğŸ·ï¸ ç¨±è™Ÿï¼š${t}`;
            this.unlockTitle(t);

            if (t === 'è½‰è›‹ä¹‹ç‹' || t === 'å‚³èªªæ”¶è—å®¶' || t === 'é‡‘å¹£å¯Œç¿' || t === 'å¯¶ç®±çµäºº') {
              this.triggerJackpot('ç¨€æœ‰ç¨±è™Ÿ');
            }
          }

          const time = new Date().toLocaleString();
          this.lotterySpinCount += 1;

          const bonuses = [];
          if (this.lotterySpinCount % 5 === 0) {
            this.lotteryChestCount += 1;
            bonuses.push('ğŸ å¯¶ç®± x1');
          }

          const bonusSuffix = bonuses.length ? `ï½œ${bonuses.join(' ')}` : '';
          const finalText = `${resultText}${bonusSuffix}`;
          const log = `[${time}] ${finalText}ï¼ˆæ¶ˆè€— ğŸª™ ${costUsed}ï¼‰`;
          this.lastLotteryResult = finalText;
          this.lotteryHistory.unshift(log);
          this.lotteryHistory = this.lotteryHistory.slice(0, 20);
          this.saveEconomyData();
          this.triggerStarsAnimation();

          this.lotteryModalText = resultText;
          this.lotteryModalBonusText = bonuses.join(' ');
          this.showLotteryModal = true;
        },
        closeLotteryModal() {
          this.showLotteryModal = false;
          this.jackpotActive = false;
        },
        triggerJackpot(label) {
          this.jackpotText = label || '';
          this.jackpotActive = true;
          this.playSfx('jackpotSfx', 0.24);
          window.setTimeout(() => {
            this.jackpotActive = false;
          }, 1800);
        },
        openChest() {
          if (this.lotteryChestCount <= 0) {
            alert('ç›®å‰æ²’æœ‰å¯¶ç®±å¯é–‹å•Ÿ');
            return;
          }

          this.lotteryChestCount -= 1;
          this.playSfx('chestOpenSfx', 0.22);

          const roll = Math.random();
          let rewardText = '';

          if (roll < 0.45) {
            const coins = 30 + Math.floor(Math.random() * 91); // 30~120
            let addCoins = coins;
            if (this.activeTitle === 'å‚³èªªæ”¶è—å®¶') { addCoins = Math.floor(addCoins * 1.15); }
            this.goldCoins += addCoins;
            rewardText = `ğŸ§° é–‹å•Ÿå¯¶ç®±ï¼šğŸª™ é‡‘å¹£ +${coins}`;
            this.saveEconomyData();

            if (coins >= 110) {
              this.triggerJackpot('å¯¶ç®±é‡‘å¹£å¤§ç');
            }
          } else if (roll < 0.85) {
            const stars = 1 + Math.floor(Math.random() * 3); // 1~3
            let addStars = stars;
            if (this.activeTitle === 'é–ƒè€€ä¹‹æ˜Ÿ') { addStars += 1; }
            if (this.activeTitle === 'å‚³èªªæ”¶è—å®¶' && stars >= 4) { addStars += 1; }
            this.totalStars += addStars;
            this.totalStarsEarned += addStars;
            localStorage.setItem('totalStars', this.totalStars.toString());
            this.savePlayerData();
            this.saveEconomyData();
            this.triggerStarsAnimation();
            rewardText = `ğŸ§° é–‹å•Ÿå¯¶ç®±ï¼šâ­ æ˜Ÿæ˜Ÿ +${stars}`;

            if (stars >= 3) {
              this.triggerJackpot('å¯¶ç®±æ˜Ÿæ˜Ÿå¤§ç');
            }
          } else if (roll < 0.95) {
            // é¸é … Dï¼šåŸæœ¬çš„æ–‡å­—çå‹µæ”¹æˆã€Œç›´æ¥çµ¦å¯¶ç®±ã€ï¼ˆä½†æ©Ÿç‡ä¸è¦å¤ªé«˜ï¼‰
            this.lotteryChestCount += 1;
            rewardText = 'ğŸ é©šå–œï¼šé¡å¤–å¯¶ç®± +1';
            this.saveEconomyData();
            this.triggerJackpot('é©šå–œå¯¶ç®±');
          } else {
            // å°‘é‡å¤±æ•—çµæœï¼Œé¿å…é–‹å¯¶ç®±æœŸæœ›å€¼éé«˜
            const lose = 10 + Math.floor(Math.random() * 31); // 10~40
            const actual = Math.min(this.goldCoins, lose);
            this.goldCoins = Math.max(0, this.goldCoins - actual);
            rewardText = `ğŸ˜µ å¯¶ç®±é™·é˜±ï¼šğŸª™ é‡‘å¹£ -${actual}`;
            this.saveEconomyData();
          }

          const time = new Date().toLocaleString();
          const log = `[${time}] ${rewardText}`;
          this.lotteryHistory.unshift(log);
          this.lotteryHistory = this.lotteryHistory.slice(0, 20);
          this.saveEconomyData();

          this.lotteryModalText = rewardText;
          this.lotteryModalBonusText = '';
          this.showLotteryModal = true;
        },
        playSfx(audioId, volume) {
          try {
            const el = document.getElementById(audioId);
            if (!el) { return; }
            el.pause();
            el.currentTime = 0;
            el.volume = Math.max(0, Math.min(1, Number(volume) || 0.2));
            const p = el.play();
            if (p && typeof p.catch === 'function') { p.catch(() => {}); }
          } catch (e) {
            // ignore
          }
        },
        clearLotteryHistory() {
          if (!confirm('ç¢ºå®šè¦æ¸…ç©ºæŠ½çç´€éŒ„ï¼Ÿ')) { return; }
          this.lotteryHistory = [];
          this.lastLotteryResult = '';
          this.saveEconomyData();
        },
                 openGame(gamePath) {
           // åœ¨æ–°è¦–çª—ä¸­æ‰“é–‹éŠæˆ²
           window.open(gamePath, '_blank');
           
           // æ¨¡æ“¬éŠæˆ²å®Œæˆç²å¾—æ˜Ÿæ˜Ÿï¼ˆé€™è£¡å¯ä»¥æ ¹æ“šå¯¦éš›éŠæˆ²çµæœèª¿æ•´ï¼‰
           setTimeout(() => {
             const gameNames = {
               'battle_system.html': 'å¡ç‰Œå°æˆ°ç³»çµ±',
             };
             
             const gameName = gameNames[gamePath] || 'éŠæˆ²';
             this.simulateGameCompletion(gameName);
           }, 2000); // 2ç§’å¾Œæ¨¡æ“¬éŠæˆ²å®Œæˆ
         },
        goHome() {
          // è¿”å›é¦–é 
          window.location.href = 'index.html';
        },
        loadPlayerData() {
          // å¾localStorageè®€å–ç©å®¶æ•¸æ“šï¼Œèˆ‡é¦–é ä¿æŒä¸€è‡´
          const totalStars = parseInt(localStorage.getItem('totalStars') || '0');
          this.totalStars = totalStars;
          
          // è®€å–å…¶ä»–ç©å®¶æ•¸æ“š
          const playerData = localStorage.getItem('playerData');
          if (playerData) {
            const data = JSON.parse(playerData);
            this.playerLevel = data.level || 1;
            this.totalStarsEarned = data.totalStarsEarned || 0;
            this.starsSpent = data.starsSpent || 0;
            this.nextLevelStars = data.nextLevelStars || 100;
          } else {
            // å¦‚æœæ²’æœ‰ playerDataï¼Œåˆå§‹åŒ–åŸºæœ¬æ•¸æ“š
            this.playerLevel = 1;
            this.totalStarsEarned = totalStars; // å‡è¨­æ‰€æœ‰æ˜Ÿæ˜Ÿéƒ½æ˜¯ç²å¾—çš„
            this.starsSpent = 0;
            this.nextLevelStars = 100;
          }
          
          // è®€å–éŠæˆ²å®Œæˆç‹€æ…‹
          const gameProgress = localStorage.getItem('gameProgress');
          if (gameProgress) {
            const progress = JSON.parse(gameProgress);
            this.completedGames = progress.completedGames || 0;
          }
        },
        saveGameProgress() {
          // ä¿å­˜éŠæˆ²é€²åº¦
          const progress = {
            completedGames: this.completedGames,
            lastPlayed: new Date().toISOString()
          };
          localStorage.setItem('gameProgress', JSON.stringify(progress));
        },
         toggleSlotMachine() {
           const spent = this.spendRandomGameCoins();
           if (spent === null) {
             alert(`âŒ é‡‘å¹£ä¸è¶³ï¼éœ€è¦è‡³å°‘ ${this.gameCoinCostMax} é‡‘å¹£æ‰èƒ½éŠç©æ‹‰éœ¸æ©ŸéŠæˆ²ã€‚\n\nç›®å‰é‡‘å¹£ï¼š${this.goldCoins} é‡‘å¹£\néœ€è¦é‡‘å¹£ï¼š${this.gameCoinCostMax} é‡‘å¹£`);
             return;
           }
           
           // é¡¯ç¤ºæ‰£é™¤è¨Šæ¯
           alert(`ğŸ° é–‹å§‹éŠç©æ‹‰éœ¸æ©ŸéŠæˆ²ï¼\n\næœ¬æ¬¡æ‰£é™¤é‡‘å¹£ï¼š${spent} é‡‘å¹£\nå‰©é¤˜é‡‘å¹£ï¼š${this.goldCoins} é‡‘å¹£`);
           
           // é–‹å•ŸéŠæˆ²
           window.open('word_spin_game.html', '_blank');
           
           // æ¨¡æ“¬éŠæˆ²å®Œæˆç²å¾—æ˜Ÿæ˜Ÿ
           setTimeout(() => {
             this.simulateGameCompletion('æ‹‰éœ¸æ©ŸéŠæˆ²');
           }, 2000); // 2ç§’å¾Œæ¨¡æ“¬éŠæˆ²å®Œæˆ
         },
        savePlayerData() {
          // ä¿å­˜æ˜Ÿæ˜Ÿåˆ°localStorageï¼Œèˆ‡é¦–é ä¿æŒä¸€è‡´
          localStorage.setItem('totalStars', this.totalStars.toString());
          
          // ä¿å­˜å…¶ä»–ç©å®¶æ•¸æ“šåˆ°localStorage
          const playerData = {
            level: this.playerLevel,
            totalStarsEarned: this.totalStarsEarned,
            starsSpent: this.starsSpent,
            nextLevelStars: this.nextLevelStars,
            lastUpdated: new Date().toISOString()
          };
          localStorage.setItem('playerData', JSON.stringify(playerData));
        },
        triggerStarsAnimation() {
          // è§¸ç™¼æ˜Ÿæ˜Ÿæ›´æ–°å‹•ç•«
          this.starsAnimation = true;
          setTimeout(() => {
            this.starsAnimation = false;
          }, 500);
        },
        // æ–°å¢æ˜Ÿæ˜Ÿç³»çµ±æ–¹æ³•
        earnStars(amount) {
          // ç²å¾—æ˜Ÿæ˜Ÿï¼Œèˆ‡é¦–é ä¿æŒä¸€è‡´
          const currentStars = parseInt(localStorage.getItem('totalStars') || '0');
          const newStars = currentStars + amount;
          
          // æ›´æ–°æœ¬åœ°æ•¸æ“š
          this.totalStars = newStars;
          this.totalStarsEarned += amount;
          this.starsEarned = amount;
          
          // æª¢æŸ¥æ˜¯å¦å¯ä»¥å‡ç´š
          this.checkLevelUp();
          
          // è§¸ç™¼å‹•ç•«
          this.triggerStarsAnimation();
          
          // ä¿å­˜æ•¸æ“š
          this.savePlayerData();
          
          // é¡¯ç¤ºç²å¾—è¨Šæ¯
          this.showStarsEarnedMessage(amount);
        },
        spendStars(amount) {
          // èŠ±è²»æ˜Ÿæ˜Ÿï¼Œèˆ‡é¦–é ä¿æŒä¸€è‡´
          const currentStars = parseInt(localStorage.getItem('totalStars') || '0');
          
          if (currentStars >= amount) {
            const newStars = currentStars - amount;
            
            // æ›´æ–°æœ¬åœ°æ•¸æ“š
            this.totalStars = newStars;
            this.starsSpent += amount;
            
            // è§¸ç™¼å‹•ç•«
            this.triggerStarsAnimation();
            
            // ä¿å­˜æ•¸æ“š
            this.savePlayerData();
            
            return true;
          }
          return false;
        },
        checkLevelUp() {
          // æª¢æŸ¥æ˜¯å¦å¯ä»¥å‡ç´š
          if (this.canLevelUp) {
            this.playerLevel++;
            this.nextLevelStars = this.playerLevel * 100;
            
            // é¡¯ç¤ºå‡ç´šè¨Šæ¯
            this.showLevelUpMessage();
          }
        },
        showStarsEarnedMessage(amount) {
          // é¡¯ç¤ºç²å¾—æ˜Ÿæ˜Ÿè¨Šæ¯
          const message = `ğŸ‰ æ­å–œç²å¾— ${amount} é¡†æ˜Ÿæ˜Ÿï¼\n\nç•¶å‰æ˜Ÿæ˜Ÿï¼š${this.totalStars} é¡†`;
          setTimeout(() => {
            alert(message);
          }, 100);
        },
        showLevelUpMessage() {
          // é¡¯ç¤ºå‡ç´šè¨Šæ¯
          const message = `ğŸŠ æ­å–œå‡ç´šï¼\n\næ–°ç­‰ç´šï¼š${this.playerLevel}\n\nç¹¼çºŒåŠªåŠ›ç²å¾—æ›´å¤šæ˜Ÿæ˜Ÿï¼`;
          setTimeout(() => {
            alert(message);
          }, 200);
        },
        // æ¨¡æ“¬éŠæˆ²å®Œæˆç²å¾—æ˜Ÿæ˜Ÿ
        simulateGameCompletion(gameName) {
          const starsReward = Math.floor(Math.random() * 50) + 10; // 10-60 é¡†æ˜Ÿæ˜Ÿ
          this.earnStars(starsReward);
          
          // é¡¯ç¤ºéŠæˆ²å®Œæˆè¨Šæ¯
          setTimeout(() => {
            alert(`ğŸ® ${gameName} éŠæˆ²å®Œæˆï¼\n\nç²å¾—æ˜Ÿæ˜Ÿï¼š${starsReward} é¡†\nç¸½æ˜Ÿæ˜Ÿï¼š${this.totalStars} é¡†`);
          }, 300);
        },
        
        // åŒæ­¥æ˜Ÿæ˜Ÿé¡¯ç¤ºï¼Œèˆ‡é¦–é ä¿æŒä¸€è‡´
        syncStarsDisplay() {
          // å¾ localStorage é‡æ–°è®€å–æ˜Ÿæ˜Ÿæ•¸é‡
          const currentStars = parseInt(localStorage.getItem('totalStars') || '0');
          this.totalStars = currentStars;
          
          // è§¸ç™¼å‹•ç•«
          this.triggerStarsAnimation();
        },
        
        // æª¢æŸ¥æ˜Ÿæ˜Ÿç³»çµ±ç‹€æ…‹
        checkStarsSystem() {
          const localStorageStars = parseInt(localStorage.getItem('totalStars') || '0');
          const localStars = this.totalStars;
          
          console.log('ğŸŒŸ æ˜Ÿæ˜Ÿç³»çµ±æª¢æŸ¥:');
          console.log('  localStorage æ˜Ÿæ˜Ÿ:', localStorageStars);
          console.log('  æœ¬åœ°æ˜Ÿæ˜Ÿ:', localStars);
          console.log('  æ˜¯å¦åŒæ­¥:', localStorageStars === localStars);
          
          if (localStorageStars !== localStars) {
            console.log('âš ï¸ æ˜Ÿæ˜Ÿä¸åŒæ­¥ï¼Œæ­£åœ¨ä¿®æ­£...');
            this.totalStars = localStorageStars;
            this.triggerStarsAnimation();
          }
        }
      },
      mounted() {
        // å¾localStorageè®€å–ç©å®¶æ•¸æ“š
        this.loadPlayerData();

        // è®€å–é‡‘å¹£ / æŠ½çç´€éŒ„
        this.loadEconomyData();

        // è®€å–ç¨±è™Ÿæ”¶è—èˆ‡ç›®å‰å•Ÿç”¨ç¨±è™Ÿ
        this.loadTitles();
        
        // åˆå§‹åŒ–èƒŒæ™¯éŸ³æ¨‚ç³»çµ±
        initBackgroundMusic();
        
        // æª¢æŸ¥æ˜Ÿæ˜Ÿç³»çµ±ç‹€æ…‹
        this.checkStarsSystem();
        
        // å®šæœŸåŒæ­¥æ˜Ÿæ˜Ÿé¡¯ç¤ºï¼Œç¢ºä¿èˆ‡é¦–é ä¿æŒä¸€è‡´
        setInterval(() => {
          this.syncStarsDisplay();
        }, 5000); // æ¯5ç§’åŒæ­¥ä¸€æ¬¡
        
        // å®šæœŸæª¢æŸ¥æ˜Ÿæ˜Ÿç³»çµ±ç‹€æ…‹
        setInterval(() => {
          this.checkStarsSystem();
        }, 10000); // æ¯10ç§’æª¢æŸ¥ä¸€æ¬¡
      }
    }).mount('#app');

    // èƒŒæ™¯éŸ³æ¨‚æ§åˆ¶ç³»çµ±
    let backgroundMusic = null;
    let toggleMusicBtn = null;
    let isMusicPlaying = false;

    // æ’­æ”¾èƒŒæ™¯éŸ³æ¨‚
    function playBackgroundMusic() {
      if (!backgroundMusic) return;
      
      // æª¢æŸ¥æ˜¯å¦å·²ç¶“åœ¨æ’­æ”¾
      if (!backgroundMusic.paused) {
        console.log('ğŸµ éŸ³æ¨‚å·²åœ¨æ’­æ”¾ä¸­');
        return;
      }
      
      backgroundMusic.play().then(() => {
        isMusicPlaying = true;
        updateMusicButtonState();
        localStorage.setItem('bgMusicState', 'playing');
        console.log('ğŸµ èƒŒæ™¯éŸ³æ¨‚é–‹å§‹æ’­æ”¾');
      }).catch(err => {
        console.error('âŒ èƒŒæ™¯éŸ³æ¨‚æ’­æ”¾å¤±æ•—:', err);
        isMusicPlaying = false;
        updateMusicButtonState();
      });
    }

    // æš«åœèƒŒæ™¯éŸ³æ¨‚
    function pauseBackgroundMusic() {
      if (!backgroundMusic) return;
      
      backgroundMusic.pause();
      isMusicPlaying = false;
      updateMusicButtonState();
      localStorage.setItem('bgMusicState', 'paused');
      console.log('ğŸ”‡ èƒŒæ™¯éŸ³æ¨‚å·²æš«åœ');
    }

    // åˆ‡æ›èƒŒæ™¯éŸ³æ¨‚
    function toggleBackgroundMusic() {
      if (isMusicPlaying) {
        pauseBackgroundMusic();
      } else {
        playBackgroundMusic();
      }
    }

    // æ›´æ–°éŸ³æ¨‚æŒ‰éˆ•ç‹€æ…‹
    function updateMusicButtonState() {
      if (!toggleMusicBtn) return;
      
      if (isMusicPlaying) {
        toggleMusicBtn.style.background = 'rgba(0, 255, 255, 0.2)';
        toggleMusicBtn.innerHTML = '<span class="material-icons">ğŸ”Š</span>';
      } else {
        toggleMusicBtn.style.background = 'rgba(10, 20, 40, 0.85)';
        toggleMusicBtn.innerHTML = '<span class="material-icons">ğŸ”‡</span>';
      }
    }

    // åˆå§‹åŒ–èƒŒæ™¯éŸ³æ¨‚ç³»çµ±
    function initBackgroundMusic() {
      console.log('ğŸµ åˆå§‹åŒ–éŠæˆ²ä¸­å¿ƒèƒŒæ™¯éŸ³æ¨‚ç³»çµ±...');
      
      backgroundMusic = document.getElementById('backgroundMusic');
      toggleMusicBtn = document.getElementById('toggleMusic');
      
      if (!backgroundMusic) {
        console.error('âŒ æ‰¾ä¸åˆ°èƒŒæ™¯éŸ³æ¨‚å…ƒç´ ');
        return;
      }
      
      if (!toggleMusicBtn) {
        console.error('âŒ æ‰¾ä¸åˆ°éŸ³æ¨‚æ§åˆ¶æŒ‰éˆ•');
        return;
      }
      
      // è¨­å®šéŸ³æ¨‚å±¬æ€§
      backgroundMusic.volume = 0.3;
      backgroundMusic.loop = true;
      
      // é è¼‰å…¥éŸ³æ¨‚æª”æ¡ˆ
      backgroundMusic.load();
      
      // æª¢æŸ¥ä¸»é é¢çš„éŸ³æ¨‚ç‹€æ…‹
      const musicState = localStorage.getItem('bgMusicState');
      isMusicPlaying = musicState === 'playing';
      console.log('ğŸ”— ä¸»é é¢éŸ³æ¨‚ç‹€æ…‹:', isMusicPlaying);
      
      // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
      updateMusicButtonState();
      
      // å¦‚æœéŸ³æ¨‚æ‡‰è©²æ’­æ”¾ï¼Œå˜—è©¦æ’­æ”¾
      if (isMusicPlaying) {
        playBackgroundMusic();
      }
      
      console.log('âœ… éŠæˆ²ä¸­å¿ƒèƒŒæ™¯éŸ³æ¨‚ç³»çµ±åˆå§‹åŒ–å®Œæˆ');
    }

    // ç›£è½éŸ³æ¨‚æ§åˆ¶æŒ‰éˆ•é»æ“Š
    document.addEventListener('DOMContentLoaded', function() {
      // å»¶é²åˆå§‹åŒ–ï¼Œç¢ºä¿æ‰€æœ‰å…ƒç´ éƒ½å·²è¼‰å…¥
      setTimeout(() => {
        // ç¶å®šæŒ‰éˆ•äº‹ä»¶
        const musicBtn = document.getElementById('toggleMusic');
        if (musicBtn) {
          musicBtn.addEventListener('click', toggleBackgroundMusic);
          console.log('ğŸµ éŸ³æ¨‚æ§åˆ¶æŒ‰éˆ•äº‹ä»¶å·²ç¶å®š');
        }
        
        // æ·»åŠ ç”¨æˆ¶äº’å‹•è§¸ç™¼éŸ³æ¨‚æ’­æ”¾
        let hasUserInteracted = false;
        
        function handleUserInteraction() {
          if (!hasUserInteracted) {
            hasUserInteracted = true;
            console.log('ğŸ‘† ç”¨æˆ¶é¦–æ¬¡äº’å‹•ï¼Œå˜—è©¦æ’­æ”¾éŸ³æ¨‚');
            
            // å¦‚æœéŸ³æ¨‚æ‡‰è©²æ’­æ”¾ä½†é‚„æ²’é–‹å§‹ï¼Œç¾åœ¨å˜—è©¦æ’­æ”¾
            if (isMusicPlaying && backgroundMusic && backgroundMusic.paused) {
              playBackgroundMusic();
            }
            
            // ç§»é™¤äº‹ä»¶ç›£è½å™¨
            document.removeEventListener('click', handleUserInteraction);
            document.removeEventListener('keydown', handleUserInteraction);
            document.removeEventListener('touchstart', handleUserInteraction);
          }
        }
        
        // ç›£è½ç”¨æˆ¶äº’å‹•äº‹ä»¶
        document.addEventListener('click', handleUserInteraction);
        document.addEventListener('keydown', handleUserInteraction);
        document.addEventListener('touchstart', handleUserInteraction);
        
      }, 500);
    });

    // ç›£è½é é¢å¯è¦‹æ€§è®ŠåŒ–ï¼Œè™•ç†éŸ³æ¨‚æš«åœ/æ¢å¾©
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        // é é¢éš±è—æ™‚æš«åœéŸ³æ¨‚
        if (isMusicPlaying && backgroundMusic) {
          backgroundMusic.pause();
        }
      } else {
        // é é¢é¡¯ç¤ºæ™‚æ¢å¾©éŸ³æ¨‚
        if (isMusicPlaying && backgroundMusic && backgroundMusic.paused) {
          backgroundMusic.play().catch(err => {
            console.log('é é¢æ¢å¾©æ™‚éŸ³æ¨‚æ’­æ”¾å¤±æ•—:', err);
          });
        }
      }
    });
  </script>
</body>
</html> 
